{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/inheritsLoose\";\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nimport * as React from 'react';\nimport { v4 as uuid } from 'uuid';\nimport Icon from '../components/Icon';\nimport NavigationBar from '../components/NavigationBar';\nimport ToolBar from '../components/ToolBar';\nimport i18n from '../i18n';\nimport DividerPlugin from '../plugins/divider';\nimport Emitter, { globalEmitter } from '../share/emitter';\nimport { initialSelection } from '../share/var';\nimport getDecorated from '../utils/decorate';\nimport mergeConfig from '../utils/mergeConfig';\nimport { getLineAndCol, isKeyMatch, isPromise } from '../utils/tool';\nimport getUploadPlaceholder from '../utils/uploadPlaceholder';\nimport defaultConfig from './defaultConfig';\nimport { HtmlRender } from './preview';\nvar Editor = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Editor, _React$Component);\n\n  /**\n   * Register plugin\n   * @param {any} comp Plugin component\n   * @param {any} config Other configs\n   */\n  Editor.use = function use(comp, config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    // Check for duplicate plugins\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1, {\n          comp: comp,\n          config: config\n        });\n        return;\n      }\n    }\n    Editor.plugins.push({\n      comp: comp,\n      config: config\n    });\n  }\n  /**\n   * Unregister plugin\n   * @param {any} comp Plugin component\n   */;\n\n  Editor.unuse = function unuse(comp) {\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1);\n        return;\n      }\n    }\n  }\n  /**\n   * Unregister all plugins\n   * @param {any} comp Plugin component\n   */;\n\n  Editor.unuseAll = function unuseAll() {\n    Editor.plugins = [];\n  }\n  /**\n   * Locales\n   */;\n\n  function Editor(props) {\n    var _this;\n    _this = _React$Component.call(this, props) || this;\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreview = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.hasContentChanged = true;\n    _this.composing = false;\n    _this.pluginApis = new Map();\n    _this.scrollScale = 1;\n    _this.isSyncingScroll = false;\n    _this.shouldSyncScroll = 'md';\n    _this.keyboardListeners = [];\n    _this.emitter = new Emitter();\n    _this.config = mergeConfig(defaultConfig, _this.props.config, _this.props);\n    _this.state = {\n      text: (_this.props.value || _this.props.defaultValue || '').replace(/↵/g, '\\n'),\n      html: '',\n      view: _this.config.view || defaultConfig.view,\n      fullScreen: false,\n      plugins: _this.getPlugins()\n    };\n    if (_this.config.canView && !_this.config.canView.menu) {\n      _this.state.view.menu = false;\n    }\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handlePaste = _this.handlePaste.bind(_assertThisInitialized(_this));\n    _this.handleDrop = _this.handleDrop.bind(_assertThisInitialized(_this));\n    _this.handleToggleMenu = _this.handleToggleMenu.bind(_assertThisInitialized(_this));\n    _this.handleKeyDown = _this.handleKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleEditorKeyDown = _this.handleEditorKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleLocaleUpdate = _this.handleLocaleUpdate.bind(_assertThisInitialized(_this));\n    _this.handleFocus = _this.handleFocus.bind(_assertThisInitialized(_this));\n    _this.handleBlur = _this.handleBlur.bind(_assertThisInitialized(_this));\n    _this.handleInputScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'md');\n    _this.handlePreviewScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'html');\n    return _this;\n  }\n  var _proto = Editor.prototype;\n  _proto.componentDidMount = function componentDidMount() {\n    var text = this.state.text;\n    this.renderHTML(text);\n    globalEmitter.on(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate); // init i18n\n\n    i18n.setUp();\n  };\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    globalEmitter.off(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate);\n  };\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (typeof this.props.value !== 'undefined' && this.props.value !== this.state.text) {\n      var value = this.props.value;\n      if (typeof value !== 'string') {\n        value = String(value).toString();\n      }\n      value = value.replace(/↵/g, '\\n');\n      if (this.state.text !== value) {\n        this.setState({\n          text: value\n        });\n        this.renderHTML(value);\n      }\n    }\n    if (prevProps.plugins !== this.props.plugins) {\n      this.setState({\n        plugins: this.getPlugins()\n      });\n    }\n  };\n  _proto.isComposing = function isComposing() {\n    return this.composing;\n  };\n  _proto.getPlugins = function getPlugins() {\n    var _this2 = this;\n    var plugins = [];\n    if (this.props.plugins) {\n      // If plugins option is configured, use only specified plugins\n      var addToPlugins = function addToPlugins(name) {\n        if (name === DividerPlugin.pluginName) {\n          plugins.push({\n            comp: DividerPlugin,\n            config: {}\n          });\n          return;\n        }\n        for (var _iterator = _createForOfIteratorHelperLoose(Editor.plugins), _step; !(_step = _iterator()).done;) {\n          var it = _step.value;\n          if (it.comp.pluginName === name) {\n            plugins.push(it);\n            return;\n          }\n        }\n      };\n      for (var _iterator2 = _createForOfIteratorHelperLoose(this.props.plugins), _step2; !(_step2 = _iterator2()).done;) {\n        var name = _step2.value;\n\n        // Special handling of fonts to ensure backward compatibility\n        if (name === 'fonts') {\n          addToPlugins('font-bold');\n          addToPlugins('font-italic');\n          addToPlugins('font-underline');\n          addToPlugins('font-strikethrough');\n          addToPlugins('list-unordered');\n          addToPlugins('list-ordered');\n          addToPlugins('block-quote');\n          addToPlugins('block-wrap');\n          addToPlugins('block-code-inline');\n          addToPlugins('block-code-block');\n        } else {\n          addToPlugins(name);\n        }\n      }\n    } else {\n      // Use all registered plugins\n      plugins = [].concat(Editor.plugins);\n    }\n    var result = {};\n    plugins.forEach(function (it) {\n      if (typeof result[it.comp.align] === 'undefined') {\n        result[it.comp.align] = [];\n      }\n      var key = it.comp.pluginName === 'divider' ? uuid() : it.comp.pluginName;\n      result[it.comp.align].push( /*#__PURE__*/React.createElement(it.comp, {\n        editor: _this2,\n        editorConfig: _this2.config,\n        config: _extends({}, it.comp.defaultConfig || {}, it.config || {}),\n        key: key\n      }));\n    });\n    return result;\n  } // sync left and right section's scroll\n  ;\n\n  _proto.handleSyncScroll = function handleSyncScroll(type, e) {\n    var _this3 = this;\n\n    // prevent loop\n    if (type !== this.shouldSyncScroll) {\n      return;\n    } // trigger events\n\n    if (this.props.onScroll) {\n      this.props.onScroll(e, type);\n    }\n    this.emitter.emit(this.emitter.EVENT_SCROLL, e, type); // should sync scroll?\n\n    var _this$config$syncScro = this.config.syncScrollMode,\n      syncScrollMode = _this$config$syncScro === void 0 ? [] : _this$config$syncScro;\n    if (!syncScrollMode.includes(type === 'md' ? 'rightFollowLeft' : 'leftFollowRight')) {\n      return;\n    }\n    if (this.hasContentChanged && this.nodeMdText.current && this.nodeMdPreviewWrapper.current) {\n      // 计算出左右的比例\n      this.scrollScale = this.nodeMdText.current.scrollHeight / this.nodeMdPreviewWrapper.current.scrollHeight;\n      this.hasContentChanged = false;\n    }\n    if (!this.isSyncingScroll) {\n      this.isSyncingScroll = true;\n      requestAnimationFrame(function () {\n        if (_this3.nodeMdText.current && _this3.nodeMdPreviewWrapper.current) {\n          if (type === 'md') {\n            // left to right\n            _this3.nodeMdPreviewWrapper.current.scrollTop = _this3.nodeMdText.current.scrollTop / _this3.scrollScale;\n          } else {\n            // right to left\n            _this3.nodeMdText.current.scrollTop = _this3.nodeMdPreviewWrapper.current.scrollTop * _this3.scrollScale;\n          }\n        }\n        _this3.isSyncingScroll = false;\n      });\n    }\n  };\n  _proto.renderHTML = function renderHTML(markdownText) {\n    var _this4 = this;\n    if (!this.props.renderHTML) {\n      console.error('renderHTML props is required!');\n      return Promise.resolve();\n    }\n    var res = this.props.renderHTML(markdownText);\n    if (isPromise(res)) {\n      // @ts-ignore\n      return res.then(function (r) {\n        return _this4.setHtml(r);\n      });\n    }\n    if (typeof res === 'function') {\n      return this.setHtml(res());\n    }\n    return this.setHtml(res);\n  };\n  _proto.setHtml = function setHtml(html) {\n    var _this5 = this;\n    return new Promise(function (resolve) {\n      _this5.setState({\n        html: html\n      }, resolve);\n    });\n  };\n  _proto.handleToggleMenu = function handleToggleMenu() {\n    this.setView({\n      menu: !this.state.view.menu\n    });\n  };\n  _proto.handleFocus = function handleFocus(e) {\n    var onFocus = this.props.onFocus;\n    if (onFocus) {\n      onFocus(e);\n    }\n    this.emitter.emit(this.emitter.EVENT_FOCUS, e);\n  };\n  _proto.handleBlur = function handleBlur(e) {\n    var onBlur = this.props.onBlur;\n    if (onBlur) {\n      onBlur(e);\n    }\n    this.emitter.emit(this.emitter.EVENT_BLUR, e);\n  }\n  /**\n   * Text area change event\n   * @param {React.ChangeEvent} e\n   */;\n\n  _proto.handleChange = function handleChange(e) {\n    e.persist();\n    var value = e.target.value; // 触发内部事件\n\n    this.setText(value, e);\n  }\n  /**\n   * Listen paste event to support paste images\n   */;\n\n  _proto.handlePaste = function handlePaste(e) {\n    if (!this.config.allowPasteImage || !this.config.onImageUpload) {\n      return;\n    }\n    var event = e.nativeEvent; // @ts-ignore\n\n    var items = (event.clipboardData || window.clipboardData).items;\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  } // Drag images to upload\n  ;\n\n  _proto.handleDrop = function handleDrop(e) {\n    if (!this.config.onImageUpload) {\n      return;\n    }\n    var event = e.nativeEvent;\n    if (!event.dataTransfer) {\n      return;\n    }\n    var items = event.dataTransfer.items;\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  };\n  _proto.handleEditorKeyDown = function handleEditorKeyDown(e) {\n    var _this6 = this;\n    var keyCode = e.keyCode,\n      key = e.key,\n      currentTarget = e.currentTarget;\n    if ((keyCode === 13 || key === 'Enter') && this.composing === false) {\n      var _text = currentTarget.value;\n      var curPos = currentTarget.selectionStart;\n      var lineInfo = getLineAndCol(_text, curPos);\n      var emptyCurrentLine = function emptyCurrentLine() {\n        var newValue = currentTarget.value.substr(0, curPos - lineInfo.curLine.length) + currentTarget.value.substr(curPos);\n        _this6.setText(newValue, undefined, {\n          start: curPos - lineInfo.curLine.length,\n          end: curPos - lineInfo.curLine.length\n        });\n        e.preventDefault();\n      };\n      var addSymbol = function addSymbol(symbol) {\n        _this6.insertText(\"\\n\" + symbol, false, {\n          start: symbol.length + 1,\n          end: symbol.length + 1\n        });\n        e.preventDefault();\n      }; // Enter key, check previous line\n\n      var isSymbol = lineInfo.curLine.match(/^(\\s*?)\\* /);\n      if (isSymbol) {\n        if (/^(\\s*?)\\* $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n        addSymbol(isSymbol[0]);\n        return;\n      }\n      var isOrderList = lineInfo.curLine.match(/^(\\s*?)(\\d+)\\. /);\n      if (isOrderList) {\n        if (/^(\\s*?)(\\d+)\\. $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n        var toInsert = \"\" + isOrderList[1] + (parseInt(isOrderList[2], 10) + 1) + \". \";\n        addSymbol(toInsert);\n        return;\n      }\n    } // 触发默认事件\n\n    this.emitter.emit(this.emitter.EVENT_EDITOR_KEY_DOWN, e);\n  } // Handle language change\n  ;\n\n  _proto.handleLocaleUpdate = function handleLocaleUpdate() {\n    this.forceUpdate();\n  }\n  /**\n   * Get elements\n   */;\n\n  _proto.getMdElement = function getMdElement() {\n    return this.nodeMdText.current;\n  };\n  _proto.getHtmlElement = function getHtmlElement() {\n    return this.nodeMdPreviewWrapper.current;\n  }\n  /**\n   * Clear selected\n   */;\n\n  _proto.clearSelection = function clearSelection() {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(0, 0, 'none');\n    }\n  }\n  /**\n   * Get selected\n   * @return {Selection}\n   */;\n\n  _proto.getSelection = function getSelection() {\n    var source = this.nodeMdText.current;\n    if (!source) {\n      return _extends({}, initialSelection);\n    }\n    var start = source.selectionStart;\n    var end = source.selectionEnd;\n    var text = (source.value || '').slice(start, end);\n    return {\n      start: start,\n      end: end,\n      text: text\n    };\n  }\n  /**\n   * Set selected\n   * @param {Selection} to\n   */;\n\n  _proto.setSelection = function setSelection(to) {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(to.start, to.end, 'forward');\n      this.nodeMdText.current.focus();\n    }\n  }\n  /**\n   * Insert markdown text\n   * @param type\n   * @param option\n   */;\n\n  _proto.insertMarkdown = function insertMarkdown(type, option) {\n    if (option === void 0) {\n      option = {};\n    }\n    var curSelection = this.getSelection();\n    var decorateOption = option ? _extends({}, option) : {};\n    if (type === 'image') {\n      decorateOption = _extends({}, decorateOption, {\n        target: option.target || curSelection.text || '',\n        imageUrl: option.imageUrl || this.config.imageUrl\n      });\n    }\n    if (type === 'link') {\n      decorateOption = _extends({}, decorateOption, {\n        linkUrl: this.config.linkUrl\n      });\n    }\n    if (type === 'tab' && curSelection.start !== curSelection.end) {\n      var curLineStart = this.getMdValue().slice(0, curSelection.start).lastIndexOf('\\n') + 1;\n      this.setSelection({\n        start: curLineStart,\n        end: curSelection.end\n      });\n    }\n    var decorate = getDecorated(curSelection.text, type, decorateOption);\n    var text = decorate.text;\n    var selection = decorate.selection;\n    if (decorate.newBlock) {\n      var startLineInfo = getLineAndCol(this.getMdValue(), curSelection.start);\n      var col = startLineInfo.col,\n        curLine = startLineInfo.curLine;\n      if (col > 0 && curLine.length > 0) {\n        text = \"\\n\" + text;\n        if (selection) {\n          selection.start++;\n          selection.end++;\n        }\n      }\n      var afterText = startLineInfo.afterText;\n      if (curSelection.start !== curSelection.end) {\n        afterText = getLineAndCol(this.getMdValue(), curSelection.end).afterText;\n      }\n      if (afterText.trim() !== '' && afterText.substr(0, 2) !== '\\n\\n') {\n        if (afterText.substr(0, 1) !== '\\n') {\n          text += '\\n';\n        }\n        text += '\\n';\n      }\n    }\n    this.insertText(text, true, selection);\n  }\n  /**\n   * Insert a placeholder, and replace it when the Promise resolved\n   * @param placeholder\n   * @param wait\n   */;\n\n  _proto.insertPlaceholder = function insertPlaceholder(placeholder, wait) {\n    var _this7 = this;\n    this.insertText(placeholder, true);\n    wait.then(function (str) {\n      var text = _this7.getMdValue().replace(placeholder, str);\n      _this7.setText(text);\n    });\n  }\n  /**\n   * Insert text\n   * @param {string} value The text will be insert\n   * @param {boolean} replaceSelected Replace selected text\n   * @param {Selection} newSelection New selection\n   */;\n\n  _proto.insertText = function insertText(value, replaceSelected, newSelection) {\n    if (value === void 0) {\n      value = '';\n    }\n    if (replaceSelected === void 0) {\n      replaceSelected = false;\n    }\n    var text = this.state.text;\n    var selection = this.getSelection();\n    var beforeContent = text.slice(0, selection.start);\n    var afterContent = text.slice(replaceSelected ? selection.end : selection.start, text.length);\n    this.setText(beforeContent + value + afterContent, undefined, newSelection ? {\n      start: newSelection.start + beforeContent.length,\n      end: newSelection.end + beforeContent.length\n    } : {\n      start: selection.start,\n      end: selection.start\n    });\n  }\n  /**\n   * Set text, and trigger onChange event\n   * @param {string} value\n   * @param {any} event\n   */;\n\n  _proto.setText = function setText(value, event, newSelection) {\n    var _this8 = this;\n    if (value === void 0) {\n      value = '';\n    }\n    var _this$config$onChange = this.config.onChangeTrigger,\n      onChangeTrigger = _this$config$onChange === void 0 ? 'both' : _this$config$onChange;\n    var text = value.replace(/↵/g, '\\n');\n    if (this.state.text === value) {\n      return;\n    }\n    this.setState({\n      text: text\n    });\n    if (this.props.onChange && (onChangeTrigger === 'both' || onChangeTrigger === 'beforeRender')) {\n      this.props.onChange({\n        text: text,\n        html: this.getHtmlValue()\n      }, event);\n    }\n    this.emitter.emit(this.emitter.EVENT_CHANGE, value, event, typeof event === 'undefined');\n    if (newSelection) {\n      setTimeout(function () {\n        return _this8.setSelection(newSelection);\n      });\n    }\n    if (!this.hasContentChanged) {\n      this.hasContentChanged = true;\n    }\n    var rendering = this.renderHTML(text);\n    if (onChangeTrigger === 'both' || onChangeTrigger === 'afterRender') {\n      rendering.then(function () {\n        if (_this8.props.onChange) {\n          _this8.props.onChange({\n            text: _this8.state.text,\n            html: _this8.getHtmlValue()\n          }, event);\n        }\n      });\n    }\n  }\n  /**\n   * Get text value\n   * @return {string}\n   */;\n\n  _proto.getMdValue = function getMdValue() {\n    return this.state.text;\n  }\n  /**\n   * Get rendered html\n   * @returns {string}\n   */;\n\n  _proto.getHtmlValue = function getHtmlValue() {\n    if (typeof this.state.html === 'string') {\n      return this.state.html;\n    }\n    if (this.nodeMdPreview.current) {\n      return this.nodeMdPreview.current.getHtml();\n    }\n    return '';\n  }\n  /**\n   * Listen keyboard events\n   */;\n\n  /**\n   * Listen keyboard events\n   * @param {KeyboardEventListener} data\n   */\n  _proto.onKeyboard = function onKeyboard(data) {\n    var _this9 = this;\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this9.onKeyboard(it);\n      });\n      return;\n    }\n    if (!this.keyboardListeners.includes(data)) {\n      this.keyboardListeners.push(data);\n    }\n  }\n  /**\n   * Un-listen keyboard events\n   * @param {KeyboardEventListener} data\n   */;\n\n  _proto.offKeyboard = function offKeyboard(data) {\n    var _this10 = this;\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this10.offKeyboard(it);\n      });\n      return;\n    }\n    var index = this.keyboardListeners.indexOf(data);\n    if (index >= 0) {\n      this.keyboardListeners.splice(index, 1);\n    }\n  };\n  _proto.handleKeyDown = function handleKeyDown(e) {\n    // 遍历监听数组，找找有没有被监听\n    for (var _iterator3 = _createForOfIteratorHelperLoose(this.keyboardListeners), _step3; !(_step3 = _iterator3()).done;) {\n      var it = _step3.value;\n      if (isKeyMatch(e, it)) {\n        e.preventDefault();\n        it.callback(e);\n        return;\n      }\n    } // 如果没有，触发默认事件\n\n    this.emitter.emit(this.emitter.EVENT_KEY_DOWN, e);\n  };\n  _proto.getEventType = function getEventType(event) {\n    switch (event) {\n      case 'change':\n        return this.emitter.EVENT_CHANGE;\n      case 'fullscreen':\n        return this.emitter.EVENT_FULL_SCREEN;\n      case 'viewchange':\n        return this.emitter.EVENT_VIEW_CHANGE;\n      case 'keydown':\n        return this.emitter.EVENT_KEY_DOWN;\n      case 'editor_keydown':\n        return this.emitter.EVENT_EDITOR_KEY_DOWN;\n      case 'blur':\n        return this.emitter.EVENT_BLUR;\n      case 'focus':\n        return this.emitter.EVENT_FOCUS;\n      case 'scroll':\n        return this.emitter.EVENT_SCROLL;\n    }\n  }\n  /**\n   * Listen events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */;\n\n  _proto.on = function on(event, cb) {\n    var eventType = this.getEventType(event);\n    if (eventType) {\n      this.emitter.on(eventType, cb);\n    }\n  }\n  /**\n   * Un-listen events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */;\n\n  _proto.off = function off(event, cb) {\n    var eventType = this.getEventType(event);\n    if (eventType) {\n      this.emitter.off(eventType, cb);\n    }\n  }\n  /**\n   * Set view property\n   * Can show or hide: editor, preview, menu\n   * @param {object} to\n   */;\n\n  _proto.setView = function setView(to) {\n    var _this11 = this;\n    var newView = _extends({}, this.state.view, to);\n    this.setState({\n      view: newView\n    }, function () {\n      _this11.emitter.emit(_this11.emitter.EVENT_VIEW_CHANGE, newView);\n    });\n  }\n  /**\n   * Get view property\n   * @return {object}\n   */;\n\n  _proto.getView = function getView() {\n    return _extends({}, this.state.view);\n  }\n  /**\n   * Enter or exit full screen\n   * @param {boolean} enable\n   */;\n\n  _proto.fullScreen = function fullScreen(enable) {\n    var _this12 = this;\n    if (this.state.fullScreen !== enable) {\n      this.setState({\n        fullScreen: enable\n      }, function () {\n        _this12.emitter.emit(_this12.emitter.EVENT_FULL_SCREEN, enable);\n      });\n    }\n  }\n  /**\n   * Register a plugin API\n   * @param {string} name API name\n   * @param {any} cb callback\n   */;\n\n  _proto.registerPluginApi = function registerPluginApi(name, cb) {\n    this.pluginApis.set(name, cb);\n  };\n  _proto.unregisterPluginApi = function unregisterPluginApi(name) {\n    this.pluginApis.delete(name);\n  }\n  /**\n   * Call a plugin API\n   * @param {string} name API name\n   * @param {any} others arguments\n   * @returns {any}\n   */;\n\n  _proto.callPluginApi = function callPluginApi(name) {\n    var handler = this.pluginApis.get(name);\n    if (!handler) {\n      throw new Error(\"API \" + name + \" not found\");\n    }\n    for (var _len = arguments.length, others = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      others[_key - 1] = arguments[_key];\n    }\n    return handler.apply(void 0, others);\n  }\n  /**\n   * Is full screen\n   * @return {boolean}\n   */;\n\n  _proto.isFullScreen = function isFullScreen() {\n    return this.state.fullScreen;\n  };\n  _proto.uploadWithDataTransfer = function uploadWithDataTransfer(items) {\n    var _this13 = this;\n    var onImageUpload = this.config.onImageUpload;\n    if (!onImageUpload) {\n      return;\n    }\n    var queue = [];\n    Array.prototype.forEach.call(items, function (it) {\n      if (it.kind === 'file' && it.type.includes('image')) {\n        var file = it.getAsFile();\n        if (file) {\n          var placeholder = getUploadPlaceholder(file, onImageUpload);\n          queue.push(Promise.resolve(placeholder.placeholder));\n          placeholder.uploaded.then(function (str) {\n            var text = _this13.getMdValue().replace(placeholder.placeholder, str);\n            var offset = str.length - placeholder.placeholder.length; // 计算出替换后的光标位置\n\n            var selection = _this13.getSelection();\n            _this13.setText(text, undefined, {\n              start: selection.start + offset,\n              end: selection.start + offset\n            });\n          });\n        }\n      } else if (it.kind === 'string' && it.type === 'text/plain') {\n        queue.push(new Promise(function (resolve) {\n          return it.getAsString(resolve);\n        }));\n      }\n    });\n    Promise.all(queue).then(function (res) {\n      var text = res.join('');\n      var selection = _this13.getSelection();\n      _this13.insertText(text, true, {\n        start: selection.start === selection.end ? text.length : 0,\n        end: text.length\n      });\n    });\n  };\n  _proto.render = function render() {\n    var _this14 = this;\n    var _this$state = this.state,\n      view = _this$state.view,\n      fullScreen = _this$state.fullScreen,\n      text = _this$state.text,\n      html = _this$state.html;\n    var _this$props = this.props,\n      id = _this$props.id,\n      _this$props$className = _this$props.className,\n      className = _this$props$className === void 0 ? '' : _this$props$className,\n      style = _this$props.style,\n      _this$props$name = _this$props.name,\n      name = _this$props$name === void 0 ? 'textarea' : _this$props$name,\n      autoFocus = _this$props.autoFocus,\n      placeholder = _this$props.placeholder,\n      readOnly = _this$props.readOnly;\n    var showHideMenu = this.config.canView && this.config.canView.hideMenu && !this.config.canView.menu;\n    var getPluginAt = function getPluginAt(at) {\n      return _this14.state.plugins[at] || [];\n    };\n    var isShowMenu = !!view.menu;\n    var editorId = id ? id + \"_md\" : undefined;\n    var previewerId = id ? id + \"_html\" : undefined;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: id,\n      className: \"rc-md-editor \" + (fullScreen ? 'full' : '') + \" \" + className,\n      style: style,\n      onKeyDown: this.handleKeyDown,\n      onDrop: this.handleDrop\n    }, /*#__PURE__*/React.createElement(NavigationBar, {\n      visible: isShowMenu,\n      left: getPluginAt('left'),\n      right: getPluginAt('right')\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"editor-container\"\n    }, showHideMenu && /*#__PURE__*/React.createElement(ToolBar, null, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-menu\",\n      title: isShowMenu ? 'hidden menu' : 'show menu',\n      onClick: this.handleToggleMenu\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"expand-\" + (isShowMenu ? 'less' : 'more')\n    }))), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-md \" + (view.md ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"textarea\", {\n      id: editorId,\n      ref: this.nodeMdText,\n      name: name,\n      autoFocus: autoFocus,\n      placeholder: placeholder,\n      readOnly: readOnly,\n      value: text,\n      className: \"section-container input \" + (this.config.markdownClass || ''),\n      wrap: \"hard\",\n      onChange: this.handleChange,\n      onScroll: this.handleInputScroll,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'md';\n      },\n      onKeyDown: this.handleEditorKeyDown,\n      onCompositionStart: function onCompositionStart() {\n        return _this14.composing = true;\n      },\n      onCompositionEnd: function onCompositionEnd() {\n        return _this14.composing = false;\n      },\n      onPaste: this.handlePaste,\n      onFocus: this.handleFocus,\n      onBlur: this.handleBlur\n    })), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-html \" + (view.html ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: previewerId,\n      className: \"section-container html-wrap\",\n      ref: this.nodeMdPreviewWrapper,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'html';\n      },\n      onScroll: this.handlePreviewScroll\n    }, /*#__PURE__*/React.createElement(HtmlRender, {\n      html: html,\n      className: this.config.htmlClass,\n      ref: this.nodeMdPreview\n    })))));\n  };\n  return Editor;\n}(React.Component);\nEditor.plugins = [];\nEditor.addLocale = i18n.add.bind(i18n);\nEditor.useLocale = i18n.setCurrent.bind(i18n);\nEditor.getLocale = i18n.getCurrent.bind(i18n);\nexport default Editor;","map":{"version":3,"names":["_extends","_assertThisInitialized","_inheritsLoose","_createForOfIteratorHelperLoose","o","allowArrayLike","it","Symbol","iterator","call","next","bind","Array","isArray","_unsupportedIterableToArray","length","i","done","value","TypeError","minLen","_arrayLikeToArray","n","Object","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","React","v4","uuid","Icon","NavigationBar","ToolBar","i18n","DividerPlugin","Emitter","globalEmitter","initialSelection","getDecorated","mergeConfig","getLineAndCol","isKeyMatch","isPromise","getUploadPlaceholder","defaultConfig","HtmlRender","Editor","_React$Component","use","comp","config","plugins","splice","push","unuse","unuseAll","props","_this","nodeMdText","createRef","nodeMdPreview","nodeMdPreviewWrapper","hasContentChanged","composing","pluginApis","Map","scrollScale","isSyncingScroll","shouldSyncScroll","keyboardListeners","emitter","state","text","defaultValue","replace","html","view","fullScreen","getPlugins","canView","menu","handleChange","handlePaste","handleDrop","handleToggleMenu","handleKeyDown","handleEditorKeyDown","handleLocaleUpdate","handleFocus","handleBlur","handleInputScroll","handleSyncScroll","handlePreviewScroll","_proto","componentDidMount","renderHTML","on","EVENT_LANG_CHANGE","setUp","componentWillUnmount","off","componentDidUpdate","prevProps","String","setState","isComposing","_this2","addToPlugins","pluginName","_iterator","_step","_iterator2","_step2","concat","result","forEach","align","key","createElement","editor","editorConfig","type","e","_this3","onScroll","emit","EVENT_SCROLL","_this$config$syncScro","syncScrollMode","includes","current","scrollHeight","requestAnimationFrame","scrollTop","markdownText","_this4","console","error","Promise","resolve","res","then","r","setHtml","_this5","setView","onFocus","EVENT_FOCUS","onBlur","EVENT_BLUR","persist","target","setText","allowPasteImage","onImageUpload","event","nativeEvent","items","clipboardData","window","preventDefault","uploadWithDataTransfer","dataTransfer","_this6","keyCode","currentTarget","_text","curPos","selectionStart","lineInfo","emptyCurrentLine","newValue","substr","curLine","undefined","start","end","addSymbol","symbol","insertText","isSymbol","match","isOrderList","toInsert","parseInt","EVENT_EDITOR_KEY_DOWN","forceUpdate","getMdElement","getHtmlElement","clearSelection","setSelectionRange","getSelection","source","selectionEnd","setSelection","to","focus","insertMarkdown","option","curSelection","decorateOption","imageUrl","linkUrl","curLineStart","getMdValue","lastIndexOf","decorate","selection","newBlock","startLineInfo","col","afterText","trim","insertPlaceholder","placeholder","wait","_this7","str","replaceSelected","newSelection","beforeContent","afterContent","_this8","_this$config$onChange","onChangeTrigger","onChange","getHtmlValue","EVENT_CHANGE","setTimeout","rendering","getHtml","onKeyboard","data","_this9","offKeyboard","_this10","index","indexOf","_iterator3","_step3","callback","EVENT_KEY_DOWN","getEventType","EVENT_FULL_SCREEN","EVENT_VIEW_CHANGE","cb","eventType","_this11","newView","getView","enable","_this12","registerPluginApi","set","unregisterPluginApi","delete","callPluginApi","handler","get","Error","_len","arguments","others","_key","apply","isFullScreen","_this13","queue","kind","file","getAsFile","uploaded","offset","getAsString","all","join","render","_this14","_this$state","_this$props","id","_this$props$className","className","style","_this$props$name","autoFocus","readOnly","showHideMenu","hideMenu","getPluginAt","at","isShowMenu","editorId","previewerId","onKeyDown","onDrop","visible","left","right","title","onClick","md","ref","markdownClass","wrap","onMouseOver","onCompositionStart","onCompositionEnd","onPaste","htmlClass","Component","addLocale","add","useLocale","setCurrent","getLocale","getCurrent"],"sources":["/Users/wangbaiyuan/Documents/Wehelp/Part3/Vcard/client/node_modules/react-markdown-editor-lite/esm/editor/index.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/inheritsLoose\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport * as React from 'react';\nimport { v4 as uuid } from 'uuid';\nimport Icon from '../components/Icon';\nimport NavigationBar from '../components/NavigationBar';\nimport ToolBar from '../components/ToolBar';\nimport i18n from '../i18n';\nimport DividerPlugin from '../plugins/divider';\nimport Emitter, { globalEmitter } from '../share/emitter';\nimport { initialSelection } from '../share/var';\nimport getDecorated from '../utils/decorate';\nimport mergeConfig from '../utils/mergeConfig';\nimport { getLineAndCol, isKeyMatch, isPromise } from '../utils/tool';\nimport getUploadPlaceholder from '../utils/uploadPlaceholder';\nimport defaultConfig from './defaultConfig';\nimport { HtmlRender } from './preview';\n\nvar Editor = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Editor, _React$Component);\n\n  /**\n   * Register plugin\n   * @param {any} comp Plugin component\n   * @param {any} config Other configs\n   */\n  Editor.use = function use(comp, config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    // Check for duplicate plugins\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1, {\n          comp: comp,\n          config: config\n        });\n        return;\n      }\n    }\n\n    Editor.plugins.push({\n      comp: comp,\n      config: config\n    });\n  }\n  /**\n   * Unregister plugin\n   * @param {any} comp Plugin component\n   */\n  ;\n\n  Editor.unuse = function unuse(comp) {\n    for (var i = 0; i < Editor.plugins.length; i++) {\n      if (Editor.plugins[i].comp === comp) {\n        Editor.plugins.splice(i, 1);\n        return;\n      }\n    }\n  }\n  /**\n   * Unregister all plugins\n   * @param {any} comp Plugin component\n   */\n  ;\n\n  Editor.unuseAll = function unuseAll() {\n    Editor.plugins = [];\n  }\n  /**\n   * Locales\n   */\n  ;\n\n  function Editor(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreview = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.hasContentChanged = true;\n    _this.composing = false;\n    _this.pluginApis = new Map();\n    _this.scrollScale = 1;\n    _this.isSyncingScroll = false;\n    _this.shouldSyncScroll = 'md';\n    _this.keyboardListeners = [];\n    _this.emitter = new Emitter();\n    _this.config = mergeConfig(defaultConfig, _this.props.config, _this.props);\n    _this.state = {\n      text: (_this.props.value || _this.props.defaultValue || '').replace(/↵/g, '\\n'),\n      html: '',\n      view: _this.config.view || defaultConfig.view,\n      fullScreen: false,\n      plugins: _this.getPlugins()\n    };\n\n    if (_this.config.canView && !_this.config.canView.menu) {\n      _this.state.view.menu = false;\n    }\n\n    _this.nodeMdText = /*#__PURE__*/React.createRef();\n    _this.nodeMdPreviewWrapper = /*#__PURE__*/React.createRef();\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handlePaste = _this.handlePaste.bind(_assertThisInitialized(_this));\n    _this.handleDrop = _this.handleDrop.bind(_assertThisInitialized(_this));\n    _this.handleToggleMenu = _this.handleToggleMenu.bind(_assertThisInitialized(_this));\n    _this.handleKeyDown = _this.handleKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleEditorKeyDown = _this.handleEditorKeyDown.bind(_assertThisInitialized(_this));\n    _this.handleLocaleUpdate = _this.handleLocaleUpdate.bind(_assertThisInitialized(_this));\n    _this.handleFocus = _this.handleFocus.bind(_assertThisInitialized(_this));\n    _this.handleBlur = _this.handleBlur.bind(_assertThisInitialized(_this));\n    _this.handleInputScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'md');\n    _this.handlePreviewScroll = _this.handleSyncScroll.bind(_assertThisInitialized(_this), 'html');\n    return _this;\n  }\n\n  var _proto = Editor.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var text = this.state.text;\n    this.renderHTML(text);\n    globalEmitter.on(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate); // init i18n\n\n    i18n.setUp();\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    globalEmitter.off(globalEmitter.EVENT_LANG_CHANGE, this.handleLocaleUpdate);\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (typeof this.props.value !== 'undefined' && this.props.value !== this.state.text) {\n      var value = this.props.value;\n\n      if (typeof value !== 'string') {\n        value = String(value).toString();\n      }\n\n      value = value.replace(/↵/g, '\\n');\n\n      if (this.state.text !== value) {\n        this.setState({\n          text: value\n        });\n        this.renderHTML(value);\n      }\n    }\n\n    if (prevProps.plugins !== this.props.plugins) {\n      this.setState({\n        plugins: this.getPlugins()\n      });\n    }\n  };\n\n  _proto.isComposing = function isComposing() {\n    return this.composing;\n  };\n\n  _proto.getPlugins = function getPlugins() {\n    var _this2 = this;\n\n    var plugins = [];\n\n    if (this.props.plugins) {\n      // If plugins option is configured, use only specified plugins\n      var addToPlugins = function addToPlugins(name) {\n        if (name === DividerPlugin.pluginName) {\n          plugins.push({\n            comp: DividerPlugin,\n            config: {}\n          });\n          return;\n        }\n\n        for (var _iterator = _createForOfIteratorHelperLoose(Editor.plugins), _step; !(_step = _iterator()).done;) {\n          var it = _step.value;\n\n          if (it.comp.pluginName === name) {\n            plugins.push(it);\n            return;\n          }\n        }\n      };\n\n      for (var _iterator2 = _createForOfIteratorHelperLoose(this.props.plugins), _step2; !(_step2 = _iterator2()).done;) {\n        var name = _step2.value;\n\n        // Special handling of fonts to ensure backward compatibility\n        if (name === 'fonts') {\n          addToPlugins('font-bold');\n          addToPlugins('font-italic');\n          addToPlugins('font-underline');\n          addToPlugins('font-strikethrough');\n          addToPlugins('list-unordered');\n          addToPlugins('list-ordered');\n          addToPlugins('block-quote');\n          addToPlugins('block-wrap');\n          addToPlugins('block-code-inline');\n          addToPlugins('block-code-block');\n        } else {\n          addToPlugins(name);\n        }\n      }\n    } else {\n      // Use all registered plugins\n      plugins = [].concat(Editor.plugins);\n    }\n\n    var result = {};\n    plugins.forEach(function (it) {\n      if (typeof result[it.comp.align] === 'undefined') {\n        result[it.comp.align] = [];\n      }\n\n      var key = it.comp.pluginName === 'divider' ? uuid() : it.comp.pluginName;\n      result[it.comp.align].push( /*#__PURE__*/React.createElement(it.comp, {\n        editor: _this2,\n        editorConfig: _this2.config,\n        config: _extends({}, it.comp.defaultConfig || {}, it.config || {}),\n        key: key\n      }));\n    });\n    return result;\n  } // sync left and right section's scroll\n  ;\n\n  _proto.handleSyncScroll = function handleSyncScroll(type, e) {\n    var _this3 = this;\n\n    // prevent loop\n    if (type !== this.shouldSyncScroll) {\n      return;\n    } // trigger events\n\n\n    if (this.props.onScroll) {\n      this.props.onScroll(e, type);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_SCROLL, e, type); // should sync scroll?\n\n    var _this$config$syncScro = this.config.syncScrollMode,\n        syncScrollMode = _this$config$syncScro === void 0 ? [] : _this$config$syncScro;\n\n    if (!syncScrollMode.includes(type === 'md' ? 'rightFollowLeft' : 'leftFollowRight')) {\n      return;\n    }\n\n    if (this.hasContentChanged && this.nodeMdText.current && this.nodeMdPreviewWrapper.current) {\n      // 计算出左右的比例\n      this.scrollScale = this.nodeMdText.current.scrollHeight / this.nodeMdPreviewWrapper.current.scrollHeight;\n      this.hasContentChanged = false;\n    }\n\n    if (!this.isSyncingScroll) {\n      this.isSyncingScroll = true;\n      requestAnimationFrame(function () {\n        if (_this3.nodeMdText.current && _this3.nodeMdPreviewWrapper.current) {\n          if (type === 'md') {\n            // left to right\n            _this3.nodeMdPreviewWrapper.current.scrollTop = _this3.nodeMdText.current.scrollTop / _this3.scrollScale;\n          } else {\n            // right to left\n            _this3.nodeMdText.current.scrollTop = _this3.nodeMdPreviewWrapper.current.scrollTop * _this3.scrollScale;\n          }\n        }\n\n        _this3.isSyncingScroll = false;\n      });\n    }\n  };\n\n  _proto.renderHTML = function renderHTML(markdownText) {\n    var _this4 = this;\n\n    if (!this.props.renderHTML) {\n      console.error('renderHTML props is required!');\n      return Promise.resolve();\n    }\n\n    var res = this.props.renderHTML(markdownText);\n\n    if (isPromise(res)) {\n      // @ts-ignore\n      return res.then(function (r) {\n        return _this4.setHtml(r);\n      });\n    }\n\n    if (typeof res === 'function') {\n      return this.setHtml(res());\n    }\n\n    return this.setHtml(res);\n  };\n\n  _proto.setHtml = function setHtml(html) {\n    var _this5 = this;\n\n    return new Promise(function (resolve) {\n      _this5.setState({\n        html: html\n      }, resolve);\n    });\n  };\n\n  _proto.handleToggleMenu = function handleToggleMenu() {\n    this.setView({\n      menu: !this.state.view.menu\n    });\n  };\n\n  _proto.handleFocus = function handleFocus(e) {\n    var onFocus = this.props.onFocus;\n\n    if (onFocus) {\n      onFocus(e);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_FOCUS, e);\n  };\n\n  _proto.handleBlur = function handleBlur(e) {\n    var onBlur = this.props.onBlur;\n\n    if (onBlur) {\n      onBlur(e);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_BLUR, e);\n  }\n  /**\n   * Text area change event\n   * @param {React.ChangeEvent} e\n   */\n  ;\n\n  _proto.handleChange = function handleChange(e) {\n    e.persist();\n    var value = e.target.value; // 触发内部事件\n\n    this.setText(value, e);\n  }\n  /**\n   * Listen paste event to support paste images\n   */\n  ;\n\n  _proto.handlePaste = function handlePaste(e) {\n    if (!this.config.allowPasteImage || !this.config.onImageUpload) {\n      return;\n    }\n\n    var event = e.nativeEvent; // @ts-ignore\n\n    var items = (event.clipboardData || window.clipboardData).items;\n\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  } // Drag images to upload\n  ;\n\n  _proto.handleDrop = function handleDrop(e) {\n    if (!this.config.onImageUpload) {\n      return;\n    }\n\n    var event = e.nativeEvent;\n\n    if (!event.dataTransfer) {\n      return;\n    }\n\n    var items = event.dataTransfer.items;\n\n    if (items) {\n      e.preventDefault();\n      this.uploadWithDataTransfer(items);\n    }\n  };\n\n  _proto.handleEditorKeyDown = function handleEditorKeyDown(e) {\n    var _this6 = this;\n\n    var keyCode = e.keyCode,\n        key = e.key,\n        currentTarget = e.currentTarget;\n\n    if ((keyCode === 13 || key === 'Enter') && this.composing === false) {\n      var _text = currentTarget.value;\n      var curPos = currentTarget.selectionStart;\n      var lineInfo = getLineAndCol(_text, curPos);\n\n      var emptyCurrentLine = function emptyCurrentLine() {\n        var newValue = currentTarget.value.substr(0, curPos - lineInfo.curLine.length) + currentTarget.value.substr(curPos);\n\n        _this6.setText(newValue, undefined, {\n          start: curPos - lineInfo.curLine.length,\n          end: curPos - lineInfo.curLine.length\n        });\n\n        e.preventDefault();\n      };\n\n      var addSymbol = function addSymbol(symbol) {\n        _this6.insertText(\"\\n\" + symbol, false, {\n          start: symbol.length + 1,\n          end: symbol.length + 1\n        });\n\n        e.preventDefault();\n      }; // Enter key, check previous line\n\n\n      var isSymbol = lineInfo.curLine.match(/^(\\s*?)\\* /);\n\n      if (isSymbol) {\n        if (/^(\\s*?)\\* $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n\n        addSymbol(isSymbol[0]);\n        return;\n      }\n\n      var isOrderList = lineInfo.curLine.match(/^(\\s*?)(\\d+)\\. /);\n\n      if (isOrderList) {\n        if (/^(\\s*?)(\\d+)\\. $/.test(lineInfo.curLine)) {\n          emptyCurrentLine();\n          return;\n        }\n\n        var toInsert = \"\" + isOrderList[1] + (parseInt(isOrderList[2], 10) + 1) + \". \";\n        addSymbol(toInsert);\n        return;\n      }\n    } // 触发默认事件\n\n\n    this.emitter.emit(this.emitter.EVENT_EDITOR_KEY_DOWN, e);\n  } // Handle language change\n  ;\n\n  _proto.handleLocaleUpdate = function handleLocaleUpdate() {\n    this.forceUpdate();\n  }\n  /**\n   * Get elements\n   */\n  ;\n\n  _proto.getMdElement = function getMdElement() {\n    return this.nodeMdText.current;\n  };\n\n  _proto.getHtmlElement = function getHtmlElement() {\n    return this.nodeMdPreviewWrapper.current;\n  }\n  /**\n   * Clear selected\n   */\n  ;\n\n  _proto.clearSelection = function clearSelection() {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(0, 0, 'none');\n    }\n  }\n  /**\n   * Get selected\n   * @return {Selection}\n   */\n  ;\n\n  _proto.getSelection = function getSelection() {\n    var source = this.nodeMdText.current;\n\n    if (!source) {\n      return _extends({}, initialSelection);\n    }\n\n    var start = source.selectionStart;\n    var end = source.selectionEnd;\n    var text = (source.value || '').slice(start, end);\n    return {\n      start: start,\n      end: end,\n      text: text\n    };\n  }\n  /**\n   * Set selected\n   * @param {Selection} to\n   */\n  ;\n\n  _proto.setSelection = function setSelection(to) {\n    if (this.nodeMdText.current) {\n      this.nodeMdText.current.setSelectionRange(to.start, to.end, 'forward');\n      this.nodeMdText.current.focus();\n    }\n  }\n  /**\n   * Insert markdown text\n   * @param type\n   * @param option\n   */\n  ;\n\n  _proto.insertMarkdown = function insertMarkdown(type, option) {\n    if (option === void 0) {\n      option = {};\n    }\n\n    var curSelection = this.getSelection();\n    var decorateOption = option ? _extends({}, option) : {};\n\n    if (type === 'image') {\n      decorateOption = _extends({}, decorateOption, {\n        target: option.target || curSelection.text || '',\n        imageUrl: option.imageUrl || this.config.imageUrl\n      });\n    }\n\n    if (type === 'link') {\n      decorateOption = _extends({}, decorateOption, {\n        linkUrl: this.config.linkUrl\n      });\n    }\n\n    if (type === 'tab' && curSelection.start !== curSelection.end) {\n      var curLineStart = this.getMdValue().slice(0, curSelection.start).lastIndexOf('\\n') + 1;\n      this.setSelection({\n        start: curLineStart,\n        end: curSelection.end\n      });\n    }\n\n    var decorate = getDecorated(curSelection.text, type, decorateOption);\n    var text = decorate.text;\n    var selection = decorate.selection;\n\n    if (decorate.newBlock) {\n      var startLineInfo = getLineAndCol(this.getMdValue(), curSelection.start);\n      var col = startLineInfo.col,\n          curLine = startLineInfo.curLine;\n\n      if (col > 0 && curLine.length > 0) {\n        text = \"\\n\" + text;\n\n        if (selection) {\n          selection.start++;\n          selection.end++;\n        }\n      }\n\n      var afterText = startLineInfo.afterText;\n\n      if (curSelection.start !== curSelection.end) {\n        afterText = getLineAndCol(this.getMdValue(), curSelection.end).afterText;\n      }\n\n      if (afterText.trim() !== '' && afterText.substr(0, 2) !== '\\n\\n') {\n        if (afterText.substr(0, 1) !== '\\n') {\n          text += '\\n';\n        }\n\n        text += '\\n';\n      }\n    }\n\n    this.insertText(text, true, selection);\n  }\n  /**\n   * Insert a placeholder, and replace it when the Promise resolved\n   * @param placeholder\n   * @param wait\n   */\n  ;\n\n  _proto.insertPlaceholder = function insertPlaceholder(placeholder, wait) {\n    var _this7 = this;\n\n    this.insertText(placeholder, true);\n    wait.then(function (str) {\n      var text = _this7.getMdValue().replace(placeholder, str);\n\n      _this7.setText(text);\n    });\n  }\n  /**\n   * Insert text\n   * @param {string} value The text will be insert\n   * @param {boolean} replaceSelected Replace selected text\n   * @param {Selection} newSelection New selection\n   */\n  ;\n\n  _proto.insertText = function insertText(value, replaceSelected, newSelection) {\n    if (value === void 0) {\n      value = '';\n    }\n\n    if (replaceSelected === void 0) {\n      replaceSelected = false;\n    }\n\n    var text = this.state.text;\n    var selection = this.getSelection();\n    var beforeContent = text.slice(0, selection.start);\n    var afterContent = text.slice(replaceSelected ? selection.end : selection.start, text.length);\n    this.setText(beforeContent + value + afterContent, undefined, newSelection ? {\n      start: newSelection.start + beforeContent.length,\n      end: newSelection.end + beforeContent.length\n    } : {\n      start: selection.start,\n      end: selection.start\n    });\n  }\n  /**\n   * Set text, and trigger onChange event\n   * @param {string} value\n   * @param {any} event\n   */\n  ;\n\n  _proto.setText = function setText(value, event, newSelection) {\n    var _this8 = this;\n\n    if (value === void 0) {\n      value = '';\n    }\n\n    var _this$config$onChange = this.config.onChangeTrigger,\n        onChangeTrigger = _this$config$onChange === void 0 ? 'both' : _this$config$onChange;\n    var text = value.replace(/↵/g, '\\n');\n\n    if (this.state.text === value) {\n      return;\n    }\n\n    this.setState({\n      text: text\n    });\n\n    if (this.props.onChange && (onChangeTrigger === 'both' || onChangeTrigger === 'beforeRender')) {\n      this.props.onChange({\n        text: text,\n        html: this.getHtmlValue()\n      }, event);\n    }\n\n    this.emitter.emit(this.emitter.EVENT_CHANGE, value, event, typeof event === 'undefined');\n\n    if (newSelection) {\n      setTimeout(function () {\n        return _this8.setSelection(newSelection);\n      });\n    }\n\n    if (!this.hasContentChanged) {\n      this.hasContentChanged = true;\n    }\n\n    var rendering = this.renderHTML(text);\n\n    if (onChangeTrigger === 'both' || onChangeTrigger === 'afterRender') {\n      rendering.then(function () {\n        if (_this8.props.onChange) {\n          _this8.props.onChange({\n            text: _this8.state.text,\n            html: _this8.getHtmlValue()\n          }, event);\n        }\n      });\n    }\n  }\n  /**\n   * Get text value\n   * @return {string}\n   */\n  ;\n\n  _proto.getMdValue = function getMdValue() {\n    return this.state.text;\n  }\n  /**\n   * Get rendered html\n   * @returns {string}\n   */\n  ;\n\n  _proto.getHtmlValue = function getHtmlValue() {\n    if (typeof this.state.html === 'string') {\n      return this.state.html;\n    }\n\n    if (this.nodeMdPreview.current) {\n      return this.nodeMdPreview.current.getHtml();\n    }\n\n    return '';\n  }\n  /**\n   * Listen keyboard events\n   */\n  ;\n\n  /**\n   * Listen keyboard events\n   * @param {KeyboardEventListener} data\n   */\n  _proto.onKeyboard = function onKeyboard(data) {\n    var _this9 = this;\n\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this9.onKeyboard(it);\n      });\n      return;\n    }\n\n    if (!this.keyboardListeners.includes(data)) {\n      this.keyboardListeners.push(data);\n    }\n  }\n  /**\n   * Un-listen keyboard events\n   * @param {KeyboardEventListener} data\n   */\n  ;\n\n  _proto.offKeyboard = function offKeyboard(data) {\n    var _this10 = this;\n\n    if (Array.isArray(data)) {\n      data.forEach(function (it) {\n        return _this10.offKeyboard(it);\n      });\n      return;\n    }\n\n    var index = this.keyboardListeners.indexOf(data);\n\n    if (index >= 0) {\n      this.keyboardListeners.splice(index, 1);\n    }\n  };\n\n  _proto.handleKeyDown = function handleKeyDown(e) {\n    // 遍历监听数组，找找有没有被监听\n    for (var _iterator3 = _createForOfIteratorHelperLoose(this.keyboardListeners), _step3; !(_step3 = _iterator3()).done;) {\n      var it = _step3.value;\n\n      if (isKeyMatch(e, it)) {\n        e.preventDefault();\n        it.callback(e);\n        return;\n      }\n    } // 如果没有，触发默认事件\n\n\n    this.emitter.emit(this.emitter.EVENT_KEY_DOWN, e);\n  };\n\n  _proto.getEventType = function getEventType(event) {\n    switch (event) {\n      case 'change':\n        return this.emitter.EVENT_CHANGE;\n\n      case 'fullscreen':\n        return this.emitter.EVENT_FULL_SCREEN;\n\n      case 'viewchange':\n        return this.emitter.EVENT_VIEW_CHANGE;\n\n      case 'keydown':\n        return this.emitter.EVENT_KEY_DOWN;\n\n      case 'editor_keydown':\n        return this.emitter.EVENT_EDITOR_KEY_DOWN;\n\n      case 'blur':\n        return this.emitter.EVENT_BLUR;\n\n      case 'focus':\n        return this.emitter.EVENT_FOCUS;\n\n      case 'scroll':\n        return this.emitter.EVENT_SCROLL;\n    }\n  }\n  /**\n   * Listen events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */\n  ;\n\n  _proto.on = function on(event, cb) {\n    var eventType = this.getEventType(event);\n\n    if (eventType) {\n      this.emitter.on(eventType, cb);\n    }\n  }\n  /**\n   * Un-listen events\n   * @param {EditorEvent} event Event type\n   * @param {any} cb Callback\n   */\n  ;\n\n  _proto.off = function off(event, cb) {\n    var eventType = this.getEventType(event);\n\n    if (eventType) {\n      this.emitter.off(eventType, cb);\n    }\n  }\n  /**\n   * Set view property\n   * Can show or hide: editor, preview, menu\n   * @param {object} to\n   */\n  ;\n\n  _proto.setView = function setView(to) {\n    var _this11 = this;\n\n    var newView = _extends({}, this.state.view, to);\n\n    this.setState({\n      view: newView\n    }, function () {\n      _this11.emitter.emit(_this11.emitter.EVENT_VIEW_CHANGE, newView);\n    });\n  }\n  /**\n   * Get view property\n   * @return {object}\n   */\n  ;\n\n  _proto.getView = function getView() {\n    return _extends({}, this.state.view);\n  }\n  /**\n   * Enter or exit full screen\n   * @param {boolean} enable\n   */\n  ;\n\n  _proto.fullScreen = function fullScreen(enable) {\n    var _this12 = this;\n\n    if (this.state.fullScreen !== enable) {\n      this.setState({\n        fullScreen: enable\n      }, function () {\n        _this12.emitter.emit(_this12.emitter.EVENT_FULL_SCREEN, enable);\n      });\n    }\n  }\n  /**\n   * Register a plugin API\n   * @param {string} name API name\n   * @param {any} cb callback\n   */\n  ;\n\n  _proto.registerPluginApi = function registerPluginApi(name, cb) {\n    this.pluginApis.set(name, cb);\n  };\n\n  _proto.unregisterPluginApi = function unregisterPluginApi(name) {\n    this.pluginApis.delete(name);\n  }\n  /**\n   * Call a plugin API\n   * @param {string} name API name\n   * @param {any} others arguments\n   * @returns {any}\n   */\n  ;\n\n  _proto.callPluginApi = function callPluginApi(name) {\n    var handler = this.pluginApis.get(name);\n\n    if (!handler) {\n      throw new Error(\"API \" + name + \" not found\");\n    }\n\n    for (var _len = arguments.length, others = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      others[_key - 1] = arguments[_key];\n    }\n\n    return handler.apply(void 0, others);\n  }\n  /**\n   * Is full screen\n   * @return {boolean}\n   */\n  ;\n\n  _proto.isFullScreen = function isFullScreen() {\n    return this.state.fullScreen;\n  };\n\n  _proto.uploadWithDataTransfer = function uploadWithDataTransfer(items) {\n    var _this13 = this;\n\n    var onImageUpload = this.config.onImageUpload;\n\n    if (!onImageUpload) {\n      return;\n    }\n\n    var queue = [];\n    Array.prototype.forEach.call(items, function (it) {\n      if (it.kind === 'file' && it.type.includes('image')) {\n        var file = it.getAsFile();\n\n        if (file) {\n          var placeholder = getUploadPlaceholder(file, onImageUpload);\n          queue.push(Promise.resolve(placeholder.placeholder));\n          placeholder.uploaded.then(function (str) {\n            var text = _this13.getMdValue().replace(placeholder.placeholder, str);\n\n            var offset = str.length - placeholder.placeholder.length; // 计算出替换后的光标位置\n\n            var selection = _this13.getSelection();\n\n            _this13.setText(text, undefined, {\n              start: selection.start + offset,\n              end: selection.start + offset\n            });\n          });\n        }\n      } else if (it.kind === 'string' && it.type === 'text/plain') {\n        queue.push(new Promise(function (resolve) {\n          return it.getAsString(resolve);\n        }));\n      }\n    });\n    Promise.all(queue).then(function (res) {\n      var text = res.join('');\n\n      var selection = _this13.getSelection();\n\n      _this13.insertText(text, true, {\n        start: selection.start === selection.end ? text.length : 0,\n        end: text.length\n      });\n    });\n  };\n\n  _proto.render = function render() {\n    var _this14 = this;\n\n    var _this$state = this.state,\n        view = _this$state.view,\n        fullScreen = _this$state.fullScreen,\n        text = _this$state.text,\n        html = _this$state.html;\n    var _this$props = this.props,\n        id = _this$props.id,\n        _this$props$className = _this$props.className,\n        className = _this$props$className === void 0 ? '' : _this$props$className,\n        style = _this$props.style,\n        _this$props$name = _this$props.name,\n        name = _this$props$name === void 0 ? 'textarea' : _this$props$name,\n        autoFocus = _this$props.autoFocus,\n        placeholder = _this$props.placeholder,\n        readOnly = _this$props.readOnly;\n    var showHideMenu = this.config.canView && this.config.canView.hideMenu && !this.config.canView.menu;\n\n    var getPluginAt = function getPluginAt(at) {\n      return _this14.state.plugins[at] || [];\n    };\n\n    var isShowMenu = !!view.menu;\n    var editorId = id ? id + \"_md\" : undefined;\n    var previewerId = id ? id + \"_html\" : undefined;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: id,\n      className: \"rc-md-editor \" + (fullScreen ? 'full' : '') + \" \" + className,\n      style: style,\n      onKeyDown: this.handleKeyDown,\n      onDrop: this.handleDrop\n    }, /*#__PURE__*/React.createElement(NavigationBar, {\n      visible: isShowMenu,\n      left: getPluginAt('left'),\n      right: getPluginAt('right')\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"editor-container\"\n    }, showHideMenu && /*#__PURE__*/React.createElement(ToolBar, null, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"button button-type-menu\",\n      title: isShowMenu ? 'hidden menu' : 'show menu',\n      onClick: this.handleToggleMenu\n    }, /*#__PURE__*/React.createElement(Icon, {\n      type: \"expand-\" + (isShowMenu ? 'less' : 'more')\n    }))), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-md \" + (view.md ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"textarea\", {\n      id: editorId,\n      ref: this.nodeMdText,\n      name: name,\n      autoFocus: autoFocus,\n      placeholder: placeholder,\n      readOnly: readOnly,\n      value: text,\n      className: \"section-container input \" + (this.config.markdownClass || ''),\n      wrap: \"hard\",\n      onChange: this.handleChange,\n      onScroll: this.handleInputScroll,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'md';\n      },\n      onKeyDown: this.handleEditorKeyDown,\n      onCompositionStart: function onCompositionStart() {\n        return _this14.composing = true;\n      },\n      onCompositionEnd: function onCompositionEnd() {\n        return _this14.composing = false;\n      },\n      onPaste: this.handlePaste,\n      onFocus: this.handleFocus,\n      onBlur: this.handleBlur\n    })), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"section sec-html \" + (view.html ? 'visible' : 'in-visible')\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: previewerId,\n      className: \"section-container html-wrap\",\n      ref: this.nodeMdPreviewWrapper,\n      onMouseOver: function onMouseOver() {\n        return _this14.shouldSyncScroll = 'html';\n      },\n      onScroll: this.handlePreviewScroll\n    }, /*#__PURE__*/React.createElement(HtmlRender, {\n      html: html,\n      className: this.config.htmlClass,\n      ref: this.nodeMdPreview\n    })))));\n  };\n\n  return Editor;\n}(React.Component);\n\nEditor.plugins = [];\nEditor.addLocale = i18n.add.bind(i18n);\nEditor.useLocale = i18n.setCurrent.bind(i18n);\nEditor.getLocale = i18n.getCurrent.bind(i18n);\nexport default Editor;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}