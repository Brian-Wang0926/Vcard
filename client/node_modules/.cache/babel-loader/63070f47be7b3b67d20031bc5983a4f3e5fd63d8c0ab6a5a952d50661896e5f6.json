{"ast":null,"code":"'use strict';\n\nvar CodeMirror = require('codemirror');\nrequire('codemirror/addon/edit/continuelist.js');\nrequire('./codemirror/tablist');\nrequire('codemirror/addon/display/fullscreen.js');\nrequire('codemirror/mode/markdown/markdown.js');\nrequire('codemirror/addon/mode/overlay.js');\nrequire('codemirror/addon/display/placeholder.js');\nrequire('codemirror/addon/display/autorefresh.js');\nrequire('codemirror/addon/selection/mark-selection.js');\nrequire('codemirror/addon/search/searchcursor.js');\nrequire('codemirror/mode/gfm/gfm.js');\nrequire('codemirror/mode/xml/xml.js');\nvar CodeMirrorSpellChecker = require('codemirror-spell-checker');\nvar marked = require('marked').marked;\n\n// Some variables\nvar isMac = /Mac/.test(navigator.platform);\nvar anchorToExternalRegex = new RegExp(/(<a.*?https?:\\/\\/.*?[^a]>)+?/g);\n\n// Mapping of actions that can be bound to keyboard shortcuts or toolbar buttons\nvar bindings = {\n  'toggleBold': toggleBold,\n  'toggleItalic': toggleItalic,\n  'drawLink': drawLink,\n  'toggleHeadingSmaller': toggleHeadingSmaller,\n  'toggleHeadingBigger': toggleHeadingBigger,\n  'drawImage': drawImage,\n  'toggleBlockquote': toggleBlockquote,\n  'toggleOrderedList': toggleOrderedList,\n  'toggleUnorderedList': toggleUnorderedList,\n  'toggleCodeBlock': toggleCodeBlock,\n  'togglePreview': togglePreview,\n  'toggleStrikethrough': toggleStrikethrough,\n  'toggleHeading1': toggleHeading1,\n  'toggleHeading2': toggleHeading2,\n  'toggleHeading3': toggleHeading3,\n  'toggleHeading4': toggleHeading4,\n  'toggleHeading5': toggleHeading5,\n  'toggleHeading6': toggleHeading6,\n  'cleanBlock': cleanBlock,\n  'drawTable': drawTable,\n  'drawHorizontalRule': drawHorizontalRule,\n  'undo': undo,\n  'redo': redo,\n  'toggleSideBySide': toggleSideBySide,\n  'toggleFullScreen': toggleFullScreen\n};\nvar shortcuts = {\n  'toggleBold': 'Cmd-B',\n  'toggleItalic': 'Cmd-I',\n  'drawLink': 'Cmd-K',\n  'toggleHeadingSmaller': 'Cmd-H',\n  'toggleHeadingBigger': 'Shift-Cmd-H',\n  'toggleHeading1': 'Ctrl+Alt+1',\n  'toggleHeading2': 'Ctrl+Alt+2',\n  'toggleHeading3': 'Ctrl+Alt+3',\n  'toggleHeading4': 'Ctrl+Alt+4',\n  'toggleHeading5': 'Ctrl+Alt+5',\n  'toggleHeading6': 'Ctrl+Alt+6',\n  'cleanBlock': 'Cmd-E',\n  'drawImage': 'Cmd-Alt-I',\n  'toggleBlockquote': 'Cmd-\\'',\n  'toggleOrderedList': 'Cmd-Alt-L',\n  'toggleUnorderedList': 'Cmd-L',\n  'toggleCodeBlock': 'Cmd-Alt-C',\n  'togglePreview': 'Cmd-P',\n  'toggleSideBySide': 'F9',\n  'toggleFullScreen': 'F11'\n};\nvar getBindingName = function (f) {\n  for (var key in bindings) {\n    if (bindings[key] === f) {\n      return key;\n    }\n  }\n  return null;\n};\nvar isMobile = function () {\n  var check = false;\n  (function (a) {\n    if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0, 4))) check = true;\n  })(navigator.userAgent || navigator.vendor || window.opera);\n  return check;\n};\n\n/**\n * Modify HTML to add 'target=\"_blank\"' to links so they open in new tabs by default.\n * @param {string} htmlText - HTML to be modified.\n * @return {string} The modified HTML text.\n */\nfunction addAnchorTargetBlank(htmlText) {\n  var match;\n  while ((match = anchorToExternalRegex.exec(htmlText)) !== null) {\n    // With only one capture group in the RegExp, we can safely take the first index from the match.\n    var linkString = match[0];\n    if (linkString.indexOf('target=') === -1) {\n      var fixedLinkString = linkString.replace(/>$/, ' target=\"_blank\">');\n      htmlText = htmlText.replace(linkString, fixedLinkString);\n    }\n  }\n  return htmlText;\n}\n\n/**\n * Modify HTML to remove the list-style when rendering checkboxes.\n * @param {string} htmlText - HTML to be modified.\n * @return {string} The modified HTML text.\n */\nfunction removeListStyleWhenCheckbox(htmlText) {\n  var parser = new DOMParser();\n  var htmlDoc = parser.parseFromString(htmlText, 'text/html');\n  var listItems = htmlDoc.getElementsByTagName('li');\n  for (var i = 0; i < listItems.length; i++) {\n    var listItem = listItems[i];\n    for (var j = 0; j < listItem.children.length; j++) {\n      var listItemChild = listItem.children[j];\n      if (listItemChild instanceof HTMLInputElement && listItemChild.type === 'checkbox') {\n        // From Github: margin: 0 .2em .25em -1.6em;\n        listItem.style.marginLeft = '-1.5em';\n        listItem.style.listStyleType = 'none';\n      }\n    }\n  }\n  return htmlDoc.documentElement.innerHTML;\n}\n\n/**\n * Fix shortcut. Mac use Command, others use Ctrl.\n */\nfunction fixShortcut(name) {\n  if (isMac) {\n    name = name.replace('Ctrl', 'Cmd');\n  } else {\n    name = name.replace('Cmd', 'Ctrl');\n  }\n  return name;\n}\n\n/**\n * Create dropdown block\n */\nfunction createToolbarDropdown(options, enableTooltips, shortcuts, parent) {\n  var el = createToolbarButton(options, false, enableTooltips, shortcuts, 'button', parent);\n  el.classList.add('easymde-dropdown');\n  el.onclick = function () {\n    el.focus();\n  };\n  var content = document.createElement('div');\n  content.className = 'easymde-dropdown-content';\n  for (var childrenIndex = 0; childrenIndex < options.children.length; childrenIndex++) {\n    var child = options.children[childrenIndex];\n    var childElement;\n    if (typeof child === 'string' && child in toolbarBuiltInButtons) {\n      childElement = createToolbarButton(toolbarBuiltInButtons[child], true, enableTooltips, shortcuts, 'button', parent);\n    } else {\n      childElement = createToolbarButton(child, true, enableTooltips, shortcuts, 'button', parent);\n    }\n    childElement.addEventListener('click', function (e) {\n      e.stopPropagation();\n    }, false);\n    content.appendChild(childElement);\n  }\n  el.appendChild(content);\n  return el;\n}\n\n/**\n * Create button element for toolbar.\n */\nfunction createToolbarButton(options, enableActions, enableTooltips, shortcuts, markup, parent) {\n  options = options || {};\n  var el = document.createElement(markup);\n\n  // Add 'custom' attributes as early as possible, so that 'official' attributes will never be overwritten.\n  if (options.attributes) {\n    for (var attribute in options.attributes) {\n      if (Object.prototype.hasOwnProperty.call(options.attributes, attribute)) {\n        el.setAttribute(attribute, options.attributes[attribute]);\n      }\n    }\n  }\n  var classNamePrefix = parent.options.toolbarButtonClassPrefix ? parent.options.toolbarButtonClassPrefix + '-' : '';\n  el.className = classNamePrefix + options.name;\n  el.setAttribute('type', markup);\n  enableTooltips = enableTooltips == undefined ? true : enableTooltips;\n  if (options.text) {\n    el.innerText = options.text;\n  }\n\n  // Properly handle custom shortcuts\n  if (options.name && options.name in shortcuts) {\n    bindings[options.name] = options.action;\n  }\n  if (options.title && enableTooltips) {\n    el.title = createTooltip(options.title, options.action, shortcuts);\n    if (isMac) {\n      el.title = el.title.replace('Ctrl', '⌘');\n      el.title = el.title.replace('Alt', '⌥');\n    }\n  }\n  if (options.title) {\n    el.setAttribute('aria-label', options.title);\n  }\n  if (options.noDisable) {\n    el.classList.add('no-disable');\n  }\n  if (options.noMobile) {\n    el.classList.add('no-mobile');\n  }\n\n  // Prevent errors if there is no class name in custom options\n  var classNameParts = [];\n  if (typeof options.className !== 'undefined') {\n    classNameParts = options.className.split(' ');\n  }\n\n  // Provide backwards compatibility with simple-markdown-editor by adding custom classes to the button.\n  var iconClasses = [];\n  for (var classNameIndex = 0; classNameIndex < classNameParts.length; classNameIndex++) {\n    var classNamePart = classNameParts[classNameIndex];\n    // Split icon classes from the button.\n    // Regex will detect \"fa\", \"fas\", \"fa-something\" and \"fa-some-icon-1\", but not \"fanfare\".\n    if (classNamePart.match(/^fa([srlb]|(-[\\w-]*)|$)/)) {\n      iconClasses.push(classNamePart);\n    } else {\n      el.classList.add(classNamePart);\n    }\n  }\n  el.tabIndex = -1;\n  if (iconClasses.length > 0) {\n    // Create icon element and append as a child to the button\n    var icon = document.createElement('i');\n    for (var iconClassIndex = 0; iconClassIndex < iconClasses.length; iconClassIndex++) {\n      var iconClass = iconClasses[iconClassIndex];\n      icon.classList.add(iconClass);\n    }\n    el.appendChild(icon);\n  }\n\n  // If there is a custom icon markup set, use that\n  if (typeof options.icon !== 'undefined') {\n    el.innerHTML = options.icon;\n  }\n  if (options.action && enableActions) {\n    if (typeof options.action === 'function') {\n      el.onclick = function (e) {\n        e.preventDefault();\n        options.action(parent);\n      };\n    } else if (typeof options.action === 'string') {\n      el.onclick = function (e) {\n        e.preventDefault();\n        window.open(options.action, '_blank');\n      };\n    }\n  }\n  return el;\n}\nfunction createSep() {\n  var el = document.createElement('i');\n  el.className = 'separator';\n  el.innerHTML = '|';\n  return el;\n}\nfunction createTooltip(title, action, shortcuts) {\n  var actionName;\n  var tooltip = title;\n  if (action) {\n    actionName = getBindingName(action);\n    if (shortcuts[actionName]) {\n      tooltip += ' (' + fixShortcut(shortcuts[actionName]) + ')';\n    }\n  }\n  return tooltip;\n}\n\n/**\n * The state of CodeMirror at the given position.\n */\nfunction getState(cm, pos) {\n  pos = pos || cm.getCursor('start');\n  var stat = cm.getTokenAt(pos);\n  if (!stat.type) return {};\n  var types = stat.type.split(' ');\n  var ret = {},\n    data,\n    text;\n  for (var i = 0; i < types.length; i++) {\n    data = types[i];\n    if (data === 'strong') {\n      ret.bold = true;\n    } else if (data === 'variable-2') {\n      text = cm.getLine(pos.line);\n      if (/^\\s*\\d+\\.\\s/.test(text)) {\n        ret['ordered-list'] = true;\n      } else {\n        ret['unordered-list'] = true;\n      }\n    } else if (data === 'atom') {\n      ret.quote = true;\n    } else if (data === 'em') {\n      ret.italic = true;\n    } else if (data === 'quote') {\n      ret.quote = true;\n    } else if (data === 'strikethrough') {\n      ret.strikethrough = true;\n    } else if (data === 'comment') {\n      ret.code = true;\n    } else if (data === 'link' && !ret.image) {\n      ret.link = true;\n    } else if (data === 'image') {\n      ret.image = true;\n    } else if (data.match(/^header(-[1-6])?$/)) {\n      ret[data.replace('header', 'heading')] = true;\n    }\n  }\n  return ret;\n}\n\n// Saved overflow setting\nvar saved_overflow = '';\n\n/**\n * Toggle full screen of the editor.\n * @param {EasyMDE} editor\n */\nfunction toggleFullScreen(editor) {\n  // Set fullscreen\n  var cm = editor.codemirror;\n  cm.setOption('fullScreen', !cm.getOption('fullScreen'));\n\n  // Prevent scrolling on body during fullscreen active\n  if (cm.getOption('fullScreen')) {\n    saved_overflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n  } else {\n    document.body.style.overflow = saved_overflow;\n  }\n  var wrapper = cm.getWrapperElement();\n  var sidebyside = wrapper.nextSibling;\n  if (sidebyside.classList.contains('editor-preview-active-side')) {\n    if (editor.options.sideBySideFullscreen === false) {\n      // if side-by-side not-fullscreen ok, apply classes as needed\n      var easyMDEContainer = wrapper.parentNode;\n      if (cm.getOption('fullScreen')) {\n        easyMDEContainer.classList.remove('sided--no-fullscreen');\n      } else {\n        easyMDEContainer.classList.add('sided--no-fullscreen');\n      }\n    } else {\n      toggleSideBySide(editor);\n    }\n  }\n  if (editor.options.onToggleFullScreen) {\n    editor.options.onToggleFullScreen(cm.getOption('fullScreen') || false);\n  }\n\n  // Remove or set maxHeight\n  if (typeof editor.options.maxHeight !== 'undefined') {\n    if (cm.getOption('fullScreen')) {\n      cm.getScrollerElement().style.removeProperty('height');\n      sidebyside.style.removeProperty('height');\n    } else {\n      cm.getScrollerElement().style.height = editor.options.maxHeight;\n      editor.setPreviewMaxHeight();\n    }\n  }\n\n  // Update toolbar class\n  editor.toolbar_div.classList.toggle('fullscreen');\n\n  // Update toolbar button\n  if (editor.toolbarElements && editor.toolbarElements.fullscreen) {\n    var toolbarButton = editor.toolbarElements.fullscreen;\n    toolbarButton.classList.toggle('active');\n  }\n}\n\n/**\n * Action for toggling bold.\n * @param {EasyMDE} editor\n */\nfunction toggleBold(editor) {\n  _toggleBlock(editor, 'bold', editor.options.blockStyles.bold);\n}\n\n/**\n * Action for toggling italic.\n * @param {EasyMDE} editor\n */\nfunction toggleItalic(editor) {\n  _toggleBlock(editor, 'italic', editor.options.blockStyles.italic);\n}\n\n/**\n * Action for toggling strikethrough.\n * @param {EasyMDE} editor\n */\nfunction toggleStrikethrough(editor) {\n  _toggleBlock(editor, 'strikethrough', '~~');\n}\n\n/**\n * Action for toggling code block.\n * @param {EasyMDE} editor\n */\nfunction toggleCodeBlock(editor) {\n  var fenceCharsToInsert = editor.options.blockStyles.code;\n  function fencing_line(line) {\n    /* return true, if this is a ``` or ~~~ line */\n    if (typeof line !== 'object') {\n      throw 'fencing_line() takes a \\'line\\' object (not a line number, or line text).  Got: ' + typeof line + ': ' + line;\n    }\n    return line.styles && line.styles[2] && line.styles[2].indexOf('formatting-code-block') !== -1;\n  }\n  function token_state(token) {\n    // base goes an extra level deep when mode backdrops are used, e.g. spellchecker on\n    return token.state.base.base || token.state.base;\n  }\n  function code_type(cm, line_num, line, firstTok, lastTok) {\n    /*\n     * Return \"single\", \"indented\", \"fenced\" or false\n     *\n     * cm and line_num are required.  Others are optional for efficiency\n     *   To check in the middle of a line, pass in firstTok yourself.\n     */\n    line = line || cm.getLineHandle(line_num);\n    firstTok = firstTok || cm.getTokenAt({\n      line: line_num,\n      ch: 1\n    });\n    lastTok = lastTok || !!line.text && cm.getTokenAt({\n      line: line_num,\n      ch: line.text.length - 1\n    });\n    var types = firstTok.type ? firstTok.type.split(' ') : [];\n    if (lastTok && token_state(lastTok).indentedCode) {\n      // have to check last char, since first chars of first line aren\"t marked as indented\n      return 'indented';\n    } else if (types.indexOf('comment') === -1) {\n      // has to be after \"indented\" check, since first chars of first indented line aren\"t marked as such\n      return false;\n    } else if (token_state(firstTok).fencedChars || token_state(lastTok).fencedChars || fencing_line(line)) {\n      return 'fenced';\n    } else {\n      return 'single';\n    }\n  }\n  function insertFencingAtSelection(cm, cur_start, cur_end, fenceCharsToInsert) {\n    var start_line_sel = cur_start.line + 1,\n      end_line_sel = cur_end.line + 1,\n      sel_multi = cur_start.line !== cur_end.line,\n      repl_start = fenceCharsToInsert + '\\n',\n      repl_end = '\\n' + fenceCharsToInsert;\n    if (sel_multi) {\n      end_line_sel++;\n    }\n    // handle last char including \\n or not\n    if (sel_multi && cur_end.ch === 0) {\n      repl_end = fenceCharsToInsert + '\\n';\n      end_line_sel--;\n    }\n    _replaceSelection(cm, false, [repl_start, repl_end]);\n    cm.setSelection({\n      line: start_line_sel,\n      ch: 0\n    }, {\n      line: end_line_sel,\n      ch: 0\n    });\n  }\n  var cm = editor.codemirror,\n    cur_start = cm.getCursor('start'),\n    cur_end = cm.getCursor('end'),\n    tok = cm.getTokenAt({\n      line: cur_start.line,\n      ch: cur_start.ch || 1\n    }),\n    // avoid ch 0 which is a cursor pos but not token\n    line = cm.getLineHandle(cur_start.line),\n    is_code = code_type(cm, cur_start.line, line, tok);\n  var block_start, block_end, lineCount;\n  if (is_code === 'single') {\n    // similar to some EasyMDE _toggleBlock logic\n    var start = line.text.slice(0, cur_start.ch).replace('`', ''),\n      end = line.text.slice(cur_start.ch).replace('`', '');\n    cm.replaceRange(start + end, {\n      line: cur_start.line,\n      ch: 0\n    }, {\n      line: cur_start.line,\n      ch: 99999999999999\n    });\n    cur_start.ch--;\n    if (cur_start !== cur_end) {\n      cur_end.ch--;\n    }\n    cm.setSelection(cur_start, cur_end);\n    cm.focus();\n  } else if (is_code === 'fenced') {\n    if (cur_start.line !== cur_end.line || cur_start.ch !== cur_end.ch) {\n      // use selection\n\n      // find the fenced line so we know what type it is (tilde, backticks, number of them)\n      for (block_start = cur_start.line; block_start >= 0; block_start--) {\n        line = cm.getLineHandle(block_start);\n        if (fencing_line(line)) {\n          break;\n        }\n      }\n      var fencedTok = cm.getTokenAt({\n        line: block_start,\n        ch: 1\n      });\n      var fence_chars = token_state(fencedTok).fencedChars;\n      var start_text, start_line;\n      var end_text, end_line;\n      // check for selection going up against fenced lines, in which case we don't want to add more fencing\n      if (fencing_line(cm.getLineHandle(cur_start.line))) {\n        start_text = '';\n        start_line = cur_start.line;\n      } else if (fencing_line(cm.getLineHandle(cur_start.line - 1))) {\n        start_text = '';\n        start_line = cur_start.line - 1;\n      } else {\n        start_text = fence_chars + '\\n';\n        start_line = cur_start.line;\n      }\n      if (fencing_line(cm.getLineHandle(cur_end.line))) {\n        end_text = '';\n        end_line = cur_end.line;\n        if (cur_end.ch === 0) {\n          end_line += 1;\n        }\n      } else if (cur_end.ch !== 0 && fencing_line(cm.getLineHandle(cur_end.line + 1))) {\n        end_text = '';\n        end_line = cur_end.line + 1;\n      } else {\n        end_text = fence_chars + '\\n';\n        end_line = cur_end.line + 1;\n      }\n      if (cur_end.ch === 0) {\n        // full last line selected, putting cursor at beginning of next\n        end_line -= 1;\n      }\n      cm.operation(function () {\n        // end line first, so that line numbers don't change\n        cm.replaceRange(end_text, {\n          line: end_line,\n          ch: 0\n        }, {\n          line: end_line + (end_text ? 0 : 1),\n          ch: 0\n        });\n        cm.replaceRange(start_text, {\n          line: start_line,\n          ch: 0\n        }, {\n          line: start_line + (start_text ? 0 : 1),\n          ch: 0\n        });\n      });\n      cm.setSelection({\n        line: start_line + (start_text ? 1 : 0),\n        ch: 0\n      }, {\n        line: end_line + (start_text ? 1 : -1),\n        ch: 0\n      });\n      cm.focus();\n    } else {\n      // no selection, search for ends of this fenced block\n      var search_from = cur_start.line;\n      if (fencing_line(cm.getLineHandle(cur_start.line))) {\n        // gets a little tricky if cursor is right on a fenced line\n        if (code_type(cm, cur_start.line + 1) === 'fenced') {\n          block_start = cur_start.line;\n          search_from = cur_start.line + 1; // for searching for \"end\"\n        } else {\n          block_end = cur_start.line;\n          search_from = cur_start.line - 1; // for searching for \"start\"\n        }\n      }\n\n      if (block_start === undefined) {\n        for (block_start = search_from; block_start >= 0; block_start--) {\n          line = cm.getLineHandle(block_start);\n          if (fencing_line(line)) {\n            break;\n          }\n        }\n      }\n      if (block_end === undefined) {\n        lineCount = cm.lineCount();\n        for (block_end = search_from; block_end < lineCount; block_end++) {\n          line = cm.getLineHandle(block_end);\n          if (fencing_line(line)) {\n            break;\n          }\n        }\n      }\n      cm.operation(function () {\n        cm.replaceRange('', {\n          line: block_start,\n          ch: 0\n        }, {\n          line: block_start + 1,\n          ch: 0\n        });\n        cm.replaceRange('', {\n          line: block_end - 1,\n          ch: 0\n        }, {\n          line: block_end,\n          ch: 0\n        });\n      });\n      cm.focus();\n    }\n  } else if (is_code === 'indented') {\n    if (cur_start.line !== cur_end.line || cur_start.ch !== cur_end.ch) {\n      // use selection\n      block_start = cur_start.line;\n      block_end = cur_end.line;\n      if (cur_end.ch === 0) {\n        block_end--;\n      }\n    } else {\n      // no selection, search for ends of this indented block\n      for (block_start = cur_start.line; block_start >= 0; block_start--) {\n        line = cm.getLineHandle(block_start);\n        if (line.text.match(/^\\s*$/)) {\n          // empty or all whitespace - keep going\n          continue;\n        } else {\n          if (code_type(cm, block_start, line) !== 'indented') {\n            block_start += 1;\n            break;\n          }\n        }\n      }\n      lineCount = cm.lineCount();\n      for (block_end = cur_start.line; block_end < lineCount; block_end++) {\n        line = cm.getLineHandle(block_end);\n        if (line.text.match(/^\\s*$/)) {\n          // empty or all whitespace - keep going\n          continue;\n        } else {\n          if (code_type(cm, block_end, line) !== 'indented') {\n            block_end -= 1;\n            break;\n          }\n        }\n      }\n    }\n    // if we are going to un-indent based on a selected set of lines, and the next line is indented too, we need to\n    // insert a blank line so that the next line(s) continue to be indented code\n    var next_line = cm.getLineHandle(block_end + 1),\n      next_line_last_tok = next_line && cm.getTokenAt({\n        line: block_end + 1,\n        ch: next_line.text.length - 1\n      }),\n      next_line_indented = next_line_last_tok && token_state(next_line_last_tok).indentedCode;\n    if (next_line_indented) {\n      cm.replaceRange('\\n', {\n        line: block_end + 1,\n        ch: 0\n      });\n    }\n    for (var i = block_start; i <= block_end; i++) {\n      cm.indentLine(i, 'subtract'); // TODO: this doesn't get tracked in the history, so can't be undone :(\n    }\n\n    cm.focus();\n  } else {\n    // insert code formatting\n    var no_sel_and_starting_of_line = cur_start.line === cur_end.line && cur_start.ch === cur_end.ch && cur_start.ch === 0;\n    var sel_multi = cur_start.line !== cur_end.line;\n    if (no_sel_and_starting_of_line || sel_multi) {\n      insertFencingAtSelection(cm, cur_start, cur_end, fenceCharsToInsert);\n    } else {\n      _replaceSelection(cm, false, ['`', '`']);\n    }\n  }\n}\n\n/**\n * Action for toggling blockquote.\n */\nfunction toggleBlockquote(editor) {\n  _toggleLine(editor.codemirror, 'quote');\n}\n\n/**\n * Action for toggling heading size: normal -> h1 -> h2 -> h3 -> h4 -> h5 -> h6 -> normal\n */\nfunction toggleHeadingSmaller(editor) {\n  _toggleHeading(editor.codemirror, 'smaller');\n}\n\n/**\n * Action for toggling heading size: normal -> h6 -> h5 -> h4 -> h3 -> h2 -> h1 -> normal\n */\nfunction toggleHeadingBigger(editor) {\n  _toggleHeading(editor.codemirror, 'bigger');\n}\n\n/**\n * Action for toggling heading size 1\n */\nfunction toggleHeading1(editor) {\n  _toggleHeading(editor.codemirror, undefined, 1);\n}\n\n/**\n * Action for toggling heading size 2\n */\nfunction toggleHeading2(editor) {\n  _toggleHeading(editor.codemirror, undefined, 2);\n}\n\n/**\n * Action for toggling heading size 3\n */\nfunction toggleHeading3(editor) {\n  _toggleHeading(editor.codemirror, undefined, 3);\n}\n\n/**\n * Action for toggling heading size 4\n */\nfunction toggleHeading4(editor) {\n  _toggleHeading(editor.codemirror, undefined, 4);\n}\n\n/**\n * Action for toggling heading size 5\n */\nfunction toggleHeading5(editor) {\n  _toggleHeading(editor.codemirror, undefined, 5);\n}\n\n/**\n * Action for toggling heading size 6\n */\nfunction toggleHeading6(editor) {\n  _toggleHeading(editor.codemirror, undefined, 6);\n}\n\n/**\n * Action for toggling ul.\n */\nfunction toggleUnorderedList(editor) {\n  var cm = editor.codemirror;\n  var listStyle = '*'; // Default\n  if (['-', '+', '*'].includes(editor.options.unorderedListStyle)) {\n    listStyle = editor.options.unorderedListStyle;\n  }\n  _toggleLine(cm, 'unordered-list', listStyle);\n}\n\n/**\n * Action for toggling ol.\n */\nfunction toggleOrderedList(editor) {\n  _toggleLine(editor.codemirror, 'ordered-list');\n}\n\n/**\n * Action for clean block (remove headline, list, blockquote code, markers)\n */\nfunction cleanBlock(editor) {\n  _cleanBlock(editor.codemirror);\n}\n\n/**\n * Action for drawing a link.\n * @param {EasyMDE} editor\n */\nfunction drawLink(editor) {\n  var options = editor.options;\n  var url = 'https://';\n  if (options.promptURLs) {\n    var result = prompt(options.promptTexts.link, url);\n    if (!result) {\n      return false;\n    }\n    url = escapePromptURL(result);\n  }\n  _toggleLink(editor, 'link', options.insertTexts.link, url);\n}\n\n/**\n * Action for drawing an img.\n * @param {EasyMDE} editor\n */\nfunction drawImage(editor) {\n  var options = editor.options;\n  var url = 'https://';\n  if (options.promptURLs) {\n    var result = prompt(options.promptTexts.image, url);\n    if (!result) {\n      return false;\n    }\n    url = escapePromptURL(result);\n  }\n  _toggleLink(editor, 'image', options.insertTexts.image, url);\n}\n\n/**\n * Encode and escape URLs to prevent breaking up rendered Markdown links.\n * @param {string} url The url of the link or image\n */\nfunction escapePromptURL(url) {\n  return encodeURI(url).replace(/([\\\\()])/g, '\\\\$1');\n}\n\n/**\n * Action for opening the browse-file window to upload an image to a server.\n * @param {EasyMDE} editor The EasyMDE object\n */\nfunction drawUploadedImage(editor) {\n  // TODO: Draw the image template with a fake url? ie: '![](importing foo.png...)'\n  editor.openBrowseFileWindow();\n}\n\n/**\n * Action executed after an image have been successfully imported on the server.\n * @param {EasyMDE} editor The EasyMDE object\n * @param {string} url The url of the uploaded image\n */\nfunction afterImageUploaded(editor, url) {\n  var cm = editor.codemirror;\n  var stat = getState(cm);\n  var options = editor.options;\n  var imageName = url.substr(url.lastIndexOf('/') + 1);\n  var ext = imageName.substring(imageName.lastIndexOf('.') + 1).replace(/\\?.*$/, '').toLowerCase();\n\n  // Check if media is an image\n  if (['png', 'jpg', 'jpeg', 'gif', 'svg', 'apng', 'avif', 'webp'].includes(ext)) {\n    _replaceSelection(cm, stat.image, options.insertTexts.uploadedImage, url);\n  } else {\n    var text_link = options.insertTexts.link;\n    text_link[0] = '[' + imageName;\n    _replaceSelection(cm, stat.link, text_link, url);\n  }\n\n  // show uploaded image filename for 1000ms\n  editor.updateStatusBar('upload-image', editor.options.imageTexts.sbOnUploaded.replace('#image_name#', imageName));\n  setTimeout(function () {\n    editor.updateStatusBar('upload-image', editor.options.imageTexts.sbInit);\n  }, 1000);\n}\n\n/**\n * Action for drawing a table.\n * @param {EasyMDE} editor\n */\nfunction drawTable(editor) {\n  var cm = editor.codemirror;\n  var stat = getState(cm);\n  var options = editor.options;\n  _replaceSelection(cm, stat.table, options.insertTexts.table);\n}\n\n/**\n * Action for drawing a horizontal rule.\n * @param {EasyMDE} editor\n */\nfunction drawHorizontalRule(editor) {\n  var cm = editor.codemirror;\n  var stat = getState(cm);\n  var options = editor.options;\n  _replaceSelection(cm, stat.image, options.insertTexts.horizontalRule);\n}\n\n/**\n * Undo action.\n * @param {EasyMDE} editor\n */\nfunction undo(editor) {\n  var cm = editor.codemirror;\n  cm.undo();\n  cm.focus();\n}\n\n/**\n * Redo action.\n * @param {EasyMDE} editor\n */\nfunction redo(editor) {\n  var cm = editor.codemirror;\n  cm.redo();\n  cm.focus();\n}\n\n/**\n * Toggle side by side preview\n * @param {EasyMDE} editor\n */\nfunction toggleSideBySide(editor) {\n  var cm = editor.codemirror;\n  var wrapper = cm.getWrapperElement();\n  var preview = wrapper.nextSibling;\n  var toolbarButton = editor.toolbarElements && editor.toolbarElements['side-by-side'];\n  var useSideBySideListener = false;\n  var easyMDEContainer = wrapper.parentNode;\n  if (preview.classList.contains('editor-preview-active-side')) {\n    if (editor.options.sideBySideFullscreen === false) {\n      // if side-by-side not-fullscreen ok, remove classes when hiding side\n      easyMDEContainer.classList.remove('sided--no-fullscreen');\n    }\n    preview.classList.remove('editor-preview-active-side');\n    if (toolbarButton) toolbarButton.classList.remove('active');\n    wrapper.classList.remove('CodeMirror-sided');\n  } else {\n    // When the preview button is clicked for the first time,\n    // give some time for the transition from editor.css to fire and the view to slide from right to left,\n    // instead of just appearing.\n    setTimeout(function () {\n      if (!cm.getOption('fullScreen')) {\n        if (editor.options.sideBySideFullscreen === false) {\n          // if side-by-side not-fullscreen ok, add classes when not fullscreen and showing side\n          easyMDEContainer.classList.add('sided--no-fullscreen');\n        } else {\n          toggleFullScreen(editor);\n        }\n      }\n      preview.classList.add('editor-preview-active-side');\n    }, 1);\n    if (toolbarButton) toolbarButton.classList.add('active');\n    wrapper.classList.add('CodeMirror-sided');\n    useSideBySideListener = true;\n  }\n\n  // Hide normal preview if active\n  var previewNormal = wrapper.lastChild;\n  if (previewNormal.classList.contains('editor-preview-active')) {\n    previewNormal.classList.remove('editor-preview-active');\n    var toolbar = editor.toolbarElements.preview;\n    var toolbar_div = editor.toolbar_div;\n    toolbar.classList.remove('active');\n    toolbar_div.classList.remove('disabled-for-preview');\n  }\n  var sideBySideRenderingFunction = function () {\n    var newValue = editor.options.previewRender(editor.value(), preview);\n    if (newValue != null) {\n      preview.innerHTML = newValue;\n    }\n  };\n  if (!cm.sideBySideRenderingFunction) {\n    cm.sideBySideRenderingFunction = sideBySideRenderingFunction;\n  }\n  if (useSideBySideListener) {\n    var newValue = editor.options.previewRender(editor.value(), preview);\n    if (newValue != null) {\n      preview.innerHTML = newValue;\n    }\n    cm.on('update', cm.sideBySideRenderingFunction);\n  } else {\n    cm.off('update', cm.sideBySideRenderingFunction);\n  }\n\n  // Refresh to fix selection being off (#309)\n  cm.refresh();\n}\n\n/**\n * Preview action.\n * @param {EasyMDE} editor\n */\nfunction togglePreview(editor) {\n  var cm = editor.codemirror;\n  var wrapper = cm.getWrapperElement();\n  var toolbar_div = editor.toolbar_div;\n  var toolbar = editor.options.toolbar ? editor.toolbarElements.preview : false;\n  var preview = wrapper.lastChild;\n\n  // Turn off side by side if needed\n  var sidebyside = cm.getWrapperElement().nextSibling;\n  if (sidebyside.classList.contains('editor-preview-active-side')) toggleSideBySide(editor);\n  if (!preview || !preview.classList.contains('editor-preview-full')) {\n    preview = document.createElement('div');\n    preview.className = 'editor-preview-full';\n    if (editor.options.previewClass) {\n      if (Array.isArray(editor.options.previewClass)) {\n        for (var i = 0; i < editor.options.previewClass.length; i++) {\n          preview.classList.add(editor.options.previewClass[i]);\n        }\n      } else if (typeof editor.options.previewClass === 'string') {\n        preview.classList.add(editor.options.previewClass);\n      }\n    }\n    wrapper.appendChild(preview);\n  }\n  if (preview.classList.contains('editor-preview-active')) {\n    preview.classList.remove('editor-preview-active');\n    if (toolbar) {\n      toolbar.classList.remove('active');\n      toolbar_div.classList.remove('disabled-for-preview');\n    }\n  } else {\n    // When the preview button is clicked for the first time,\n    // give some time for the transition from editor.css to fire and the view to slide from right to left,\n    // instead of just appearing.\n    setTimeout(function () {\n      preview.classList.add('editor-preview-active');\n    }, 1);\n    if (toolbar) {\n      toolbar.classList.add('active');\n      toolbar_div.classList.add('disabled-for-preview');\n    }\n  }\n  var preview_result = editor.options.previewRender(editor.value(), preview);\n  if (preview_result !== null) {\n    preview.innerHTML = preview_result;\n  }\n}\nfunction _replaceSelection(cm, active, startEnd, url) {\n  if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active')) return;\n  var text;\n  var start = startEnd[0];\n  var end = startEnd[1];\n  var startPoint = {},\n    endPoint = {};\n  Object.assign(startPoint, cm.getCursor('start'));\n  Object.assign(endPoint, cm.getCursor('end'));\n  if (url) {\n    start = start.replace('#url#', url); // url is in start for upload-image\n    end = end.replace('#url#', url);\n  }\n  if (active) {\n    text = cm.getLine(startPoint.line);\n    start = text.slice(0, startPoint.ch);\n    end = text.slice(startPoint.ch);\n    cm.replaceRange(start + end, {\n      line: startPoint.line,\n      ch: 0\n    });\n  } else {\n    text = cm.getSelection();\n    cm.replaceSelection(start + text + end);\n    startPoint.ch += start.length;\n    if (startPoint !== endPoint) {\n      endPoint.ch += start.length;\n    }\n  }\n  cm.setSelection(startPoint, endPoint);\n  cm.focus();\n}\nfunction _toggleHeading(cm, direction, size) {\n  if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active')) return;\n  var startPoint = cm.getCursor('start');\n  var endPoint = cm.getCursor('end');\n  for (var i = startPoint.line; i <= endPoint.line; i++) {\n    (function (i) {\n      var text = cm.getLine(i);\n      var currHeadingLevel = text.search(/[^#]/);\n      if (direction !== undefined) {\n        if (currHeadingLevel <= 0) {\n          if (direction == 'bigger') {\n            text = '###### ' + text;\n          } else {\n            text = '# ' + text;\n          }\n        } else if (currHeadingLevel == 6 && direction == 'smaller') {\n          text = text.substr(7);\n        } else if (currHeadingLevel == 1 && direction == 'bigger') {\n          text = text.substr(2);\n        } else {\n          if (direction == 'bigger') {\n            text = text.substr(1);\n          } else {\n            text = '#' + text;\n          }\n        }\n      } else {\n        if (currHeadingLevel <= 0) {\n          text = '#'.repeat(size) + ' ' + text;\n        } else if (currHeadingLevel == size) {\n          text = text.substr(currHeadingLevel + 1);\n        } else {\n          text = '#'.repeat(size) + ' ' + text.substr(currHeadingLevel + 1);\n        }\n      }\n      cm.replaceRange(text, {\n        line: i,\n        ch: 0\n      }, {\n        line: i,\n        ch: 99999999999999\n      });\n    })(i);\n  }\n  cm.focus();\n}\nfunction _toggleLine(cm, name, liststyle) {\n  if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active')) return;\n  var listRegexp = /^(\\s*)(\\*|-|\\+|\\d*\\.)(\\s+)/;\n  var whitespacesRegexp = /^\\s*/;\n  var stat = getState(cm);\n  var startPoint = cm.getCursor('start');\n  var endPoint = cm.getCursor('end');\n  var repl = {\n    'quote': /^(\\s*)>\\s+/,\n    'unordered-list': listRegexp,\n    'ordered-list': listRegexp\n  };\n  var _getChar = function (name, i) {\n    var map = {\n      'quote': '>',\n      'unordered-list': liststyle,\n      'ordered-list': '%%i.'\n    };\n    return map[name].replace('%%i', i);\n  };\n  var _checkChar = function (name, char) {\n    var map = {\n      'quote': '>',\n      'unordered-list': '\\\\' + liststyle,\n      'ordered-list': '\\\\d+.'\n    };\n    var rt = new RegExp(map[name]);\n    return char && rt.test(char);\n  };\n  var _toggle = function (name, text, untoggleOnly) {\n    var arr = listRegexp.exec(text);\n    var char = _getChar(name, line);\n    if (arr !== null) {\n      if (_checkChar(name, arr[2])) {\n        char = '';\n      }\n      text = arr[1] + char + arr[3] + text.replace(whitespacesRegexp, '').replace(repl[name], '$1');\n    } else if (untoggleOnly == false) {\n      text = char + ' ' + text;\n    }\n    return text;\n  };\n  var line = 1;\n  for (var i = startPoint.line; i <= endPoint.line; i++) {\n    (function (i) {\n      var text = cm.getLine(i);\n      if (stat[name]) {\n        text = text.replace(repl[name], '$1');\n      } else {\n        // If we're toggling unordered-list formatting, check if the current line\n        // is part of an ordered-list, and if so, untoggle that first.\n        // Workaround for https://github.com/Ionaru/easy-markdown-editor/issues/92\n        if (name == 'unordered-list') {\n          text = _toggle('ordered-list', text, true);\n        }\n        text = _toggle(name, text, false);\n        line += 1;\n      }\n      cm.replaceRange(text, {\n        line: i,\n        ch: 0\n      }, {\n        line: i,\n        ch: 99999999999999\n      });\n    })(i);\n  }\n  cm.focus();\n}\n\n/**\n * @param {EasyMDE} editor\n * @param {'link' | 'image'} type\n * @param {string} startEnd\n * @param {string} url\n */\nfunction _toggleLink(editor, type, startEnd, url) {\n  if (!editor.codemirror || editor.isPreviewActive()) {\n    return;\n  }\n  var cm = editor.codemirror;\n  var stat = getState(cm);\n  var active = stat[type];\n  if (!active) {\n    _replaceSelection(cm, active, startEnd, url);\n    return;\n  }\n  var startPoint = cm.getCursor('start');\n  var endPoint = cm.getCursor('end');\n  var text = cm.getLine(startPoint.line);\n  var start = text.slice(0, startPoint.ch);\n  var end = text.slice(startPoint.ch);\n  if (type == 'link') {\n    start = start.replace(/(.*)[^!]\\[/, '$1');\n  } else if (type == 'image') {\n    start = start.replace(/(.*)!\\[$/, '$1');\n  }\n  end = end.replace(/]\\(.*?\\)/, '');\n  cm.replaceRange(start + end, {\n    line: startPoint.line,\n    ch: 0\n  }, {\n    line: startPoint.line,\n    ch: 99999999999999\n  });\n  startPoint.ch -= startEnd[0].length;\n  if (startPoint !== endPoint) {\n    endPoint.ch -= startEnd[0].length;\n  }\n  cm.setSelection(startPoint, endPoint);\n  cm.focus();\n}\n\n/**\n * @param {EasyMDE} editor\n */\nfunction _toggleBlock(editor, type, start_chars, end_chars) {\n  if (!editor.codemirror || editor.isPreviewActive()) {\n    return;\n  }\n  end_chars = typeof end_chars === 'undefined' ? start_chars : end_chars;\n  var cm = editor.codemirror;\n  var stat = getState(cm);\n  var text;\n  var start = start_chars;\n  var end = end_chars;\n  var startPoint = cm.getCursor('start');\n  var endPoint = cm.getCursor('end');\n  if (stat[type]) {\n    text = cm.getLine(startPoint.line);\n    start = text.slice(0, startPoint.ch);\n    end = text.slice(startPoint.ch);\n    if (type == 'bold') {\n      start = start.replace(/(\\*\\*|__)(?![\\s\\S]*(\\*\\*|__))/, '');\n      end = end.replace(/(\\*\\*|__)/, '');\n    } else if (type == 'italic') {\n      start = start.replace(/(\\*|_)(?![\\s\\S]*(\\*|_))/, '');\n      end = end.replace(/(\\*|_)/, '');\n    } else if (type == 'strikethrough') {\n      start = start.replace(/(\\*\\*|~~)(?![\\s\\S]*(\\*\\*|~~))/, '');\n      end = end.replace(/(\\*\\*|~~)/, '');\n    }\n    cm.replaceRange(start + end, {\n      line: startPoint.line,\n      ch: 0\n    }, {\n      line: startPoint.line,\n      ch: 99999999999999\n    });\n    if (type == 'bold' || type == 'strikethrough') {\n      startPoint.ch -= 2;\n      if (startPoint !== endPoint) {\n        endPoint.ch -= 2;\n      }\n    } else if (type == 'italic') {\n      startPoint.ch -= 1;\n      if (startPoint !== endPoint) {\n        endPoint.ch -= 1;\n      }\n    }\n  } else {\n    text = cm.getSelection();\n    if (type == 'bold') {\n      text = text.split('**').join('');\n      text = text.split('__').join('');\n    } else if (type == 'italic') {\n      text = text.split('*').join('');\n      text = text.split('_').join('');\n    } else if (type == 'strikethrough') {\n      text = text.split('~~').join('');\n    }\n    cm.replaceSelection(start + text + end);\n    startPoint.ch += start_chars.length;\n    endPoint.ch = startPoint.ch + text.length;\n  }\n  cm.setSelection(startPoint, endPoint);\n  cm.focus();\n}\nfunction _cleanBlock(cm) {\n  if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active')) return;\n  var startPoint = cm.getCursor('start');\n  var endPoint = cm.getCursor('end');\n  var text;\n  for (var line = startPoint.line; line <= endPoint.line; line++) {\n    text = cm.getLine(line);\n    text = text.replace(/^[ ]*([# ]+|\\*|-|[> ]+|[0-9]+(.|\\)))[ ]*/, '');\n    cm.replaceRange(text, {\n      line: line,\n      ch: 0\n    }, {\n      line: line,\n      ch: 99999999999999\n    });\n  }\n}\n\n/**\n * Convert a number of bytes to a human-readable file size. If you desire\n * to add a space between the value and the unit, you need to add this space\n * to the given units.\n * @param bytes {number} A number of bytes, as integer. Ex: 421137\n * @param units {number[]} An array of human-readable units, ie. [' B', ' K', ' MB']\n * @returns string A human-readable file size. Ex: '412 KB'\n */\nfunction humanFileSize(bytes, units) {\n  if (Math.abs(bytes) < 1024) {\n    return '' + bytes + units[0];\n  }\n  var u = 0;\n  do {\n    bytes /= 1024;\n    ++u;\n  } while (Math.abs(bytes) >= 1024 && u < units.length);\n  return '' + bytes.toFixed(1) + units[u];\n}\n\n// Merge the properties of one object into another.\nfunction _mergeProperties(target, source) {\n  for (var property in source) {\n    if (Object.prototype.hasOwnProperty.call(source, property)) {\n      if (source[property] instanceof Array) {\n        target[property] = source[property].concat(target[property] instanceof Array ? target[property] : []);\n      } else if (source[property] !== null && typeof source[property] === 'object' && source[property].constructor === Object) {\n        target[property] = _mergeProperties(target[property] || {}, source[property]);\n      } else {\n        target[property] = source[property];\n      }\n    }\n  }\n  return target;\n}\n\n// Merge an arbitrary number of objects into one.\nfunction extend(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    target = _mergeProperties(target, arguments[i]);\n  }\n  return target;\n}\n\n/* The right word count in respect for CJK. */\nfunction wordCount(data) {\n  var pattern = /[a-zA-Z0-9_\\u00A0-\\u02AF\\u0392-\\u03c9\\u0410-\\u04F9]+|[\\u4E00-\\u9FFF\\u3400-\\u4dbf\\uf900-\\ufaff\\u3040-\\u309f\\uac00-\\ud7af]+/g;\n  var m = data.match(pattern);\n  var count = 0;\n  if (m === null) return count;\n  for (var i = 0; i < m.length; i++) {\n    if (m[i].charCodeAt(0) >= 0x4E00) {\n      count += m[i].length;\n    } else {\n      count += 1;\n    }\n  }\n  return count;\n}\nvar iconClassMap = {\n  'bold': 'fa fa-bold',\n  'italic': 'fa fa-italic',\n  'strikethrough': 'fa fa-strikethrough',\n  'heading': 'fa fa-header fa-heading',\n  'heading-smaller': 'fa fa-header fa-heading header-smaller',\n  'heading-bigger': 'fa fa-header fa-heading header-bigger',\n  'heading-1': 'fa fa-header fa-heading header-1',\n  'heading-2': 'fa fa-header fa-heading header-2',\n  'heading-3': 'fa fa-header fa-heading header-3',\n  'code': 'fa fa-code',\n  'quote': 'fa fa-quote-left',\n  'ordered-list': 'fa fa-list-ol',\n  'unordered-list': 'fa fa-list-ul',\n  'clean-block': 'fa fa-eraser',\n  'link': 'fa fa-link',\n  'image': 'fa fa-image',\n  'upload-image': 'fa fa-image',\n  'table': 'fa fa-table',\n  'horizontal-rule': 'fa fa-minus',\n  'preview': 'fa fa-eye',\n  'side-by-side': 'fa fa-columns',\n  'fullscreen': 'fa fa-arrows-alt',\n  'guide': 'fa fa-question-circle',\n  'undo': 'fa fa-undo',\n  'redo': 'fa fa-repeat fa-redo'\n};\nvar toolbarBuiltInButtons = {\n  'bold': {\n    name: 'bold',\n    action: toggleBold,\n    className: iconClassMap['bold'],\n    title: 'Bold',\n    default: true\n  },\n  'italic': {\n    name: 'italic',\n    action: toggleItalic,\n    className: iconClassMap['italic'],\n    title: 'Italic',\n    default: true\n  },\n  'strikethrough': {\n    name: 'strikethrough',\n    action: toggleStrikethrough,\n    className: iconClassMap['strikethrough'],\n    title: 'Strikethrough'\n  },\n  'heading': {\n    name: 'heading',\n    action: toggleHeadingSmaller,\n    className: iconClassMap['heading'],\n    title: 'Heading',\n    default: true\n  },\n  'heading-smaller': {\n    name: 'heading-smaller',\n    action: toggleHeadingSmaller,\n    className: iconClassMap['heading-smaller'],\n    title: 'Smaller Heading'\n  },\n  'heading-bigger': {\n    name: 'heading-bigger',\n    action: toggleHeadingBigger,\n    className: iconClassMap['heading-bigger'],\n    title: 'Bigger Heading'\n  },\n  'heading-1': {\n    name: 'heading-1',\n    action: toggleHeading1,\n    className: iconClassMap['heading-1'],\n    title: 'Big Heading'\n  },\n  'heading-2': {\n    name: 'heading-2',\n    action: toggleHeading2,\n    className: iconClassMap['heading-2'],\n    title: 'Medium Heading'\n  },\n  'heading-3': {\n    name: 'heading-3',\n    action: toggleHeading3,\n    className: iconClassMap['heading-3'],\n    title: 'Small Heading'\n  },\n  'separator-1': {\n    name: 'separator-1'\n  },\n  'code': {\n    name: 'code',\n    action: toggleCodeBlock,\n    className: iconClassMap['code'],\n    title: 'Code'\n  },\n  'quote': {\n    name: 'quote',\n    action: toggleBlockquote,\n    className: iconClassMap['quote'],\n    title: 'Quote',\n    default: true\n  },\n  'unordered-list': {\n    name: 'unordered-list',\n    action: toggleUnorderedList,\n    className: iconClassMap['unordered-list'],\n    title: 'Generic List',\n    default: true\n  },\n  'ordered-list': {\n    name: 'ordered-list',\n    action: toggleOrderedList,\n    className: iconClassMap['ordered-list'],\n    title: 'Numbered List',\n    default: true\n  },\n  'clean-block': {\n    name: 'clean-block',\n    action: cleanBlock,\n    className: iconClassMap['clean-block'],\n    title: 'Clean block'\n  },\n  'separator-2': {\n    name: 'separator-2'\n  },\n  'link': {\n    name: 'link',\n    action: drawLink,\n    className: iconClassMap['link'],\n    title: 'Create Link',\n    default: true\n  },\n  'image': {\n    name: 'image',\n    action: drawImage,\n    className: iconClassMap['image'],\n    title: 'Insert Image',\n    default: true\n  },\n  'upload-image': {\n    name: 'upload-image',\n    action: drawUploadedImage,\n    className: iconClassMap['upload-image'],\n    title: 'Import an image'\n  },\n  'table': {\n    name: 'table',\n    action: drawTable,\n    className: iconClassMap['table'],\n    title: 'Insert Table'\n  },\n  'horizontal-rule': {\n    name: 'horizontal-rule',\n    action: drawHorizontalRule,\n    className: iconClassMap['horizontal-rule'],\n    title: 'Insert Horizontal Line'\n  },\n  'separator-3': {\n    name: 'separator-3'\n  },\n  'preview': {\n    name: 'preview',\n    action: togglePreview,\n    className: iconClassMap['preview'],\n    noDisable: true,\n    title: 'Toggle Preview',\n    default: true\n  },\n  'side-by-side': {\n    name: 'side-by-side',\n    action: toggleSideBySide,\n    className: iconClassMap['side-by-side'],\n    noDisable: true,\n    noMobile: true,\n    title: 'Toggle Side by Side',\n    default: true\n  },\n  'fullscreen': {\n    name: 'fullscreen',\n    action: toggleFullScreen,\n    className: iconClassMap['fullscreen'],\n    noDisable: true,\n    noMobile: true,\n    title: 'Toggle Fullscreen',\n    default: true\n  },\n  'separator-4': {\n    name: 'separator-4'\n  },\n  'guide': {\n    name: 'guide',\n    action: 'https://www.markdownguide.org/basic-syntax/',\n    className: iconClassMap['guide'],\n    noDisable: true,\n    title: 'Markdown Guide',\n    default: true\n  },\n  'separator-5': {\n    name: 'separator-5'\n  },\n  'undo': {\n    name: 'undo',\n    action: undo,\n    className: iconClassMap['undo'],\n    noDisable: true,\n    title: 'Undo'\n  },\n  'redo': {\n    name: 'redo',\n    action: redo,\n    className: iconClassMap['redo'],\n    noDisable: true,\n    title: 'Redo'\n  }\n};\nvar insertTexts = {\n  link: ['[', '](#url#)'],\n  image: ['![', '](#url#)'],\n  uploadedImage: ['![](#url#)', ''],\n  // uploadedImage: ['![](#url#)\\n', ''], // TODO: New line insertion doesn't work here.\n  table: ['', '\\n\\n| Column 1 | Column 2 | Column 3 |\\n| -------- | -------- | -------- |\\n| Text     | Text     | Text     |\\n\\n'],\n  horizontalRule: ['', '\\n\\n-----\\n\\n']\n};\nvar promptTexts = {\n  link: 'URL for the link:',\n  image: 'URL of the image:'\n};\nvar timeFormat = {\n  locale: 'en-US',\n  format: {\n    hour: '2-digit',\n    minute: '2-digit'\n  }\n};\nvar blockStyles = {\n  'bold': '**',\n  'code': '```',\n  'italic': '*'\n};\n\n/**\n * Texts displayed to the user (mainly on the status bar) for the import image\n * feature. Can be used for customization or internationalization.\n */\nvar imageTexts = {\n  sbInit: 'Attach files by drag and dropping or pasting from clipboard.',\n  sbOnDragEnter: 'Drop image to upload it.',\n  sbOnDrop: 'Uploading image #images_names#...',\n  sbProgress: 'Uploading #file_name#: #progress#%',\n  sbOnUploaded: 'Uploaded #image_name#',\n  sizeUnits: ' B, KB, MB'\n};\n\n/**\n * Errors displayed to the user, using the `errorCallback` option. Can be used for\n * customization or internationalization.\n */\nvar errorMessages = {\n  noFileGiven: 'You must select a file.',\n  typeNotAllowed: 'This image type is not allowed.',\n  fileTooLarge: 'Image #image_name# is too big (#image_size#).\\n' + 'Maximum file size is #image_max_size#.',\n  importError: 'Something went wrong when uploading the image #image_name#.'\n};\n\n/**\n * Interface of EasyMDE.\n */\nfunction EasyMDE(options) {\n  // Handle options parameter\n  options = options || {};\n\n  // Used later to refer to it\"s parent\n  options.parent = this;\n\n  // Check if Font Awesome needs to be auto downloaded\n  var autoDownloadFA = true;\n  if (options.autoDownloadFontAwesome === false) {\n    autoDownloadFA = false;\n  }\n  if (options.autoDownloadFontAwesome !== true) {\n    var styleSheets = document.styleSheets;\n    for (var i = 0; i < styleSheets.length; i++) {\n      if (!styleSheets[i].href) continue;\n      if (styleSheets[i].href.indexOf('//maxcdn.bootstrapcdn.com/font-awesome/') > -1) {\n        autoDownloadFA = false;\n      }\n    }\n  }\n  if (autoDownloadFA) {\n    var link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = 'https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css';\n    document.getElementsByTagName('head')[0].appendChild(link);\n  }\n\n  // Find the textarea to use\n  if (options.element) {\n    this.element = options.element;\n  } else if (options.element === null) {\n    // This means that the element option was specified, but no element was found\n    console.log('EasyMDE: Error. No element was found.');\n    return;\n  }\n\n  // Handle toolbar\n  if (options.toolbar === undefined) {\n    // Initialize\n    options.toolbar = [];\n\n    // Loop over the built in buttons, to get the preferred order\n    for (var key in toolbarBuiltInButtons) {\n      if (Object.prototype.hasOwnProperty.call(toolbarBuiltInButtons, key)) {\n        if (key.indexOf('separator-') != -1) {\n          options.toolbar.push('|');\n        }\n        if (toolbarBuiltInButtons[key].default === true || options.showIcons && options.showIcons.constructor === Array && options.showIcons.indexOf(key) != -1) {\n          options.toolbar.push(key);\n        }\n      }\n    }\n  }\n\n  // Editor preview styling class.\n  if (!Object.prototype.hasOwnProperty.call(options, 'previewClass')) {\n    options.previewClass = 'editor-preview';\n  }\n\n  // Handle status bar\n  if (!Object.prototype.hasOwnProperty.call(options, 'status')) {\n    options.status = ['autosave', 'lines', 'words', 'cursor'];\n    if (options.uploadImage) {\n      options.status.unshift('upload-image');\n    }\n  }\n\n  // Add default preview rendering function\n  if (!options.previewRender) {\n    options.previewRender = function (plainText) {\n      // Note: \"this\" refers to the options object\n      return this.parent.markdown(plainText);\n    };\n  }\n\n  // Set default options for parsing config\n  options.parsingConfig = extend({\n    highlightFormatting: true // needed for toggleCodeBlock to detect types of code\n  }, options.parsingConfig || {});\n\n  // Merging the insertTexts, with the given options\n  options.insertTexts = extend({}, insertTexts, options.insertTexts || {});\n\n  // Merging the promptTexts, with the given options\n  options.promptTexts = extend({}, promptTexts, options.promptTexts || {});\n\n  // Merging the blockStyles, with the given options\n  options.blockStyles = extend({}, blockStyles, options.blockStyles || {});\n  if (options.autosave != undefined) {\n    // Merging the Autosave timeFormat, with the given options\n    options.autosave.timeFormat = extend({}, timeFormat, options.autosave.timeFormat || {});\n  }\n  options.iconClassMap = extend({}, iconClassMap, options.iconClassMap || {});\n\n  // Merging the shortcuts, with the given options\n  options.shortcuts = extend({}, shortcuts, options.shortcuts || {});\n  options.maxHeight = options.maxHeight || undefined;\n  options.direction = options.direction || 'ltr';\n  if (typeof options.maxHeight !== 'undefined') {\n    // Min and max height are equal if maxHeight is set\n    options.minHeight = options.maxHeight;\n  } else {\n    options.minHeight = options.minHeight || '300px';\n  }\n  options.errorCallback = options.errorCallback || function (errorMessage) {\n    alert(errorMessage);\n  };\n\n  // Import-image default configuration\n  options.uploadImage = options.uploadImage || false;\n  options.imageMaxSize = options.imageMaxSize || 2097152; // 1024 * 1024 * 2\n  options.imageAccept = options.imageAccept || 'image/png, image/jpeg, image/gif, image/avif';\n  options.imageTexts = extend({}, imageTexts, options.imageTexts || {});\n  options.errorMessages = extend({}, errorMessages, options.errorMessages || {});\n  options.imagePathAbsolute = options.imagePathAbsolute || false;\n  options.imageCSRFName = options.imageCSRFName || 'csrfmiddlewaretoken';\n  options.imageCSRFHeader = options.imageCSRFHeader || false;\n\n  // Change unique_id to uniqueId for backwards compatibility\n  if (options.autosave != undefined && options.autosave.unique_id != undefined && options.autosave.unique_id != '') options.autosave.uniqueId = options.autosave.unique_id;\n\n  // If overlay mode is specified and combine is not provided, default it to true\n  if (options.overlayMode && options.overlayMode.combine === undefined) {\n    options.overlayMode.combine = true;\n  }\n\n  // Update this options\n  this.options = options;\n\n  // Auto render\n  this.render();\n\n  // The codemirror component is only available after rendering\n  // so, the setter for the initialValue can only run after\n  // the element has been rendered\n  if (options.initialValue && (!this.options.autosave || this.options.autosave.foundSavedValue !== true)) {\n    this.value(options.initialValue);\n  }\n  if (options.uploadImage) {\n    var self = this;\n    this.codemirror.on('dragenter', function (cm, event) {\n      self.updateStatusBar('upload-image', self.options.imageTexts.sbOnDragEnter);\n      event.stopPropagation();\n      event.preventDefault();\n    });\n    this.codemirror.on('dragend', function (cm, event) {\n      self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n      event.stopPropagation();\n      event.preventDefault();\n    });\n    this.codemirror.on('dragleave', function (cm, event) {\n      self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n      event.stopPropagation();\n      event.preventDefault();\n    });\n    this.codemirror.on('dragover', function (cm, event) {\n      self.updateStatusBar('upload-image', self.options.imageTexts.sbOnDragEnter);\n      event.stopPropagation();\n      event.preventDefault();\n    });\n    this.codemirror.on('drop', function (cm, event) {\n      event.stopPropagation();\n      event.preventDefault();\n      if (options.imageUploadFunction) {\n        self.uploadImagesUsingCustomFunction(options.imageUploadFunction, event.dataTransfer.files);\n      } else {\n        self.uploadImages(event.dataTransfer.files);\n      }\n    });\n    this.codemirror.on('paste', function (cm, event) {\n      if (options.imageUploadFunction) {\n        self.uploadImagesUsingCustomFunction(options.imageUploadFunction, event.clipboardData.files);\n      } else {\n        self.uploadImages(event.clipboardData.files);\n      }\n    });\n  }\n}\n\n/**\n * Upload asynchronously a list of images to a server.\n *\n * Can be triggered by:\n * - drag&drop;\n * - copy-paste;\n * - the browse-file window (opened when the user clicks on the *upload-image* icon).\n * @param {FileList} files The files to upload the the server.\n * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage\n * @param [onError] {function} see EasyMDE.prototype.uploadImage\n */\nEasyMDE.prototype.uploadImages = function (files, onSuccess, onError) {\n  if (files.length === 0) {\n    return;\n  }\n  var names = [];\n  for (var i = 0; i < files.length; i++) {\n    names.push(files[i].name);\n    this.uploadImage(files[i], onSuccess, onError);\n  }\n  this.updateStatusBar('upload-image', this.options.imageTexts.sbOnDrop.replace('#images_names#', names.join(', ')));\n};\n\n/**\n * Upload asynchronously a list of images to a server.\n *\n * Can be triggered by:\n * - drag&drop;\n * - copy-paste;\n * - the browse-file window (opened when the user clicks on the *upload-image* icon).\n * @param imageUploadFunction {Function} The custom function to upload the image passed in options.\n * @param {FileList} files The files to upload the the server.\n */\nEasyMDE.prototype.uploadImagesUsingCustomFunction = function (imageUploadFunction, files) {\n  if (files.length === 0) {\n    return;\n  }\n  var names = [];\n  for (var i = 0; i < files.length; i++) {\n    names.push(files[i].name);\n    this.uploadImageUsingCustomFunction(imageUploadFunction, files[i]);\n  }\n  this.updateStatusBar('upload-image', this.options.imageTexts.sbOnDrop.replace('#images_names#', names.join(', ')));\n};\n\n/**\n * Update an item in the status bar.\n * @param itemName {string} The name of the item to update (ie. 'upload-image', 'autosave', etc.).\n * @param content {string} the new content of the item to write in the status bar.\n */\nEasyMDE.prototype.updateStatusBar = function (itemName, content) {\n  if (!this.gui.statusbar) {\n    return;\n  }\n  var matchingClasses = this.gui.statusbar.getElementsByClassName(itemName);\n  if (matchingClasses.length === 1) {\n    this.gui.statusbar.getElementsByClassName(itemName)[0].textContent = content;\n  } else if (matchingClasses.length === 0) {\n    console.log('EasyMDE: status bar item ' + itemName + ' was not found.');\n  } else {\n    console.log('EasyMDE: Several status bar items named ' + itemName + ' was found.');\n  }\n};\n\n/**\n * Default markdown render.\n */\nEasyMDE.prototype.markdown = function (text) {\n  if (marked) {\n    // Initialize\n    var markedOptions;\n    if (this.options && this.options.renderingConfig && this.options.renderingConfig.markedOptions) {\n      markedOptions = this.options.renderingConfig.markedOptions;\n    } else {\n      markedOptions = {};\n    }\n\n    // Update options\n    if (this.options && this.options.renderingConfig && this.options.renderingConfig.singleLineBreaks === false) {\n      markedOptions.breaks = false;\n    } else {\n      markedOptions.breaks = true;\n    }\n    if (this.options && this.options.renderingConfig && this.options.renderingConfig.codeSyntaxHighlighting === true) {\n      /* Get HLJS from config or window */\n      var hljs = this.options.renderingConfig.hljs || window.hljs;\n\n      /* Check if HLJS loaded */\n      if (hljs) {\n        markedOptions.highlight = function (code, language) {\n          if (language && hljs.getLanguage(language)) {\n            return hljs.highlight(language, code).value;\n          } else {\n            return hljs.highlightAuto(code).value;\n          }\n        };\n      }\n    }\n\n    // Set options\n    marked.setOptions(markedOptions);\n\n    // Convert the markdown to HTML\n    var htmlText = marked.parse(text);\n\n    // Sanitize HTML\n    if (this.options.renderingConfig && typeof this.options.renderingConfig.sanitizerFunction === 'function') {\n      htmlText = this.options.renderingConfig.sanitizerFunction.call(this, htmlText);\n    }\n\n    // Edit the HTML anchors to add 'target=\"_blank\"' by default.\n    htmlText = addAnchorTargetBlank(htmlText);\n\n    // Remove list-style when rendering checkboxes\n    htmlText = removeListStyleWhenCheckbox(htmlText);\n    return htmlText;\n  }\n};\n\n/**\n * Render editor to the given element.\n */\nEasyMDE.prototype.render = function (el) {\n  if (!el) {\n    el = this.element || document.getElementsByTagName('textarea')[0];\n  }\n  if (this._rendered && this._rendered === el) {\n    // Already rendered.\n    return;\n  }\n  this.element = el;\n  var options = this.options;\n  var self = this;\n  var keyMaps = {};\n  for (var key in options.shortcuts) {\n    // null stands for \"do not bind this command\"\n    if (options.shortcuts[key] !== null && bindings[key] !== null) {\n      (function (key) {\n        keyMaps[fixShortcut(options.shortcuts[key])] = function () {\n          var action = bindings[key];\n          if (typeof action === 'function') {\n            action(self);\n          } else if (typeof action === 'string') {\n            window.open(action, '_blank');\n          }\n        };\n      })(key);\n    }\n  }\n  keyMaps['Enter'] = 'newlineAndIndentContinueMarkdownList';\n  keyMaps['Tab'] = 'tabAndIndentMarkdownList';\n  keyMaps['Shift-Tab'] = 'shiftTabAndUnindentMarkdownList';\n  keyMaps['Esc'] = function (cm) {\n    if (cm.getOption('fullScreen')) toggleFullScreen(self);\n  };\n  this.documentOnKeyDown = function (e) {\n    e = e || window.event;\n    if (e.keyCode == 27) {\n      if (self.codemirror.getOption('fullScreen')) toggleFullScreen(self);\n    }\n  };\n  document.addEventListener('keydown', this.documentOnKeyDown, false);\n  var mode, backdrop;\n\n  // CodeMirror overlay mode\n  if (options.overlayMode) {\n    CodeMirror.defineMode('overlay-mode', function (config) {\n      return CodeMirror.overlayMode(CodeMirror.getMode(config, options.spellChecker !== false ? 'spell-checker' : 'gfm'), options.overlayMode.mode, options.overlayMode.combine);\n    });\n    mode = 'overlay-mode';\n    backdrop = options.parsingConfig;\n    backdrop.gitHubSpice = false;\n  } else {\n    mode = options.parsingConfig;\n    mode.name = 'gfm';\n    mode.gitHubSpice = false;\n  }\n  if (options.spellChecker !== false) {\n    mode = 'spell-checker';\n    backdrop = options.parsingConfig;\n    backdrop.name = 'gfm';\n    backdrop.gitHubSpice = false;\n    if (typeof options.spellChecker === 'function') {\n      options.spellChecker({\n        codeMirrorInstance: CodeMirror\n      });\n    } else {\n      CodeMirrorSpellChecker({\n        codeMirrorInstance: CodeMirror\n      });\n    }\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  function configureMouse(cm, repeat, event) {\n    return {\n      addNew: false\n    };\n  }\n  this.codemirror = CodeMirror.fromTextArea(el, {\n    mode: mode,\n    backdrop: backdrop,\n    theme: options.theme != undefined ? options.theme : 'easymde',\n    tabSize: options.tabSize != undefined ? options.tabSize : 2,\n    indentUnit: options.tabSize != undefined ? options.tabSize : 2,\n    indentWithTabs: options.indentWithTabs === false ? false : true,\n    lineNumbers: options.lineNumbers === true ? true : false,\n    autofocus: options.autofocus === true ? true : false,\n    extraKeys: keyMaps,\n    direction: options.direction,\n    lineWrapping: options.lineWrapping === false ? false : true,\n    allowDropFileTypes: ['text/plain'],\n    placeholder: options.placeholder || el.getAttribute('placeholder') || '',\n    styleSelectedText: options.styleSelectedText != undefined ? options.styleSelectedText : !isMobile(),\n    scrollbarStyle: options.scrollbarStyle != undefined ? options.scrollbarStyle : 'native',\n    configureMouse: configureMouse,\n    inputStyle: options.inputStyle != undefined ? options.inputStyle : isMobile() ? 'contenteditable' : 'textarea',\n    spellcheck: options.nativeSpellcheck != undefined ? options.nativeSpellcheck : true,\n    autoRefresh: options.autoRefresh != undefined ? options.autoRefresh : false\n  });\n  this.codemirror.getScrollerElement().style.minHeight = options.minHeight;\n  if (typeof options.maxHeight !== 'undefined') {\n    this.codemirror.getScrollerElement().style.height = options.maxHeight;\n  }\n  if (options.forceSync === true) {\n    var cm = this.codemirror;\n    cm.on('change', function () {\n      cm.save();\n    });\n  }\n  this.gui = {};\n\n  // Wrap Codemirror with container before create toolbar, etc,\n  // to use with sideBySideFullscreen option.\n  var easyMDEContainer = document.createElement('div');\n  easyMDEContainer.classList.add('EasyMDEContainer');\n  easyMDEContainer.setAttribute('role', 'application');\n  var cmWrapper = this.codemirror.getWrapperElement();\n  cmWrapper.parentNode.insertBefore(easyMDEContainer, cmWrapper);\n  easyMDEContainer.appendChild(cmWrapper);\n  if (options.toolbar !== false) {\n    this.gui.toolbar = this.createToolbar();\n  }\n  if (options.status !== false) {\n    this.gui.statusbar = this.createStatusbar();\n  }\n  if (options.autosave != undefined && options.autosave.enabled === true) {\n    this.autosave(); // use to load localstorage content\n    this.codemirror.on('change', function () {\n      clearTimeout(self._autosave_timeout);\n      self._autosave_timeout = setTimeout(function () {\n        self.autosave();\n      }, self.options.autosave.submit_delay || self.options.autosave.delay || 1000);\n    });\n  }\n  function calcHeight(naturalWidth, naturalHeight) {\n    var height;\n    var viewportWidth = window.getComputedStyle(document.querySelector('.CodeMirror-sizer')).width.replace('px', '');\n    if (naturalWidth < viewportWidth) {\n      height = naturalHeight + 'px';\n    } else {\n      height = naturalHeight / naturalWidth * 100 + '%';\n    }\n    return height;\n  }\n  var _vm = this;\n  function assignImageBlockAttributes(parentEl, img) {\n    parentEl.setAttribute('data-img-src', img.url);\n    parentEl.setAttribute('style', '--bg-image:url(' + img.url + ');--width:' + img.naturalWidth + 'px;--height:' + calcHeight(img.naturalWidth, img.naturalHeight));\n    _vm.codemirror.setSize();\n  }\n  function handleImages() {\n    if (!options.previewImagesInEditor) {\n      return;\n    }\n    easyMDEContainer.querySelectorAll('.cm-image-marker').forEach(function (e) {\n      var parentEl = e.parentElement;\n      if (!parentEl.innerText.match(/^!\\[.*?\\]\\(.*\\)/g)) {\n        // if img pasted on the same line with other text, don't preview, preview only images on separate line\n        return;\n      }\n      if (!parentEl.hasAttribute('data-img-src')) {\n        var srcAttr = parentEl.innerText.match('\\\\((.*)\\\\)'); // might require better parsing according to markdown spec\n        if (!window.EMDEimagesCache) {\n          window.EMDEimagesCache = {};\n        }\n        if (srcAttr && srcAttr.length >= 2) {\n          var keySrc = srcAttr[1];\n          if (options.imagesPreviewHandler) {\n            var newSrc = options.imagesPreviewHandler(srcAttr[1]);\n            // defensive check making sure the handler provided by the user returns a string\n            if (typeof newSrc === 'string') {\n              keySrc = newSrc;\n            }\n          }\n          if (!window.EMDEimagesCache[keySrc]) {\n            var img = document.createElement('img');\n            img.onload = function () {\n              window.EMDEimagesCache[keySrc] = {\n                naturalWidth: img.naturalWidth,\n                naturalHeight: img.naturalHeight,\n                url: keySrc\n              };\n              assignImageBlockAttributes(parentEl, window.EMDEimagesCache[keySrc]);\n            };\n            img.src = keySrc;\n          } else {\n            assignImageBlockAttributes(parentEl, window.EMDEimagesCache[keySrc]);\n          }\n        }\n      }\n    });\n  }\n  this.codemirror.on('update', function () {\n    handleImages();\n  });\n  this.gui.sideBySide = this.createSideBySide();\n  this._rendered = this.element;\n  if (options.autofocus === true || el.autofocus) {\n    this.codemirror.focus();\n  }\n\n  // Fixes CodeMirror bug (#344)\n  var temp_cm = this.codemirror;\n  setTimeout(function () {\n    temp_cm.refresh();\n  }.bind(temp_cm), 0);\n};\nEasyMDE.prototype.cleanup = function () {\n  document.removeEventListener('keydown', this.documentOnKeyDown);\n};\n\n// Safari, in Private Browsing Mode, looks like it supports localStorage but all calls to setItem throw QuotaExceededError. We're going to detect this and set a variable accordingly.\nfunction isLocalStorageAvailable() {\n  if (typeof localStorage === 'object') {\n    try {\n      localStorage.setItem('smde_localStorage', 1);\n      localStorage.removeItem('smde_localStorage');\n    } catch (e) {\n      return false;\n    }\n  } else {\n    return false;\n  }\n  return true;\n}\nEasyMDE.prototype.autosave = function () {\n  if (isLocalStorageAvailable()) {\n    var easyMDE = this;\n    if (this.options.autosave.uniqueId == undefined || this.options.autosave.uniqueId == '') {\n      console.log('EasyMDE: You must set a uniqueId to use the autosave feature');\n      return;\n    }\n    if (this.options.autosave.binded !== true) {\n      if (easyMDE.element.form != null && easyMDE.element.form != undefined) {\n        easyMDE.element.form.addEventListener('submit', function () {\n          clearTimeout(easyMDE.autosaveTimeoutId);\n          easyMDE.autosaveTimeoutId = undefined;\n          localStorage.removeItem('smde_' + easyMDE.options.autosave.uniqueId);\n        });\n      }\n      this.options.autosave.binded = true;\n    }\n    if (this.options.autosave.loaded !== true) {\n      if (typeof localStorage.getItem('smde_' + this.options.autosave.uniqueId) == 'string' && localStorage.getItem('smde_' + this.options.autosave.uniqueId) != '') {\n        this.codemirror.setValue(localStorage.getItem('smde_' + this.options.autosave.uniqueId));\n        this.options.autosave.foundSavedValue = true;\n      }\n      this.options.autosave.loaded = true;\n    }\n    var value = easyMDE.value();\n    if (value !== '') {\n      localStorage.setItem('smde_' + this.options.autosave.uniqueId, value);\n    } else {\n      localStorage.removeItem('smde_' + this.options.autosave.uniqueId);\n    }\n    var el = document.getElementById('autosaved');\n    if (el != null && el != undefined && el != '') {\n      var d = new Date();\n      var dd = new Intl.DateTimeFormat([this.options.autosave.timeFormat.locale, 'en-US'], this.options.autosave.timeFormat.format).format(d);\n      var save = this.options.autosave.text == undefined ? 'Autosaved: ' : this.options.autosave.text;\n      el.innerHTML = save + dd;\n    }\n  } else {\n    console.log('EasyMDE: localStorage not available, cannot autosave');\n  }\n};\nEasyMDE.prototype.clearAutosavedValue = function () {\n  if (isLocalStorageAvailable()) {\n    if (this.options.autosave == undefined || this.options.autosave.uniqueId == undefined || this.options.autosave.uniqueId == '') {\n      console.log('EasyMDE: You must set a uniqueId to clear the autosave value');\n      return;\n    }\n    localStorage.removeItem('smde_' + this.options.autosave.uniqueId);\n  } else {\n    console.log('EasyMDE: localStorage not available, cannot autosave');\n  }\n};\n\n/**\n * Open the browse-file window to upload an image to a server.\n * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage\n * @param [onError] {function} see EasyMDE.prototype.uploadImage\n */\nEasyMDE.prototype.openBrowseFileWindow = function (onSuccess, onError) {\n  var self = this;\n  var imageInput = this.gui.toolbar.getElementsByClassName('imageInput')[0];\n  imageInput.click(); //dispatchEvent(new MouseEvent('click'));  // replaced with click() for IE11 compatibility.\n  function onChange(event) {\n    if (self.options.imageUploadFunction) {\n      self.uploadImagesUsingCustomFunction(self.options.imageUploadFunction, event.target.files);\n    } else {\n      self.uploadImages(event.target.files, onSuccess, onError);\n    }\n    imageInput.removeEventListener('change', onChange);\n  }\n  imageInput.addEventListener('change', onChange);\n};\n\n/**\n * Upload an image to the server.\n *\n * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File)\n * @param [onSuccess] {function} A callback function to execute after the image has been successfully uploaded, with one parameter:\n * - url (string): The URL of the uploaded image.\n * @param [onError] {function} A callback function to execute when the image upload fails, with one parameter:\n * - error (string): the detailed error to display to the user (based on messages from options.errorMessages).\n */\nEasyMDE.prototype.uploadImage = function (file, onSuccess, onError) {\n  var self = this;\n  onSuccess = onSuccess || function onSuccess(imageUrl) {\n    afterImageUploaded(self, imageUrl);\n  };\n  function onErrorSup(errorMessage) {\n    // show error on status bar and reset after 10000ms\n    self.updateStatusBar('upload-image', errorMessage);\n    setTimeout(function () {\n      self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n    }, 10000);\n\n    // run custom error handler\n    if (onError && typeof onError === 'function') {\n      onError(errorMessage);\n    }\n    // run error handler from options, this alerts the message.\n    self.options.errorCallback(errorMessage);\n  }\n  function fillErrorMessage(errorMessage) {\n    var units = self.options.imageTexts.sizeUnits.split(',');\n    return errorMessage.replace('#image_name#', file.name).replace('#image_size#', humanFileSize(file.size, units)).replace('#image_max_size#', humanFileSize(self.options.imageMaxSize, units));\n  }\n  if (file.size > this.options.imageMaxSize) {\n    onErrorSup(fillErrorMessage(this.options.errorMessages.fileTooLarge));\n    return;\n  }\n  var formData = new FormData();\n  formData.append('image', file);\n\n  // insert CSRF body token if provided in config.\n  if (self.options.imageCSRFToken && !self.options.imageCSRFHeader) {\n    formData.append(self.options.imageCSRFName, self.options.imageCSRFToken);\n  }\n  var request = new XMLHttpRequest();\n  request.upload.onprogress = function (event) {\n    if (event.lengthComputable) {\n      var progress = '' + Math.round(event.loaded * 100 / event.total);\n      self.updateStatusBar('upload-image', self.options.imageTexts.sbProgress.replace('#file_name#', file.name).replace('#progress#', progress));\n    }\n  };\n  request.open('POST', this.options.imageUploadEndpoint);\n\n  // insert CSRF header token if provided in config.\n  if (self.options.imageCSRFToken && self.options.imageCSRFHeader) {\n    request.setRequestHeader(self.options.imageCSRFName, self.options.imageCSRFToken);\n  }\n  request.onload = function () {\n    try {\n      var response = JSON.parse(this.responseText);\n    } catch (error) {\n      console.error('EasyMDE: The server did not return a valid json.');\n      onErrorSup(fillErrorMessage(self.options.errorMessages.importError));\n      return;\n    }\n    if (this.status === 200 && response && !response.error && response.data && response.data.filePath) {\n      onSuccess((self.options.imagePathAbsolute ? '' : window.location.origin + '/') + response.data.filePath);\n    } else {\n      if (response.error && response.error in self.options.errorMessages) {\n        // preformatted error message\n        onErrorSup(fillErrorMessage(self.options.errorMessages[response.error]));\n      } else if (response.error) {\n        // server side generated error message\n        onErrorSup(fillErrorMessage(response.error));\n      } else {\n        //unknown error\n        console.error('EasyMDE: Received an unexpected response after uploading the image.' + this.status + ' (' + this.statusText + ')');\n        onErrorSup(fillErrorMessage(self.options.errorMessages.importError));\n      }\n    }\n  };\n  request.onerror = function (event) {\n    console.error('EasyMDE: An unexpected error occurred when trying to upload the image.' + event.target.status + ' (' + event.target.statusText + ')');\n    onErrorSup(self.options.errorMessages.importError);\n  };\n  request.send(formData);\n};\n\n/**\n * Upload an image to the server using a custom upload function.\n *\n * @param imageUploadFunction {Function} The custom function to upload the image passed in options\n * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File).\n */\nEasyMDE.prototype.uploadImageUsingCustomFunction = function (imageUploadFunction, file) {\n  var self = this;\n  function onSuccess(imageUrl) {\n    afterImageUploaded(self, imageUrl);\n  }\n  function onError(errorMessage) {\n    var filledErrorMessage = fillErrorMessage(errorMessage);\n    // show error on status bar and reset after 10000ms\n    self.updateStatusBar('upload-image', filledErrorMessage);\n    setTimeout(function () {\n      self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n    }, 10000);\n\n    // run error handler from options, this alerts the message.\n    self.options.errorCallback(filledErrorMessage);\n  }\n  function fillErrorMessage(errorMessage) {\n    var units = self.options.imageTexts.sizeUnits.split(',');\n    return errorMessage.replace('#image_name#', file.name).replace('#image_size#', humanFileSize(file.size, units)).replace('#image_max_size#', humanFileSize(self.options.imageMaxSize, units));\n  }\n  imageUploadFunction.apply(this, [file, onSuccess, onError]);\n};\nEasyMDE.prototype.setPreviewMaxHeight = function () {\n  var cm = this.codemirror;\n  var wrapper = cm.getWrapperElement();\n  var preview = wrapper.nextSibling;\n\n  // Calc preview max height\n  var paddingTop = parseInt(window.getComputedStyle(wrapper).paddingTop);\n  var borderTopWidth = parseInt(window.getComputedStyle(wrapper).borderTopWidth);\n  var optionsMaxHeight = parseInt(this.options.maxHeight);\n  var wrapperMaxHeight = optionsMaxHeight + paddingTop * 2 + borderTopWidth * 2;\n  var previewMaxHeight = wrapperMaxHeight.toString() + 'px';\n  preview.style.height = previewMaxHeight;\n};\nEasyMDE.prototype.createSideBySide = function () {\n  var cm = this.codemirror;\n  var wrapper = cm.getWrapperElement();\n  var preview = wrapper.nextSibling;\n  if (!preview || !preview.classList.contains('editor-preview-side')) {\n    preview = document.createElement('div');\n    preview.className = 'editor-preview-side';\n    if (this.options.previewClass) {\n      if (Array.isArray(this.options.previewClass)) {\n        for (var i = 0; i < this.options.previewClass.length; i++) {\n          preview.classList.add(this.options.previewClass[i]);\n        }\n      } else if (typeof this.options.previewClass === 'string') {\n        preview.classList.add(this.options.previewClass);\n      }\n    }\n    wrapper.parentNode.insertBefore(preview, wrapper.nextSibling);\n  }\n  if (typeof this.options.maxHeight !== 'undefined') {\n    this.setPreviewMaxHeight();\n  }\n  if (this.options.syncSideBySidePreviewScroll === false) return preview;\n  // Syncs scroll  editor -> preview\n  var cScroll = false;\n  var pScroll = false;\n  cm.on('scroll', function (v) {\n    if (cScroll) {\n      cScroll = false;\n      return;\n    }\n    pScroll = true;\n    var height = v.getScrollInfo().height - v.getScrollInfo().clientHeight;\n    var ratio = parseFloat(v.getScrollInfo().top) / height;\n    var move = (preview.scrollHeight - preview.clientHeight) * ratio;\n    preview.scrollTop = move;\n  });\n\n  // Syncs scroll  preview -> editor\n  preview.onscroll = function () {\n    if (pScroll) {\n      pScroll = false;\n      return;\n    }\n    cScroll = true;\n    var height = preview.scrollHeight - preview.clientHeight;\n    var ratio = parseFloat(preview.scrollTop) / height;\n    var move = (cm.getScrollInfo().height - cm.getScrollInfo().clientHeight) * ratio;\n    cm.scrollTo(0, move);\n  };\n  return preview;\n};\nEasyMDE.prototype.createToolbar = function (items) {\n  items = items || this.options.toolbar;\n  if (!items || items.length === 0) {\n    return;\n  }\n  var i;\n  for (i = 0; i < items.length; i++) {\n    if (toolbarBuiltInButtons[items[i]] != undefined) {\n      items[i] = toolbarBuiltInButtons[items[i]];\n    }\n  }\n  var bar = document.createElement('div');\n  bar.className = 'editor-toolbar';\n  bar.setAttribute('role', 'toolbar');\n  var self = this;\n  var toolbarData = {};\n  self.toolbar = items;\n  for (i = 0; i < items.length; i++) {\n    if (items[i].name == 'guide' && self.options.toolbarGuideIcon === false) continue;\n    if (self.options.hideIcons && self.options.hideIcons.indexOf(items[i].name) != -1) continue;\n\n    // Fullscreen does not work well on mobile devices (even tablets)\n    // In the future, hopefully this can be resolved\n    if ((items[i].name == 'fullscreen' || items[i].name == 'side-by-side') && isMobile()) continue;\n\n    // Don't include trailing separators\n    if (items[i] === '|') {\n      var nonSeparatorIconsFollow = false;\n      for (var x = i + 1; x < items.length; x++) {\n        if (items[x] !== '|' && (!self.options.hideIcons || self.options.hideIcons.indexOf(items[x].name) == -1)) {\n          nonSeparatorIconsFollow = true;\n        }\n      }\n      if (!nonSeparatorIconsFollow) continue;\n    }\n\n    // Create the icon and append to the toolbar\n    (function (item) {\n      var el;\n      if (item === '|') {\n        el = createSep();\n      } else if (item.children) {\n        el = createToolbarDropdown(item, self.options.toolbarTips, self.options.shortcuts, self);\n      } else {\n        el = createToolbarButton(item, true, self.options.toolbarTips, self.options.shortcuts, 'button', self);\n      }\n      toolbarData[item.name || item] = el;\n      bar.appendChild(el);\n\n      // Create the input element (ie. <input type='file'>), used among\n      // with the 'import-image' icon to open the browse-file window.\n      if (item.name === 'upload-image') {\n        var imageInput = document.createElement('input');\n        imageInput.className = 'imageInput';\n        imageInput.type = 'file';\n        imageInput.multiple = true;\n        imageInput.name = 'image';\n        imageInput.accept = self.options.imageAccept;\n        imageInput.style.display = 'none';\n        imageInput.style.opacity = 0;\n        bar.appendChild(imageInput);\n      }\n    })(items[i]);\n  }\n  self.toolbar_div = bar;\n  self.toolbarElements = toolbarData;\n  var cm = this.codemirror;\n  cm.on('cursorActivity', function () {\n    var stat = getState(cm);\n    for (var key in toolbarData) {\n      (function (key) {\n        var el = toolbarData[key];\n        if (stat[key]) {\n          el.classList.add('active');\n        } else if (key != 'fullscreen' && key != 'side-by-side') {\n          el.classList.remove('active');\n        }\n      })(key);\n    }\n  });\n  var cmWrapper = cm.getWrapperElement();\n  cmWrapper.parentNode.insertBefore(bar, cmWrapper);\n  return bar;\n};\nEasyMDE.prototype.createStatusbar = function (status) {\n  // Initialize\n  status = status || this.options.status;\n  var options = this.options;\n  var cm = this.codemirror;\n\n  // Make sure the status variable is valid\n  if (!status || status.length === 0) {\n    return;\n  }\n\n  // Set up the built-in items\n  var items = [];\n  var i, onUpdate, onActivity, defaultValue;\n  for (i = 0; i < status.length; i++) {\n    // Reset some values\n    onUpdate = undefined;\n    onActivity = undefined;\n    defaultValue = undefined;\n\n    // Handle if custom or not\n    if (typeof status[i] === 'object') {\n      items.push({\n        className: status[i].className,\n        defaultValue: status[i].defaultValue,\n        onUpdate: status[i].onUpdate,\n        onActivity: status[i].onActivity\n      });\n    } else {\n      var name = status[i];\n      if (name === 'words') {\n        defaultValue = function (el) {\n          el.innerHTML = wordCount(cm.getValue());\n        };\n        onUpdate = function (el) {\n          el.innerHTML = wordCount(cm.getValue());\n        };\n      } else if (name === 'lines') {\n        defaultValue = function (el) {\n          el.innerHTML = cm.lineCount();\n        };\n        onUpdate = function (el) {\n          el.innerHTML = cm.lineCount();\n        };\n      } else if (name === 'cursor') {\n        defaultValue = function (el) {\n          el.innerHTML = '1:1';\n        };\n        onActivity = function (el) {\n          var pos = cm.getCursor();\n          var posLine = pos.line + 1;\n          var posColumn = pos.ch + 1;\n          el.innerHTML = posLine + ':' + posColumn;\n        };\n      } else if (name === 'autosave') {\n        defaultValue = function (el) {\n          if (options.autosave != undefined && options.autosave.enabled === true) {\n            el.setAttribute('id', 'autosaved');\n          }\n        };\n      } else if (name === 'upload-image') {\n        defaultValue = function (el) {\n          el.innerHTML = options.imageTexts.sbInit;\n        };\n      }\n      items.push({\n        className: name,\n        defaultValue: defaultValue,\n        onUpdate: onUpdate,\n        onActivity: onActivity\n      });\n    }\n  }\n\n  // Create element for the status bar\n  var bar = document.createElement('div');\n  bar.className = 'editor-statusbar';\n\n  // Create a new span for each item\n  for (i = 0; i < items.length; i++) {\n    // Store in temporary variable\n    var item = items[i];\n\n    // Create span element\n    var el = document.createElement('span');\n    el.className = item.className;\n\n    // Ensure the defaultValue is a function\n    if (typeof item.defaultValue === 'function') {\n      item.defaultValue(el);\n    }\n\n    // Ensure the onUpdate is a function\n    if (typeof item.onUpdate === 'function') {\n      // Create a closure around the span of the current action, then execute the onUpdate handler\n      this.codemirror.on('update', function (el, item) {\n        return function () {\n          item.onUpdate(el);\n        };\n      }(el, item));\n    }\n    if (typeof item.onActivity === 'function') {\n      // Create a closure around the span of the current action, then execute the onActivity handler\n      this.codemirror.on('cursorActivity', function (el, item) {\n        return function () {\n          item.onActivity(el);\n        };\n      }(el, item));\n    }\n\n    // Append the item to the status bar\n    bar.appendChild(el);\n  }\n\n  // Insert the status bar into the DOM\n  var cmWrapper = this.codemirror.getWrapperElement();\n  cmWrapper.parentNode.insertBefore(bar, cmWrapper.nextSibling);\n  return bar;\n};\n\n/**\n * Get or set the text content.\n */\nEasyMDE.prototype.value = function (val) {\n  var cm = this.codemirror;\n  if (val === undefined) {\n    return cm.getValue();\n  } else {\n    cm.getDoc().setValue(val);\n    if (this.isPreviewActive()) {\n      var wrapper = cm.getWrapperElement();\n      var preview = wrapper.lastChild;\n      var preview_result = this.options.previewRender(val, preview);\n      if (preview_result !== null) {\n        preview.innerHTML = preview_result;\n      }\n    }\n    return this;\n  }\n};\n\n/**\n * Bind static methods for exports.\n */\nEasyMDE.toggleBold = toggleBold;\nEasyMDE.toggleItalic = toggleItalic;\nEasyMDE.toggleStrikethrough = toggleStrikethrough;\nEasyMDE.toggleBlockquote = toggleBlockquote;\nEasyMDE.toggleHeadingSmaller = toggleHeadingSmaller;\nEasyMDE.toggleHeadingBigger = toggleHeadingBigger;\nEasyMDE.toggleHeading1 = toggleHeading1;\nEasyMDE.toggleHeading2 = toggleHeading2;\nEasyMDE.toggleHeading3 = toggleHeading3;\nEasyMDE.toggleHeading4 = toggleHeading4;\nEasyMDE.toggleHeading5 = toggleHeading5;\nEasyMDE.toggleHeading6 = toggleHeading6;\nEasyMDE.toggleCodeBlock = toggleCodeBlock;\nEasyMDE.toggleUnorderedList = toggleUnorderedList;\nEasyMDE.toggleOrderedList = toggleOrderedList;\nEasyMDE.cleanBlock = cleanBlock;\nEasyMDE.drawLink = drawLink;\nEasyMDE.drawImage = drawImage;\nEasyMDE.drawUploadedImage = drawUploadedImage;\nEasyMDE.drawTable = drawTable;\nEasyMDE.drawHorizontalRule = drawHorizontalRule;\nEasyMDE.undo = undo;\nEasyMDE.redo = redo;\nEasyMDE.togglePreview = togglePreview;\nEasyMDE.toggleSideBySide = toggleSideBySide;\nEasyMDE.toggleFullScreen = toggleFullScreen;\n\n/**\n * Bind instance methods for exports.\n */\nEasyMDE.prototype.toggleBold = function () {\n  toggleBold(this);\n};\nEasyMDE.prototype.toggleItalic = function () {\n  toggleItalic(this);\n};\nEasyMDE.prototype.toggleStrikethrough = function () {\n  toggleStrikethrough(this);\n};\nEasyMDE.prototype.toggleBlockquote = function () {\n  toggleBlockquote(this);\n};\nEasyMDE.prototype.toggleHeadingSmaller = function () {\n  toggleHeadingSmaller(this);\n};\nEasyMDE.prototype.toggleHeadingBigger = function () {\n  toggleHeadingBigger(this);\n};\nEasyMDE.prototype.toggleHeading1 = function () {\n  toggleHeading1(this);\n};\nEasyMDE.prototype.toggleHeading2 = function () {\n  toggleHeading2(this);\n};\nEasyMDE.prototype.toggleHeading3 = function () {\n  toggleHeading3(this);\n};\nEasyMDE.prototype.toggleHeading4 = function () {\n  toggleHeading4(this);\n};\nEasyMDE.prototype.toggleHeading5 = function () {\n  toggleHeading5(this);\n};\nEasyMDE.prototype.toggleHeading6 = function () {\n  toggleHeading6(this);\n};\nEasyMDE.prototype.toggleCodeBlock = function () {\n  toggleCodeBlock(this);\n};\nEasyMDE.prototype.toggleUnorderedList = function () {\n  toggleUnorderedList(this);\n};\nEasyMDE.prototype.toggleOrderedList = function () {\n  toggleOrderedList(this);\n};\nEasyMDE.prototype.cleanBlock = function () {\n  cleanBlock(this);\n};\nEasyMDE.prototype.drawLink = function () {\n  drawLink(this);\n};\nEasyMDE.prototype.drawImage = function () {\n  drawImage(this);\n};\nEasyMDE.prototype.drawUploadedImage = function () {\n  drawUploadedImage(this);\n};\nEasyMDE.prototype.drawTable = function () {\n  drawTable(this);\n};\nEasyMDE.prototype.drawHorizontalRule = function () {\n  drawHorizontalRule(this);\n};\nEasyMDE.prototype.undo = function () {\n  undo(this);\n};\nEasyMDE.prototype.redo = function () {\n  redo(this);\n};\nEasyMDE.prototype.togglePreview = function () {\n  togglePreview(this);\n};\nEasyMDE.prototype.toggleSideBySide = function () {\n  toggleSideBySide(this);\n};\nEasyMDE.prototype.toggleFullScreen = function () {\n  toggleFullScreen(this);\n};\nEasyMDE.prototype.isPreviewActive = function () {\n  var cm = this.codemirror;\n  var wrapper = cm.getWrapperElement();\n  var preview = wrapper.lastChild;\n  return preview.classList.contains('editor-preview-active');\n};\nEasyMDE.prototype.isSideBySideActive = function () {\n  var cm = this.codemirror;\n  var wrapper = cm.getWrapperElement();\n  var preview = wrapper.nextSibling;\n  return preview.classList.contains('editor-preview-active-side');\n};\nEasyMDE.prototype.isFullscreenActive = function () {\n  var cm = this.codemirror;\n  return cm.getOption('fullScreen');\n};\nEasyMDE.prototype.getState = function () {\n  var cm = this.codemirror;\n  return getState(cm);\n};\nEasyMDE.prototype.toTextArea = function () {\n  var cm = this.codemirror;\n  var wrapper = cm.getWrapperElement();\n  var easyMDEContainer = wrapper.parentNode;\n  if (easyMDEContainer) {\n    if (this.gui.toolbar) {\n      easyMDEContainer.removeChild(this.gui.toolbar);\n    }\n    if (this.gui.statusbar) {\n      easyMDEContainer.removeChild(this.gui.statusbar);\n    }\n    if (this.gui.sideBySide) {\n      easyMDEContainer.removeChild(this.gui.sideBySide);\n    }\n  }\n\n  // Unwrap easyMDEcontainer before codemirror toTextArea() call\n  easyMDEContainer.parentNode.insertBefore(wrapper, easyMDEContainer);\n  easyMDEContainer.remove();\n  cm.toTextArea();\n  if (this.autosaveTimeoutId) {\n    clearTimeout(this.autosaveTimeoutId);\n    this.autosaveTimeoutId = undefined;\n    this.clearAutosavedValue();\n  }\n};\nmodule.exports = EasyMDE;","map":{"version":3,"names":["CodeMirror","require","CodeMirrorSpellChecker","marked","isMac","test","navigator","platform","anchorToExternalRegex","RegExp","bindings","toggleBold","toggleItalic","drawLink","toggleHeadingSmaller","toggleHeadingBigger","drawImage","toggleBlockquote","toggleOrderedList","toggleUnorderedList","toggleCodeBlock","togglePreview","toggleStrikethrough","toggleHeading1","toggleHeading2","toggleHeading3","toggleHeading4","toggleHeading5","toggleHeading6","cleanBlock","drawTable","drawHorizontalRule","undo","redo","toggleSideBySide","toggleFullScreen","shortcuts","getBindingName","f","key","isMobile","check","a","substr","userAgent","vendor","window","opera","addAnchorTargetBlank","htmlText","match","exec","linkString","indexOf","fixedLinkString","replace","removeListStyleWhenCheckbox","parser","DOMParser","htmlDoc","parseFromString","listItems","getElementsByTagName","i","length","listItem","j","children","listItemChild","HTMLInputElement","type","style","marginLeft","listStyleType","documentElement","innerHTML","fixShortcut","name","createToolbarDropdown","options","enableTooltips","parent","el","createToolbarButton","classList","add","onclick","focus","content","document","createElement","className","childrenIndex","child","childElement","toolbarBuiltInButtons","addEventListener","e","stopPropagation","appendChild","enableActions","markup","attributes","attribute","Object","prototype","hasOwnProperty","call","setAttribute","classNamePrefix","toolbarButtonClassPrefix","undefined","text","innerText","action","title","createTooltip","noDisable","noMobile","classNameParts","split","iconClasses","classNameIndex","classNamePart","push","tabIndex","icon","iconClassIndex","iconClass","preventDefault","open","createSep","actionName","tooltip","getState","cm","pos","getCursor","stat","getTokenAt","types","ret","data","bold","getLine","line","quote","italic","strikethrough","code","image","link","saved_overflow","editor","codemirror","setOption","getOption","body","overflow","wrapper","getWrapperElement","sidebyside","nextSibling","contains","sideBySideFullscreen","easyMDEContainer","parentNode","remove","onToggleFullScreen","maxHeight","getScrollerElement","removeProperty","height","setPreviewMaxHeight","toolbar_div","toggle","toolbarElements","fullscreen","toolbarButton","_toggleBlock","blockStyles","fenceCharsToInsert","fencing_line","styles","token_state","token","state","base","code_type","line_num","firstTok","lastTok","getLineHandle","ch","indentedCode","fencedChars","insertFencingAtSelection","cur_start","cur_end","start_line_sel","end_line_sel","sel_multi","repl_start","repl_end","_replaceSelection","setSelection","tok","is_code","block_start","block_end","lineCount","start","slice","end","replaceRange","fencedTok","fence_chars","start_text","start_line","end_text","end_line","operation","search_from","next_line","next_line_last_tok","next_line_indented","indentLine","no_sel_and_starting_of_line","_toggleLine","_toggleHeading","listStyle","includes","unorderedListStyle","_cleanBlock","url","promptURLs","result","prompt","promptTexts","escapePromptURL","_toggleLink","insertTexts","encodeURI","drawUploadedImage","openBrowseFileWindow","afterImageUploaded","imageName","lastIndexOf","ext","substring","toLowerCase","uploadedImage","text_link","updateStatusBar","imageTexts","sbOnUploaded","setTimeout","sbInit","table","horizontalRule","preview","useSideBySideListener","previewNormal","lastChild","toolbar","sideBySideRenderingFunction","newValue","previewRender","value","on","off","refresh","previewClass","Array","isArray","preview_result","active","startEnd","startPoint","endPoint","assign","getSelection","replaceSelection","direction","size","currHeadingLevel","search","repeat","liststyle","listRegexp","whitespacesRegexp","repl","_getChar","map","_checkChar","char","rt","_toggle","untoggleOnly","arr","isPreviewActive","start_chars","end_chars","join","humanFileSize","bytes","units","Math","abs","u","toFixed","_mergeProperties","target","source","property","concat","constructor","extend","arguments","wordCount","pattern","m","count","charCodeAt","iconClassMap","default","timeFormat","locale","format","hour","minute","sbOnDragEnter","sbOnDrop","sbProgress","sizeUnits","errorMessages","noFileGiven","typeNotAllowed","fileTooLarge","importError","EasyMDE","autoDownloadFA","autoDownloadFontAwesome","styleSheets","href","rel","element","console","log","showIcons","status","uploadImage","unshift","plainText","markdown","parsingConfig","highlightFormatting","autosave","minHeight","errorCallback","errorMessage","alert","imageMaxSize","imageAccept","imagePathAbsolute","imageCSRFName","imageCSRFHeader","unique_id","uniqueId","overlayMode","combine","render","initialValue","foundSavedValue","self","event","imageUploadFunction","uploadImagesUsingCustomFunction","dataTransfer","files","uploadImages","clipboardData","onSuccess","onError","names","uploadImageUsingCustomFunction","itemName","gui","statusbar","matchingClasses","getElementsByClassName","textContent","markedOptions","renderingConfig","singleLineBreaks","breaks","codeSyntaxHighlighting","hljs","highlight","language","getLanguage","highlightAuto","setOptions","parse","sanitizerFunction","_rendered","keyMaps","documentOnKeyDown","keyCode","mode","backdrop","defineMode","config","getMode","spellChecker","gitHubSpice","codeMirrorInstance","configureMouse","addNew","fromTextArea","theme","tabSize","indentUnit","indentWithTabs","lineNumbers","autofocus","extraKeys","lineWrapping","allowDropFileTypes","placeholder","getAttribute","styleSelectedText","scrollbarStyle","inputStyle","spellcheck","nativeSpellcheck","autoRefresh","forceSync","save","cmWrapper","insertBefore","createToolbar","createStatusbar","enabled","clearTimeout","_autosave_timeout","submit_delay","delay","calcHeight","naturalWidth","naturalHeight","viewportWidth","getComputedStyle","querySelector","width","_vm","assignImageBlockAttributes","parentEl","img","setSize","handleImages","previewImagesInEditor","querySelectorAll","forEach","parentElement","hasAttribute","srcAttr","EMDEimagesCache","keySrc","imagesPreviewHandler","newSrc","onload","src","sideBySide","createSideBySide","temp_cm","bind","cleanup","removeEventListener","isLocalStorageAvailable","localStorage","setItem","removeItem","easyMDE","binded","form","autosaveTimeoutId","loaded","getItem","setValue","getElementById","d","Date","dd","Intl","DateTimeFormat","clearAutosavedValue","imageInput","click","onChange","file","imageUrl","onErrorSup","fillErrorMessage","formData","FormData","append","imageCSRFToken","request","XMLHttpRequest","upload","onprogress","lengthComputable","progress","round","total","imageUploadEndpoint","setRequestHeader","response","JSON","responseText","error","filePath","location","origin","statusText","onerror","send","filledErrorMessage","apply","paddingTop","parseInt","borderTopWidth","optionsMaxHeight","wrapperMaxHeight","previewMaxHeight","toString","syncSideBySidePreviewScroll","cScroll","pScroll","v","getScrollInfo","clientHeight","ratio","parseFloat","top","move","scrollHeight","scrollTop","onscroll","scrollTo","items","bar","toolbarData","toolbarGuideIcon","hideIcons","nonSeparatorIconsFollow","x","item","toolbarTips","multiple","accept","display","opacity","onUpdate","onActivity","defaultValue","getValue","posLine","posColumn","val","getDoc","isSideBySideActive","isFullscreenActive","toTextArea","removeChild","module","exports"],"sources":["/Users/wangbaiyuan/Documents/Wehelp/Part3/Vcard/client/node_modules/easymde/src/js/easymde.js"],"sourcesContent":["'use strict';\nvar CodeMirror = require('codemirror');\nrequire('codemirror/addon/edit/continuelist.js');\nrequire('./codemirror/tablist');\nrequire('codemirror/addon/display/fullscreen.js');\nrequire('codemirror/mode/markdown/markdown.js');\nrequire('codemirror/addon/mode/overlay.js');\nrequire('codemirror/addon/display/placeholder.js');\nrequire('codemirror/addon/display/autorefresh.js');\nrequire('codemirror/addon/selection/mark-selection.js');\nrequire('codemirror/addon/search/searchcursor.js');\nrequire('codemirror/mode/gfm/gfm.js');\nrequire('codemirror/mode/xml/xml.js');\nvar CodeMirrorSpellChecker = require('codemirror-spell-checker');\nvar marked = require('marked').marked;\n\n\n// Some variables\nvar isMac = /Mac/.test(navigator.platform);\nvar anchorToExternalRegex = new RegExp(/(<a.*?https?:\\/\\/.*?[^a]>)+?/g);\n\n// Mapping of actions that can be bound to keyboard shortcuts or toolbar buttons\nvar bindings = {\n    'toggleBold': toggleBold,\n    'toggleItalic': toggleItalic,\n    'drawLink': drawLink,\n    'toggleHeadingSmaller': toggleHeadingSmaller,\n    'toggleHeadingBigger': toggleHeadingBigger,\n    'drawImage': drawImage,\n    'toggleBlockquote': toggleBlockquote,\n    'toggleOrderedList': toggleOrderedList,\n    'toggleUnorderedList': toggleUnorderedList,\n    'toggleCodeBlock': toggleCodeBlock,\n    'togglePreview': togglePreview,\n    'toggleStrikethrough': toggleStrikethrough,\n    'toggleHeading1': toggleHeading1,\n    'toggleHeading2': toggleHeading2,\n    'toggleHeading3': toggleHeading3,\n    'toggleHeading4': toggleHeading4,\n    'toggleHeading5': toggleHeading5,\n    'toggleHeading6': toggleHeading6,\n    'cleanBlock': cleanBlock,\n    'drawTable': drawTable,\n    'drawHorizontalRule': drawHorizontalRule,\n    'undo': undo,\n    'redo': redo,\n    'toggleSideBySide': toggleSideBySide,\n    'toggleFullScreen': toggleFullScreen,\n};\n\nvar shortcuts = {\n    'toggleBold': 'Cmd-B',\n    'toggleItalic': 'Cmd-I',\n    'drawLink': 'Cmd-K',\n    'toggleHeadingSmaller': 'Cmd-H',\n    'toggleHeadingBigger': 'Shift-Cmd-H',\n    'toggleHeading1': 'Ctrl+Alt+1',\n    'toggleHeading2': 'Ctrl+Alt+2',\n    'toggleHeading3': 'Ctrl+Alt+3',\n    'toggleHeading4': 'Ctrl+Alt+4',\n    'toggleHeading5': 'Ctrl+Alt+5',\n    'toggleHeading6': 'Ctrl+Alt+6',\n    'cleanBlock': 'Cmd-E',\n    'drawImage': 'Cmd-Alt-I',\n    'toggleBlockquote': 'Cmd-\\'',\n    'toggleOrderedList': 'Cmd-Alt-L',\n    'toggleUnorderedList': 'Cmd-L',\n    'toggleCodeBlock': 'Cmd-Alt-C',\n    'togglePreview': 'Cmd-P',\n    'toggleSideBySide': 'F9',\n    'toggleFullScreen': 'F11',\n};\n\nvar getBindingName = function (f) {\n    for (var key in bindings) {\n        if (bindings[key] === f) {\n            return key;\n        }\n    }\n    return null;\n};\n\nvar isMobile = function () {\n    var check = false;\n    (function (a) {\n        if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0, 4))) check = true;\n    })(navigator.userAgent || navigator.vendor || window.opera);\n    return check;\n};\n\n/**\n * Modify HTML to add 'target=\"_blank\"' to links so they open in new tabs by default.\n * @param {string} htmlText - HTML to be modified.\n * @return {string} The modified HTML text.\n */\nfunction addAnchorTargetBlank(htmlText) {\n    var match;\n    while ((match = anchorToExternalRegex.exec(htmlText)) !== null) {\n        // With only one capture group in the RegExp, we can safely take the first index from the match.\n        var linkString = match[0];\n\n        if (linkString.indexOf('target=') === -1) {\n            var fixedLinkString = linkString.replace(/>$/, ' target=\"_blank\">');\n            htmlText = htmlText.replace(linkString, fixedLinkString);\n        }\n    }\n    return htmlText;\n}\n\n/**\n * Modify HTML to remove the list-style when rendering checkboxes.\n * @param {string} htmlText - HTML to be modified.\n * @return {string} The modified HTML text.\n */\nfunction removeListStyleWhenCheckbox(htmlText) {\n\n    var parser = new DOMParser();\n    var htmlDoc = parser.parseFromString(htmlText, 'text/html');\n    var listItems = htmlDoc.getElementsByTagName('li');\n\n    for (var i = 0; i < listItems.length; i++) {\n        var listItem = listItems[i];\n\n        for (var j = 0; j < listItem.children.length; j++) {\n            var listItemChild = listItem.children[j];\n\n            if (listItemChild instanceof HTMLInputElement && listItemChild.type === 'checkbox') {\n                // From Github: margin: 0 .2em .25em -1.6em;\n                listItem.style.marginLeft = '-1.5em';\n                listItem.style.listStyleType = 'none';\n            }\n        }\n    }\n\n    return htmlDoc.documentElement.innerHTML;\n}\n\n/**\n * Fix shortcut. Mac use Command, others use Ctrl.\n */\nfunction fixShortcut(name) {\n    if (isMac) {\n        name = name.replace('Ctrl', 'Cmd');\n    } else {\n        name = name.replace('Cmd', 'Ctrl');\n    }\n    return name;\n}\n\n/**\n * Create dropdown block\n */\nfunction createToolbarDropdown(options, enableTooltips, shortcuts, parent) {\n    var el = createToolbarButton(options, false, enableTooltips, shortcuts, 'button', parent);\n    el.classList.add('easymde-dropdown');\n\n    el.onclick = function () {\n        el.focus();\n    };\n\n    var content = document.createElement('div');\n    content.className = 'easymde-dropdown-content';\n    for (var childrenIndex = 0; childrenIndex < options.children.length; childrenIndex++) {\n\n        var child = options.children[childrenIndex];\n        var childElement;\n\n        if (typeof child === 'string' && child in toolbarBuiltInButtons) {\n            childElement = createToolbarButton(toolbarBuiltInButtons[child], true, enableTooltips, shortcuts, 'button', parent);\n        } else {\n            childElement = createToolbarButton(child, true, enableTooltips, shortcuts, 'button', parent);\n        }\n\n        childElement.addEventListener('click', function (e) { e.stopPropagation(); }, false);\n        content.appendChild(childElement);\n    }\n    el.appendChild(content);\n    return el;\n}\n\n/**\n * Create button element for toolbar.\n */\nfunction createToolbarButton(options, enableActions, enableTooltips, shortcuts, markup, parent) {\n    options = options || {};\n    var el = document.createElement(markup);\n\n    // Add 'custom' attributes as early as possible, so that 'official' attributes will never be overwritten.\n    if (options.attributes) {\n        for (var attribute in options.attributes) {\n            if (Object.prototype.hasOwnProperty.call(options.attributes, attribute)) {\n                el.setAttribute(attribute, options.attributes[attribute]);\n            }\n        }\n    }\n\n    var classNamePrefix = parent.options.toolbarButtonClassPrefix ? parent.options.toolbarButtonClassPrefix + '-' : '';\n    el.className = classNamePrefix + options.name;\n    el.setAttribute('type', markup);\n    enableTooltips = (enableTooltips == undefined) ? true : enableTooltips;\n\n    if (options.text) {\n        el.innerText = options.text;\n    }\n\n    // Properly handle custom shortcuts\n    if (options.name && options.name in shortcuts) {\n        bindings[options.name] = options.action;\n    }\n\n    if (options.title && enableTooltips) {\n        el.title = createTooltip(options.title, options.action, shortcuts);\n\n        if (isMac) {\n            el.title = el.title.replace('Ctrl', '⌘');\n            el.title = el.title.replace('Alt', '⌥');\n        }\n    }\n\n    if (options.title) {\n        el.setAttribute('aria-label', options.title);\n    }\n\n    if (options.noDisable) {\n        el.classList.add('no-disable');\n    }\n\n    if (options.noMobile) {\n        el.classList.add('no-mobile');\n    }\n\n    // Prevent errors if there is no class name in custom options\n    var classNameParts = [];\n    if (typeof options.className !== 'undefined') {\n        classNameParts = options.className.split(' ');\n    }\n\n    // Provide backwards compatibility with simple-markdown-editor by adding custom classes to the button.\n    var iconClasses = [];\n    for (var classNameIndex = 0; classNameIndex < classNameParts.length; classNameIndex++) {\n        var classNamePart = classNameParts[classNameIndex];\n        // Split icon classes from the button.\n        // Regex will detect \"fa\", \"fas\", \"fa-something\" and \"fa-some-icon-1\", but not \"fanfare\".\n        if (classNamePart.match(/^fa([srlb]|(-[\\w-]*)|$)/)) {\n            iconClasses.push(classNamePart);\n        } else {\n            el.classList.add(classNamePart);\n        }\n    }\n\n    el.tabIndex = -1;\n\n    if (iconClasses.length > 0) {\n        // Create icon element and append as a child to the button\n        var icon = document.createElement('i');\n        for (var iconClassIndex = 0; iconClassIndex < iconClasses.length; iconClassIndex++) {\n            var iconClass = iconClasses[iconClassIndex];\n            icon.classList.add(iconClass);\n        }\n        el.appendChild(icon);\n    }\n\n    // If there is a custom icon markup set, use that\n    if (typeof options.icon !== 'undefined') {\n        el.innerHTML = options.icon;\n    }\n\n    if (options.action && enableActions) {\n        if (typeof options.action === 'function') {\n            el.onclick = function (e) {\n                e.preventDefault();\n                options.action(parent);\n            };\n        } else if (typeof options.action === 'string') {\n            el.onclick = function (e) {\n                e.preventDefault();\n                window.open(options.action, '_blank');\n            };\n        }\n    }\n\n    return el;\n}\n\nfunction createSep() {\n    var el = document.createElement('i');\n    el.className = 'separator';\n    el.innerHTML = '|';\n    return el;\n}\n\nfunction createTooltip(title, action, shortcuts) {\n    var actionName;\n    var tooltip = title;\n\n    if (action) {\n        actionName = getBindingName(action);\n        if (shortcuts[actionName]) {\n            tooltip += ' (' + fixShortcut(shortcuts[actionName]) + ')';\n        }\n    }\n\n    return tooltip;\n}\n\n/**\n * The state of CodeMirror at the given position.\n */\nfunction getState(cm, pos) {\n    pos = pos || cm.getCursor('start');\n    var stat = cm.getTokenAt(pos);\n    if (!stat.type) return {};\n\n    var types = stat.type.split(' ');\n\n    var ret = {},\n        data, text;\n    for (var i = 0; i < types.length; i++) {\n        data = types[i];\n        if (data === 'strong') {\n            ret.bold = true;\n        } else if (data === 'variable-2') {\n            text = cm.getLine(pos.line);\n            if (/^\\s*\\d+\\.\\s/.test(text)) {\n                ret['ordered-list'] = true;\n            } else {\n                ret['unordered-list'] = true;\n            }\n        } else if (data === 'atom') {\n            ret.quote = true;\n        } else if (data === 'em') {\n            ret.italic = true;\n        } else if (data === 'quote') {\n            ret.quote = true;\n        } else if (data === 'strikethrough') {\n            ret.strikethrough = true;\n        } else if (data === 'comment') {\n            ret.code = true;\n        } else if (data === 'link' && !ret.image) {\n            ret.link = true;\n        } else if (data === 'image') {\n            ret.image = true;\n        } else if (data.match(/^header(-[1-6])?$/)) {\n            ret[data.replace('header', 'heading')] = true;\n        }\n    }\n    return ret;\n}\n\n\n// Saved overflow setting\nvar saved_overflow = '';\n\n/**\n * Toggle full screen of the editor.\n * @param {EasyMDE} editor\n */\nfunction toggleFullScreen(editor) {\n    // Set fullscreen\n    var cm = editor.codemirror;\n    cm.setOption('fullScreen', !cm.getOption('fullScreen'));\n\n\n    // Prevent scrolling on body during fullscreen active\n    if (cm.getOption('fullScreen')) {\n        saved_overflow = document.body.style.overflow;\n        document.body.style.overflow = 'hidden';\n    } else {\n        document.body.style.overflow = saved_overflow;\n    }\n\n    var wrapper = cm.getWrapperElement();\n    var sidebyside = wrapper.nextSibling;\n\n    if (sidebyside.classList.contains('editor-preview-active-side')) {\n        if (editor.options.sideBySideFullscreen === false) {\n            // if side-by-side not-fullscreen ok, apply classes as needed\n            var easyMDEContainer = wrapper.parentNode;\n            if (cm.getOption('fullScreen')) {\n                easyMDEContainer.classList.remove('sided--no-fullscreen');\n            } else {\n                easyMDEContainer.classList.add('sided--no-fullscreen');\n            }\n        } else {\n            toggleSideBySide(editor);\n        }\n    }\n\n    if (editor.options.onToggleFullScreen) {\n        editor.options.onToggleFullScreen(cm.getOption('fullScreen') || false);\n    }\n\n    // Remove or set maxHeight\n    if (typeof editor.options.maxHeight !== 'undefined') {\n        if (cm.getOption('fullScreen')) {\n            cm.getScrollerElement().style.removeProperty('height');\n            sidebyside.style.removeProperty('height');\n        } else {\n            cm.getScrollerElement().style.height = editor.options.maxHeight;\n            editor.setPreviewMaxHeight();\n        }\n    }\n\n    // Update toolbar class\n    editor.toolbar_div.classList.toggle('fullscreen');\n\n    // Update toolbar button\n    if (editor.toolbarElements && editor.toolbarElements.fullscreen) {\n        var toolbarButton = editor.toolbarElements.fullscreen;\n        toolbarButton.classList.toggle('active');\n    }\n}\n\n\n/**\n * Action for toggling bold.\n * @param {EasyMDE} editor\n */\nfunction toggleBold(editor) {\n    _toggleBlock(editor, 'bold', editor.options.blockStyles.bold);\n}\n\n\n/**\n * Action for toggling italic.\n * @param {EasyMDE} editor\n */\nfunction toggleItalic(editor) {\n    _toggleBlock(editor, 'italic', editor.options.blockStyles.italic);\n}\n\n\n/**\n * Action for toggling strikethrough.\n * @param {EasyMDE} editor\n */\nfunction toggleStrikethrough(editor) {\n    _toggleBlock(editor, 'strikethrough', '~~');\n}\n\n/**\n * Action for toggling code block.\n * @param {EasyMDE} editor\n */\nfunction toggleCodeBlock(editor) {\n    var fenceCharsToInsert = editor.options.blockStyles.code;\n\n    function fencing_line(line) {\n        /* return true, if this is a ``` or ~~~ line */\n        if (typeof line !== 'object') {\n            throw 'fencing_line() takes a \\'line\\' object (not a line number, or line text).  Got: ' + typeof line + ': ' + line;\n        }\n        return line.styles && line.styles[2] && line.styles[2].indexOf('formatting-code-block') !== -1;\n    }\n\n    function token_state(token) {\n        // base goes an extra level deep when mode backdrops are used, e.g. spellchecker on\n        return token.state.base.base || token.state.base;\n    }\n\n    function code_type(cm, line_num, line, firstTok, lastTok) {\n        /*\n         * Return \"single\", \"indented\", \"fenced\" or false\n         *\n         * cm and line_num are required.  Others are optional for efficiency\n         *   To check in the middle of a line, pass in firstTok yourself.\n         */\n        line = line || cm.getLineHandle(line_num);\n        firstTok = firstTok || cm.getTokenAt({\n            line: line_num,\n            ch: 1,\n        });\n        lastTok = lastTok || (!!line.text && cm.getTokenAt({\n            line: line_num,\n            ch: line.text.length - 1,\n        }));\n        var types = firstTok.type ? firstTok.type.split(' ') : [];\n        if (lastTok && token_state(lastTok).indentedCode) {\n            // have to check last char, since first chars of first line aren\"t marked as indented\n            return 'indented';\n        } else if (types.indexOf('comment') === -1) {\n            // has to be after \"indented\" check, since first chars of first indented line aren\"t marked as such\n            return false;\n        } else if (token_state(firstTok).fencedChars || token_state(lastTok).fencedChars || fencing_line(line)) {\n            return 'fenced';\n        } else {\n            return 'single';\n        }\n    }\n\n    function insertFencingAtSelection(cm, cur_start, cur_end, fenceCharsToInsert) {\n        var start_line_sel = cur_start.line + 1,\n            end_line_sel = cur_end.line + 1,\n            sel_multi = cur_start.line !== cur_end.line,\n            repl_start = fenceCharsToInsert + '\\n',\n            repl_end = '\\n' + fenceCharsToInsert;\n        if (sel_multi) {\n            end_line_sel++;\n        }\n        // handle last char including \\n or not\n        if (sel_multi && cur_end.ch === 0) {\n            repl_end = fenceCharsToInsert + '\\n';\n            end_line_sel--;\n        }\n        _replaceSelection(cm, false, [repl_start, repl_end]);\n        cm.setSelection({\n            line: start_line_sel,\n            ch: 0,\n        }, {\n            line: end_line_sel,\n            ch: 0,\n        });\n    }\n\n    var cm = editor.codemirror,\n        cur_start = cm.getCursor('start'),\n        cur_end = cm.getCursor('end'),\n        tok = cm.getTokenAt({\n            line: cur_start.line,\n            ch: cur_start.ch || 1,\n        }), // avoid ch 0 which is a cursor pos but not token\n        line = cm.getLineHandle(cur_start.line),\n        is_code = code_type(cm, cur_start.line, line, tok);\n    var block_start, block_end, lineCount;\n\n    if (is_code === 'single') {\n        // similar to some EasyMDE _toggleBlock logic\n        var start = line.text.slice(0, cur_start.ch).replace('`', ''),\n            end = line.text.slice(cur_start.ch).replace('`', '');\n        cm.replaceRange(start + end, {\n            line: cur_start.line,\n            ch: 0,\n        }, {\n            line: cur_start.line,\n            ch: 99999999999999,\n        });\n        cur_start.ch--;\n        if (cur_start !== cur_end) {\n            cur_end.ch--;\n        }\n        cm.setSelection(cur_start, cur_end);\n        cm.focus();\n    } else if (is_code === 'fenced') {\n        if (cur_start.line !== cur_end.line || cur_start.ch !== cur_end.ch) {\n            // use selection\n\n            // find the fenced line so we know what type it is (tilde, backticks, number of them)\n            for (block_start = cur_start.line; block_start >= 0; block_start--) {\n                line = cm.getLineHandle(block_start);\n                if (fencing_line(line)) {\n                    break;\n                }\n            }\n            var fencedTok = cm.getTokenAt({\n                line: block_start,\n                ch: 1,\n            });\n            var fence_chars = token_state(fencedTok).fencedChars;\n            var start_text, start_line;\n            var end_text, end_line;\n            // check for selection going up against fenced lines, in which case we don't want to add more fencing\n            if (fencing_line(cm.getLineHandle(cur_start.line))) {\n                start_text = '';\n                start_line = cur_start.line;\n            } else if (fencing_line(cm.getLineHandle(cur_start.line - 1))) {\n                start_text = '';\n                start_line = cur_start.line - 1;\n            } else {\n                start_text = fence_chars + '\\n';\n                start_line = cur_start.line;\n            }\n            if (fencing_line(cm.getLineHandle(cur_end.line))) {\n                end_text = '';\n                end_line = cur_end.line;\n                if (cur_end.ch === 0) {\n                    end_line += 1;\n                }\n            } else if (cur_end.ch !== 0 && fencing_line(cm.getLineHandle(cur_end.line + 1))) {\n                end_text = '';\n                end_line = cur_end.line + 1;\n            } else {\n                end_text = fence_chars + '\\n';\n                end_line = cur_end.line + 1;\n            }\n            if (cur_end.ch === 0) {\n                // full last line selected, putting cursor at beginning of next\n                end_line -= 1;\n            }\n            cm.operation(function () {\n                // end line first, so that line numbers don't change\n                cm.replaceRange(end_text, {\n                    line: end_line,\n                    ch: 0,\n                }, {\n                    line: end_line + (end_text ? 0 : 1),\n                    ch: 0,\n                });\n                cm.replaceRange(start_text, {\n                    line: start_line,\n                    ch: 0,\n                }, {\n                    line: start_line + (start_text ? 0 : 1),\n                    ch: 0,\n                });\n            });\n            cm.setSelection({\n                line: start_line + (start_text ? 1 : 0),\n                ch: 0,\n            }, {\n                line: end_line + (start_text ? 1 : -1),\n                ch: 0,\n            });\n            cm.focus();\n        } else {\n            // no selection, search for ends of this fenced block\n            var search_from = cur_start.line;\n            if (fencing_line(cm.getLineHandle(cur_start.line))) { // gets a little tricky if cursor is right on a fenced line\n                if (code_type(cm, cur_start.line + 1) === 'fenced') {\n                    block_start = cur_start.line;\n                    search_from = cur_start.line + 1; // for searching for \"end\"\n                } else {\n                    block_end = cur_start.line;\n                    search_from = cur_start.line - 1; // for searching for \"start\"\n                }\n            }\n            if (block_start === undefined) {\n                for (block_start = search_from; block_start >= 0; block_start--) {\n                    line = cm.getLineHandle(block_start);\n                    if (fencing_line(line)) {\n                        break;\n                    }\n                }\n            }\n            if (block_end === undefined) {\n                lineCount = cm.lineCount();\n                for (block_end = search_from; block_end < lineCount; block_end++) {\n                    line = cm.getLineHandle(block_end);\n                    if (fencing_line(line)) {\n                        break;\n                    }\n                }\n            }\n            cm.operation(function () {\n                cm.replaceRange('', {\n                    line: block_start,\n                    ch: 0,\n                }, {\n                    line: block_start + 1,\n                    ch: 0,\n                });\n                cm.replaceRange('', {\n                    line: block_end - 1,\n                    ch: 0,\n                }, {\n                    line: block_end,\n                    ch: 0,\n                });\n            });\n            cm.focus();\n        }\n    } else if (is_code === 'indented') {\n        if (cur_start.line !== cur_end.line || cur_start.ch !== cur_end.ch) {\n            // use selection\n            block_start = cur_start.line;\n            block_end = cur_end.line;\n            if (cur_end.ch === 0) {\n                block_end--;\n            }\n        } else {\n            // no selection, search for ends of this indented block\n            for (block_start = cur_start.line; block_start >= 0; block_start--) {\n                line = cm.getLineHandle(block_start);\n                if (line.text.match(/^\\s*$/)) {\n                    // empty or all whitespace - keep going\n                    continue;\n                } else {\n                    if (code_type(cm, block_start, line) !== 'indented') {\n                        block_start += 1;\n                        break;\n                    }\n                }\n            }\n            lineCount = cm.lineCount();\n            for (block_end = cur_start.line; block_end < lineCount; block_end++) {\n                line = cm.getLineHandle(block_end);\n                if (line.text.match(/^\\s*$/)) {\n                    // empty or all whitespace - keep going\n                    continue;\n                } else {\n                    if (code_type(cm, block_end, line) !== 'indented') {\n                        block_end -= 1;\n                        break;\n                    }\n                }\n            }\n        }\n        // if we are going to un-indent based on a selected set of lines, and the next line is indented too, we need to\n        // insert a blank line so that the next line(s) continue to be indented code\n        var next_line = cm.getLineHandle(block_end + 1),\n            next_line_last_tok = next_line && cm.getTokenAt({\n                line: block_end + 1,\n                ch: next_line.text.length - 1,\n            }),\n            next_line_indented = next_line_last_tok && token_state(next_line_last_tok).indentedCode;\n        if (next_line_indented) {\n            cm.replaceRange('\\n', {\n                line: block_end + 1,\n                ch: 0,\n            });\n        }\n\n        for (var i = block_start; i <= block_end; i++) {\n            cm.indentLine(i, 'subtract'); // TODO: this doesn't get tracked in the history, so can't be undone :(\n        }\n        cm.focus();\n    } else {\n        // insert code formatting\n        var no_sel_and_starting_of_line = (cur_start.line === cur_end.line && cur_start.ch === cur_end.ch && cur_start.ch === 0);\n        var sel_multi = cur_start.line !== cur_end.line;\n        if (no_sel_and_starting_of_line || sel_multi) {\n            insertFencingAtSelection(cm, cur_start, cur_end, fenceCharsToInsert);\n        } else {\n            _replaceSelection(cm, false, ['`', '`']);\n        }\n    }\n}\n\n/**\n * Action for toggling blockquote.\n */\nfunction toggleBlockquote(editor) {\n    _toggleLine(editor.codemirror, 'quote');\n}\n\n/**\n * Action for toggling heading size: normal -> h1 -> h2 -> h3 -> h4 -> h5 -> h6 -> normal\n */\nfunction toggleHeadingSmaller(editor) {\n    _toggleHeading(editor.codemirror, 'smaller');\n}\n\n/**\n * Action for toggling heading size: normal -> h6 -> h5 -> h4 -> h3 -> h2 -> h1 -> normal\n */\nfunction toggleHeadingBigger(editor) {\n    _toggleHeading(editor.codemirror, 'bigger');\n}\n\n/**\n * Action for toggling heading size 1\n */\nfunction toggleHeading1(editor) {\n    _toggleHeading(editor.codemirror, undefined, 1);\n}\n\n/**\n * Action for toggling heading size 2\n */\nfunction toggleHeading2(editor) {\n    _toggleHeading(editor.codemirror, undefined, 2);\n}\n\n/**\n * Action for toggling heading size 3\n */\nfunction toggleHeading3(editor) {\n    _toggleHeading(editor.codemirror, undefined, 3);\n}\n\n/**\n * Action for toggling heading size 4\n */\nfunction toggleHeading4(editor) {\n    _toggleHeading(editor.codemirror, undefined, 4);\n}\n\n/**\n * Action for toggling heading size 5\n */\nfunction toggleHeading5(editor) {\n    _toggleHeading(editor.codemirror, undefined, 5);\n}\n\n/**\n * Action for toggling heading size 6\n */\nfunction toggleHeading6(editor) {\n    _toggleHeading(editor.codemirror, undefined, 6);\n}\n\n\n/**\n * Action for toggling ul.\n */\nfunction toggleUnorderedList(editor) {\n    var cm = editor.codemirror;\n\n    var listStyle = '*'; // Default\n    if (['-', '+', '*'].includes(editor.options.unorderedListStyle)) {\n        listStyle = editor.options.unorderedListStyle;\n    }\n\n    _toggleLine(cm, 'unordered-list', listStyle);\n}\n\n\n/**\n * Action for toggling ol.\n */\nfunction toggleOrderedList(editor) {\n    _toggleLine(editor.codemirror, 'ordered-list');\n}\n\n/**\n * Action for clean block (remove headline, list, blockquote code, markers)\n */\nfunction cleanBlock(editor) {\n    _cleanBlock(editor.codemirror);\n}\n\n/**\n * Action for drawing a link.\n * @param {EasyMDE} editor\n */\nfunction drawLink(editor) {\n    var options = editor.options;\n    var url = 'https://';\n    if (options.promptURLs) {\n        var result = prompt(options.promptTexts.link, url);\n        if (!result) {\n            return false;\n        }\n        url = escapePromptURL(result);\n    }\n    _toggleLink(editor, 'link', options.insertTexts.link, url);\n}\n\n/**\n * Action for drawing an img.\n * @param {EasyMDE} editor\n */\nfunction drawImage(editor) {\n    var options = editor.options;\n    var url = 'https://';\n    if (options.promptURLs) {\n        var result = prompt(options.promptTexts.image, url);\n        if (!result) {\n            return false;\n        }\n        url = escapePromptURL(result);\n    }\n    _toggleLink(editor, 'image', options.insertTexts.image, url);\n}\n\n/**\n * Encode and escape URLs to prevent breaking up rendered Markdown links.\n * @param {string} url The url of the link or image\n */\nfunction escapePromptURL(url) {\n    return encodeURI(url).replace(/([\\\\()])/g, '\\\\$1');\n}\n\n/**\n * Action for opening the browse-file window to upload an image to a server.\n * @param {EasyMDE} editor The EasyMDE object\n */\nfunction drawUploadedImage(editor) {\n    // TODO: Draw the image template with a fake url? ie: '![](importing foo.png...)'\n    editor.openBrowseFileWindow();\n}\n\n/**\n * Action executed after an image have been successfully imported on the server.\n * @param {EasyMDE} editor The EasyMDE object\n * @param {string} url The url of the uploaded image\n */\nfunction afterImageUploaded(editor, url) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    var imageName = url.substr(url.lastIndexOf('/') + 1);\n    var ext = imageName.substring(imageName.lastIndexOf('.') + 1).replace(/\\?.*$/, '').toLowerCase();\n\n    // Check if media is an image\n    if (['png', 'jpg', 'jpeg', 'gif', 'svg', 'apng', 'avif', 'webp'].includes(ext)) {\n        _replaceSelection(cm, stat.image, options.insertTexts.uploadedImage, url);\n    } else {\n        var text_link = options.insertTexts.link;\n        text_link[0] = '[' + imageName;\n        _replaceSelection(cm, stat.link, text_link, url);\n    }\n\n    // show uploaded image filename for 1000ms\n    editor.updateStatusBar('upload-image', editor.options.imageTexts.sbOnUploaded.replace('#image_name#', imageName));\n    setTimeout(function () {\n        editor.updateStatusBar('upload-image', editor.options.imageTexts.sbInit);\n    }, 1000);\n}\n\n/**\n * Action for drawing a table.\n * @param {EasyMDE} editor\n */\nfunction drawTable(editor) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    _replaceSelection(cm, stat.table, options.insertTexts.table);\n}\n\n/**\n * Action for drawing a horizontal rule.\n * @param {EasyMDE} editor\n */\nfunction drawHorizontalRule(editor) {\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var options = editor.options;\n    _replaceSelection(cm, stat.image, options.insertTexts.horizontalRule);\n}\n\n\n/**\n * Undo action.\n * @param {EasyMDE} editor\n */\nfunction undo(editor) {\n    var cm = editor.codemirror;\n    cm.undo();\n    cm.focus();\n}\n\n\n/**\n * Redo action.\n * @param {EasyMDE} editor\n */\nfunction redo(editor) {\n    var cm = editor.codemirror;\n    cm.redo();\n    cm.focus();\n}\n\n\n/**\n * Toggle side by side preview\n * @param {EasyMDE} editor\n */\nfunction toggleSideBySide(editor) {\n    var cm = editor.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n    var toolbarButton = editor.toolbarElements && editor.toolbarElements['side-by-side'];\n    var useSideBySideListener = false;\n\n    var easyMDEContainer = wrapper.parentNode;\n\n    if (preview.classList.contains('editor-preview-active-side')) {\n        if (editor.options.sideBySideFullscreen === false) {\n            // if side-by-side not-fullscreen ok, remove classes when hiding side\n            easyMDEContainer.classList.remove('sided--no-fullscreen');\n        }\n        preview.classList.remove('editor-preview-active-side');\n        if (toolbarButton) toolbarButton.classList.remove('active');\n        wrapper.classList.remove('CodeMirror-sided');\n    } else {\n        // When the preview button is clicked for the first time,\n        // give some time for the transition from editor.css to fire and the view to slide from right to left,\n        // instead of just appearing.\n        setTimeout(function () {\n            if (!cm.getOption('fullScreen')) {\n                if (editor.options.sideBySideFullscreen === false) {\n                    // if side-by-side not-fullscreen ok, add classes when not fullscreen and showing side\n                    easyMDEContainer.classList.add('sided--no-fullscreen');\n                } else {\n                    toggleFullScreen(editor);\n                }\n            }\n            preview.classList.add('editor-preview-active-side');\n        }, 1);\n        if (toolbarButton) toolbarButton.classList.add('active');\n        wrapper.classList.add('CodeMirror-sided');\n        useSideBySideListener = true;\n    }\n\n    // Hide normal preview if active\n    var previewNormal = wrapper.lastChild;\n    if (previewNormal.classList.contains('editor-preview-active')) {\n        previewNormal.classList.remove('editor-preview-active');\n        var toolbar = editor.toolbarElements.preview;\n        var toolbar_div = editor.toolbar_div;\n        toolbar.classList.remove('active');\n        toolbar_div.classList.remove('disabled-for-preview');\n    }\n\n    var sideBySideRenderingFunction = function () {\n        var newValue = editor.options.previewRender(editor.value(), preview);\n        if (newValue != null) {\n            preview.innerHTML = newValue;\n        }\n    };\n\n    if (!cm.sideBySideRenderingFunction) {\n        cm.sideBySideRenderingFunction = sideBySideRenderingFunction;\n    }\n\n    if (useSideBySideListener) {\n        var newValue = editor.options.previewRender(editor.value(), preview);\n        if (newValue != null) {\n            preview.innerHTML = newValue;\n        }\n        cm.on('update', cm.sideBySideRenderingFunction);\n    } else {\n        cm.off('update', cm.sideBySideRenderingFunction);\n    }\n\n    // Refresh to fix selection being off (#309)\n    cm.refresh();\n}\n\n\n/**\n * Preview action.\n * @param {EasyMDE} editor\n */\nfunction togglePreview(editor) {\n    var cm = editor.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var toolbar_div = editor.toolbar_div;\n    var toolbar = editor.options.toolbar ? editor.toolbarElements.preview : false;\n    var preview = wrapper.lastChild;\n\n    // Turn off side by side if needed\n    var sidebyside = cm.getWrapperElement().nextSibling;\n    if (sidebyside.classList.contains('editor-preview-active-side'))\n        toggleSideBySide(editor);\n\n    if (!preview || !preview.classList.contains('editor-preview-full')) {\n\n        preview = document.createElement('div');\n        preview.className = 'editor-preview-full';\n\n        if (editor.options.previewClass) {\n\n            if (Array.isArray(editor.options.previewClass)) {\n                for (var i = 0; i < editor.options.previewClass.length; i++) {\n                    preview.classList.add(editor.options.previewClass[i]);\n                }\n\n            } else if (typeof editor.options.previewClass === 'string') {\n                preview.classList.add(editor.options.previewClass);\n            }\n        }\n\n        wrapper.appendChild(preview);\n    }\n\n    if (preview.classList.contains('editor-preview-active')) {\n        preview.classList.remove('editor-preview-active');\n        if (toolbar) {\n            toolbar.classList.remove('active');\n            toolbar_div.classList.remove('disabled-for-preview');\n        }\n    } else {\n        // When the preview button is clicked for the first time,\n        // give some time for the transition from editor.css to fire and the view to slide from right to left,\n        // instead of just appearing.\n        setTimeout(function () {\n            preview.classList.add('editor-preview-active');\n        }, 1);\n        if (toolbar) {\n            toolbar.classList.add('active');\n            toolbar_div.classList.add('disabled-for-preview');\n        }\n    }\n\n    var preview_result = editor.options.previewRender(editor.value(), preview);\n    if (preview_result !== null) {\n        preview.innerHTML = preview_result;\n    }\n\n}\n\nfunction _replaceSelection(cm, active, startEnd, url) {\n    if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active'))\n        return;\n\n    var text;\n    var start = startEnd[0];\n    var end = startEnd[1];\n    var startPoint = {},\n        endPoint = {};\n    Object.assign(startPoint, cm.getCursor('start'));\n    Object.assign(endPoint, cm.getCursor('end'));\n    if (url) {\n        start = start.replace('#url#', url);  // url is in start for upload-image\n        end = end.replace('#url#', url);\n    }\n    if (active) {\n        text = cm.getLine(startPoint.line);\n        start = text.slice(0, startPoint.ch);\n        end = text.slice(startPoint.ch);\n        cm.replaceRange(start + end, {\n            line: startPoint.line,\n            ch: 0,\n        });\n    } else {\n        text = cm.getSelection();\n        cm.replaceSelection(start + text + end);\n\n        startPoint.ch += start.length;\n        if (startPoint !== endPoint) {\n            endPoint.ch += start.length;\n        }\n    }\n    cm.setSelection(startPoint, endPoint);\n    cm.focus();\n}\n\n\nfunction _toggleHeading(cm, direction, size) {\n    if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active'))\n        return;\n\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n    for (var i = startPoint.line; i <= endPoint.line; i++) {\n        (function (i) {\n            var text = cm.getLine(i);\n            var currHeadingLevel = text.search(/[^#]/);\n\n            if (direction !== undefined) {\n                if (currHeadingLevel <= 0) {\n                    if (direction == 'bigger') {\n                        text = '###### ' + text;\n                    } else {\n                        text = '# ' + text;\n                    }\n                } else if (currHeadingLevel == 6 && direction == 'smaller') {\n                    text = text.substr(7);\n                } else if (currHeadingLevel == 1 && direction == 'bigger') {\n                    text = text.substr(2);\n                } else {\n                    if (direction == 'bigger') {\n                        text = text.substr(1);\n                    } else {\n                        text = '#' + text;\n                    }\n                }\n            } else {\n                if (currHeadingLevel <= 0) {\n                    text = '#'.repeat(size) + ' ' + text;\n                } else if (currHeadingLevel == size) {\n                    text = text.substr(currHeadingLevel + 1);\n                } else {\n                    text = '#'.repeat(size) + ' ' + text.substr(currHeadingLevel + 1);\n                }\n            }\n\n            cm.replaceRange(text, {\n                line: i,\n                ch: 0,\n            }, {\n                line: i,\n                ch: 99999999999999,\n            });\n        })(i);\n    }\n    cm.focus();\n}\n\n\nfunction _toggleLine(cm, name, liststyle) {\n    if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active'))\n        return;\n\n    var listRegexp = /^(\\s*)(\\*|-|\\+|\\d*\\.)(\\s+)/;\n    var whitespacesRegexp = /^\\s*/;\n\n    var stat = getState(cm);\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n    var repl = {\n        'quote': /^(\\s*)>\\s+/,\n        'unordered-list': listRegexp,\n        'ordered-list': listRegexp,\n    };\n\n    var _getChar = function (name, i) {\n        var map = {\n            'quote': '>',\n            'unordered-list': liststyle,\n            'ordered-list': '%%i.',\n        };\n\n        return map[name].replace('%%i', i);\n    };\n\n    var _checkChar = function (name, char) {\n        var map = {\n            'quote': '>',\n            'unordered-list': '\\\\' + liststyle,\n            'ordered-list': '\\\\d+.',\n        };\n        var rt = new RegExp(map[name]);\n\n        return char && rt.test(char);\n    };\n\n    var _toggle = function (name, text, untoggleOnly) {\n        var arr = listRegexp.exec(text);\n        var char = _getChar(name, line);\n        if (arr !== null) {\n            if (_checkChar(name, arr[2])) {\n                char = '';\n            }\n            text = arr[1] + char + arr[3] + text.replace(whitespacesRegexp, '').replace(repl[name], '$1');\n        } else if (untoggleOnly == false) {\n            text = char + ' ' + text;\n        }\n        return text;\n    };\n\n    var line = 1;\n    for (var i = startPoint.line; i <= endPoint.line; i++) {\n        (function (i) {\n            var text = cm.getLine(i);\n            if (stat[name]) {\n                text = text.replace(repl[name], '$1');\n            } else {\n                // If we're toggling unordered-list formatting, check if the current line\n                // is part of an ordered-list, and if so, untoggle that first.\n                // Workaround for https://github.com/Ionaru/easy-markdown-editor/issues/92\n                if (name == 'unordered-list') {\n                    text = _toggle('ordered-list', text, true);\n                }\n                text = _toggle(name, text, false);\n                line += 1;\n            }\n            cm.replaceRange(text, {\n                line: i,\n                ch: 0,\n            }, {\n                line: i,\n                ch: 99999999999999,\n            });\n        })(i);\n    }\n    cm.focus();\n}\n\n/**\n * @param {EasyMDE} editor\n * @param {'link' | 'image'} type\n * @param {string} startEnd\n * @param {string} url\n */\nfunction _toggleLink(editor, type, startEnd, url) {\n    if (!editor.codemirror || editor.isPreviewActive()) {\n        return;\n    }\n\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n    var active = stat[type];\n    if (!active) {\n        _replaceSelection(cm, active, startEnd, url);\n        return;\n    }\n\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n    var text = cm.getLine(startPoint.line);\n    var start = text.slice(0, startPoint.ch);\n    var end = text.slice(startPoint.ch);\n\n    if (type == 'link') {\n        start = start.replace(/(.*)[^!]\\[/, '$1');\n    } else if (type == 'image') {\n        start = start.replace(/(.*)!\\[$/, '$1');\n    }\n    end = end.replace(/]\\(.*?\\)/, '');\n\n    cm.replaceRange(start + end, {\n        line: startPoint.line,\n        ch: 0,\n    }, {\n        line: startPoint.line,\n        ch: 99999999999999,\n    });\n\n    startPoint.ch -= startEnd[0].length;\n    if (startPoint !== endPoint) {\n        endPoint.ch -= startEnd[0].length;\n    }\n    cm.setSelection(startPoint, endPoint);\n    cm.focus();\n}\n\n/**\n * @param {EasyMDE} editor\n */\nfunction _toggleBlock(editor, type, start_chars, end_chars) {\n    if (!editor.codemirror || editor.isPreviewActive()) {\n        return;\n    }\n\n    end_chars = (typeof end_chars === 'undefined') ? start_chars : end_chars;\n    var cm = editor.codemirror;\n    var stat = getState(cm);\n\n    var text;\n    var start = start_chars;\n    var end = end_chars;\n\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n\n    if (stat[type]) {\n        text = cm.getLine(startPoint.line);\n        start = text.slice(0, startPoint.ch);\n        end = text.slice(startPoint.ch);\n        if (type == 'bold') {\n            start = start.replace(/(\\*\\*|__)(?![\\s\\S]*(\\*\\*|__))/, '');\n            end = end.replace(/(\\*\\*|__)/, '');\n        } else if (type == 'italic') {\n            start = start.replace(/(\\*|_)(?![\\s\\S]*(\\*|_))/, '');\n            end = end.replace(/(\\*|_)/, '');\n        } else if (type == 'strikethrough') {\n            start = start.replace(/(\\*\\*|~~)(?![\\s\\S]*(\\*\\*|~~))/, '');\n            end = end.replace(/(\\*\\*|~~)/, '');\n        }\n        cm.replaceRange(start + end, {\n            line: startPoint.line,\n            ch: 0,\n        }, {\n            line: startPoint.line,\n            ch: 99999999999999,\n        });\n\n        if (type == 'bold' || type == 'strikethrough') {\n            startPoint.ch -= 2;\n            if (startPoint !== endPoint) {\n                endPoint.ch -= 2;\n            }\n        } else if (type == 'italic') {\n            startPoint.ch -= 1;\n            if (startPoint !== endPoint) {\n                endPoint.ch -= 1;\n            }\n        }\n    } else {\n        text = cm.getSelection();\n        if (type == 'bold') {\n            text = text.split('**').join('');\n            text = text.split('__').join('');\n        } else if (type == 'italic') {\n            text = text.split('*').join('');\n            text = text.split('_').join('');\n        } else if (type == 'strikethrough') {\n            text = text.split('~~').join('');\n        }\n        cm.replaceSelection(start + text + end);\n\n        startPoint.ch += start_chars.length;\n        endPoint.ch = startPoint.ch + text.length;\n    }\n\n    cm.setSelection(startPoint, endPoint);\n    cm.focus();\n}\n\nfunction _cleanBlock(cm) {\n    if (cm.getWrapperElement().lastChild.classList.contains('editor-preview-active'))\n        return;\n\n    var startPoint = cm.getCursor('start');\n    var endPoint = cm.getCursor('end');\n    var text;\n\n    for (var line = startPoint.line; line <= endPoint.line; line++) {\n        text = cm.getLine(line);\n        text = text.replace(/^[ ]*([# ]+|\\*|-|[> ]+|[0-9]+(.|\\)))[ ]*/, '');\n\n        cm.replaceRange(text, {\n            line: line,\n            ch: 0,\n        }, {\n            line: line,\n            ch: 99999999999999,\n        });\n    }\n}\n\n/**\n * Convert a number of bytes to a human-readable file size. If you desire\n * to add a space between the value and the unit, you need to add this space\n * to the given units.\n * @param bytes {number} A number of bytes, as integer. Ex: 421137\n * @param units {number[]} An array of human-readable units, ie. [' B', ' K', ' MB']\n * @returns string A human-readable file size. Ex: '412 KB'\n */\nfunction humanFileSize(bytes, units) {\n    if (Math.abs(bytes) < 1024) {\n        return '' + bytes + units[0];\n    }\n    var u = 0;\n    do {\n        bytes /= 1024;\n        ++u;\n    } while (Math.abs(bytes) >= 1024 && u < units.length);\n    return '' + bytes.toFixed(1) + units[u];\n}\n\n// Merge the properties of one object into another.\nfunction _mergeProperties(target, source) {\n    for (var property in source) {\n        if (Object.prototype.hasOwnProperty.call(source, property)) {\n            if (source[property] instanceof Array) {\n                target[property] = source[property].concat(target[property] instanceof Array ? target[property] : []);\n            } else if (\n                source[property] !== null &&\n                typeof source[property] === 'object' &&\n                source[property].constructor === Object\n            ) {\n                target[property] = _mergeProperties(target[property] || {}, source[property]);\n            } else {\n                target[property] = source[property];\n            }\n        }\n    }\n\n    return target;\n}\n\n// Merge an arbitrary number of objects into one.\nfunction extend(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        target = _mergeProperties(target, arguments[i]);\n    }\n\n    return target;\n}\n\n/* The right word count in respect for CJK. */\nfunction wordCount(data) {\n    var pattern = /[a-zA-Z0-9_\\u00A0-\\u02AF\\u0392-\\u03c9\\u0410-\\u04F9]+|[\\u4E00-\\u9FFF\\u3400-\\u4dbf\\uf900-\\ufaff\\u3040-\\u309f\\uac00-\\ud7af]+/g;\n    var m = data.match(pattern);\n    var count = 0;\n    if (m === null) return count;\n    for (var i = 0; i < m.length; i++) {\n        if (m[i].charCodeAt(0) >= 0x4E00) {\n            count += m[i].length;\n        } else {\n            count += 1;\n        }\n    }\n    return count;\n}\n\nvar iconClassMap = {\n    'bold': 'fa fa-bold',\n    'italic': 'fa fa-italic',\n    'strikethrough': 'fa fa-strikethrough',\n    'heading': 'fa fa-header fa-heading',\n    'heading-smaller': 'fa fa-header fa-heading header-smaller',\n    'heading-bigger': 'fa fa-header fa-heading header-bigger',\n    'heading-1': 'fa fa-header fa-heading header-1',\n    'heading-2': 'fa fa-header fa-heading header-2',\n    'heading-3': 'fa fa-header fa-heading header-3',\n    'code': 'fa fa-code',\n    'quote': 'fa fa-quote-left',\n    'ordered-list': 'fa fa-list-ol',\n    'unordered-list': 'fa fa-list-ul',\n    'clean-block': 'fa fa-eraser',\n    'link': 'fa fa-link',\n    'image': 'fa fa-image',\n    'upload-image': 'fa fa-image',\n    'table': 'fa fa-table',\n    'horizontal-rule': 'fa fa-minus',\n    'preview': 'fa fa-eye',\n    'side-by-side': 'fa fa-columns',\n    'fullscreen': 'fa fa-arrows-alt',\n    'guide': 'fa fa-question-circle',\n    'undo': 'fa fa-undo',\n    'redo': 'fa fa-repeat fa-redo',\n};\n\nvar toolbarBuiltInButtons = {\n    'bold': {\n        name: 'bold',\n        action: toggleBold,\n        className: iconClassMap['bold'],\n        title: 'Bold',\n        default: true,\n    },\n    'italic': {\n        name: 'italic',\n        action: toggleItalic,\n        className: iconClassMap['italic'],\n        title: 'Italic',\n        default: true,\n    },\n    'strikethrough': {\n        name: 'strikethrough',\n        action: toggleStrikethrough,\n        className: iconClassMap['strikethrough'],\n        title: 'Strikethrough',\n    },\n    'heading': {\n        name: 'heading',\n        action: toggleHeadingSmaller,\n        className: iconClassMap['heading'],\n        title: 'Heading',\n        default: true,\n    },\n    'heading-smaller': {\n        name: 'heading-smaller',\n        action: toggleHeadingSmaller,\n        className: iconClassMap['heading-smaller'],\n        title: 'Smaller Heading',\n    },\n    'heading-bigger': {\n        name: 'heading-bigger',\n        action: toggleHeadingBigger,\n        className: iconClassMap['heading-bigger'],\n        title: 'Bigger Heading',\n    },\n    'heading-1': {\n        name: 'heading-1',\n        action: toggleHeading1,\n        className: iconClassMap['heading-1'],\n        title: 'Big Heading',\n    },\n    'heading-2': {\n        name: 'heading-2',\n        action: toggleHeading2,\n        className: iconClassMap['heading-2'],\n        title: 'Medium Heading',\n    },\n    'heading-3': {\n        name: 'heading-3',\n        action: toggleHeading3,\n        className: iconClassMap['heading-3'],\n        title: 'Small Heading',\n    },\n    'separator-1': {\n        name: 'separator-1',\n    },\n    'code': {\n        name: 'code',\n        action: toggleCodeBlock,\n        className: iconClassMap['code'],\n        title: 'Code',\n    },\n    'quote': {\n        name: 'quote',\n        action: toggleBlockquote,\n        className: iconClassMap['quote'],\n        title: 'Quote',\n        default: true,\n    },\n    'unordered-list': {\n        name: 'unordered-list',\n        action: toggleUnorderedList,\n        className: iconClassMap['unordered-list'],\n        title: 'Generic List',\n        default: true,\n    },\n    'ordered-list': {\n        name: 'ordered-list',\n        action: toggleOrderedList,\n        className: iconClassMap['ordered-list'],\n        title: 'Numbered List',\n        default: true,\n    },\n    'clean-block': {\n        name: 'clean-block',\n        action: cleanBlock,\n        className: iconClassMap['clean-block'],\n        title: 'Clean block',\n    },\n    'separator-2': {\n        name: 'separator-2',\n    },\n    'link': {\n        name: 'link',\n        action: drawLink,\n        className: iconClassMap['link'],\n        title: 'Create Link',\n        default: true,\n    },\n    'image': {\n        name: 'image',\n        action: drawImage,\n        className: iconClassMap['image'],\n        title: 'Insert Image',\n        default: true,\n    },\n    'upload-image': {\n        name: 'upload-image',\n        action: drawUploadedImage,\n        className: iconClassMap['upload-image'],\n        title: 'Import an image',\n    },\n    'table': {\n        name: 'table',\n        action: drawTable,\n        className: iconClassMap['table'],\n        title: 'Insert Table',\n    },\n    'horizontal-rule': {\n        name: 'horizontal-rule',\n        action: drawHorizontalRule,\n        className: iconClassMap['horizontal-rule'],\n        title: 'Insert Horizontal Line',\n    },\n    'separator-3': {\n        name: 'separator-3',\n    },\n    'preview': {\n        name: 'preview',\n        action: togglePreview,\n        className: iconClassMap['preview'],\n        noDisable: true,\n        title: 'Toggle Preview',\n        default: true,\n    },\n    'side-by-side': {\n        name: 'side-by-side',\n        action: toggleSideBySide,\n        className: iconClassMap['side-by-side'],\n        noDisable: true,\n        noMobile: true,\n        title: 'Toggle Side by Side',\n        default: true,\n    },\n    'fullscreen': {\n        name: 'fullscreen',\n        action: toggleFullScreen,\n        className: iconClassMap['fullscreen'],\n        noDisable: true,\n        noMobile: true,\n        title: 'Toggle Fullscreen',\n        default: true,\n    },\n    'separator-4': {\n        name: 'separator-4',\n    },\n    'guide': {\n        name: 'guide',\n        action: 'https://www.markdownguide.org/basic-syntax/',\n        className: iconClassMap['guide'],\n        noDisable: true,\n        title: 'Markdown Guide',\n        default: true,\n    },\n    'separator-5': {\n        name: 'separator-5',\n    },\n    'undo': {\n        name: 'undo',\n        action: undo,\n        className: iconClassMap['undo'],\n        noDisable: true,\n        title: 'Undo',\n    },\n    'redo': {\n        name: 'redo',\n        action: redo,\n        className: iconClassMap['redo'],\n        noDisable: true,\n        title: 'Redo',\n    },\n};\n\nvar insertTexts = {\n    link: ['[', '](#url#)'],\n    image: ['![', '](#url#)'],\n    uploadedImage: ['![](#url#)', ''],\n    // uploadedImage: ['![](#url#)\\n', ''], // TODO: New line insertion doesn't work here.\n    table: ['', '\\n\\n| Column 1 | Column 2 | Column 3 |\\n| -------- | -------- | -------- |\\n| Text     | Text     | Text     |\\n\\n'],\n    horizontalRule: ['', '\\n\\n-----\\n\\n'],\n};\n\nvar promptTexts = {\n    link: 'URL for the link:',\n    image: 'URL of the image:',\n};\n\nvar timeFormat = {\n    locale: 'en-US',\n    format: {\n        hour: '2-digit',\n        minute: '2-digit',\n    },\n};\n\nvar blockStyles = {\n    'bold': '**',\n    'code': '```',\n    'italic': '*',\n};\n\n/**\n * Texts displayed to the user (mainly on the status bar) for the import image\n * feature. Can be used for customization or internationalization.\n */\nvar imageTexts = {\n    sbInit: 'Attach files by drag and dropping or pasting from clipboard.',\n    sbOnDragEnter: 'Drop image to upload it.',\n    sbOnDrop: 'Uploading image #images_names#...',\n    sbProgress: 'Uploading #file_name#: #progress#%',\n    sbOnUploaded: 'Uploaded #image_name#',\n    sizeUnits: ' B, KB, MB',\n};\n\n/**\n * Errors displayed to the user, using the `errorCallback` option. Can be used for\n * customization or internationalization.\n */\nvar errorMessages = {\n    noFileGiven: 'You must select a file.',\n    typeNotAllowed: 'This image type is not allowed.',\n    fileTooLarge: 'Image #image_name# is too big (#image_size#).\\n' +\n        'Maximum file size is #image_max_size#.',\n    importError: 'Something went wrong when uploading the image #image_name#.',\n};\n\n/**\n * Interface of EasyMDE.\n */\nfunction EasyMDE(options) {\n    // Handle options parameter\n    options = options || {};\n\n    // Used later to refer to it\"s parent\n    options.parent = this;\n\n    // Check if Font Awesome needs to be auto downloaded\n    var autoDownloadFA = true;\n\n    if (options.autoDownloadFontAwesome === false) {\n        autoDownloadFA = false;\n    }\n\n    if (options.autoDownloadFontAwesome !== true) {\n        var styleSheets = document.styleSheets;\n        for (var i = 0; i < styleSheets.length; i++) {\n            if (!styleSheets[i].href)\n                continue;\n\n            if (styleSheets[i].href.indexOf('//maxcdn.bootstrapcdn.com/font-awesome/') > -1) {\n                autoDownloadFA = false;\n            }\n        }\n    }\n\n    if (autoDownloadFA) {\n        var link = document.createElement('link');\n        link.rel = 'stylesheet';\n        link.href = 'https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css';\n        document.getElementsByTagName('head')[0].appendChild(link);\n    }\n\n\n    // Find the textarea to use\n    if (options.element) {\n        this.element = options.element;\n    } else if (options.element === null) {\n        // This means that the element option was specified, but no element was found\n        console.log('EasyMDE: Error. No element was found.');\n        return;\n    }\n\n\n    // Handle toolbar\n    if (options.toolbar === undefined) {\n        // Initialize\n        options.toolbar = [];\n\n\n        // Loop over the built in buttons, to get the preferred order\n        for (var key in toolbarBuiltInButtons) {\n            if (Object.prototype.hasOwnProperty.call(toolbarBuiltInButtons, key)) {\n                if (key.indexOf('separator-') != -1) {\n                    options.toolbar.push('|');\n                }\n\n                if (toolbarBuiltInButtons[key].default === true || (options.showIcons && options.showIcons.constructor === Array && options.showIcons.indexOf(key) != -1)) {\n                    options.toolbar.push(key);\n                }\n            }\n        }\n    }\n\n    // Editor preview styling class.\n    if (!Object.prototype.hasOwnProperty.call(options, 'previewClass')) {\n        options.previewClass = 'editor-preview';\n    }\n\n    // Handle status bar\n    if (!Object.prototype.hasOwnProperty.call(options, 'status')) {\n        options.status = ['autosave', 'lines', 'words', 'cursor'];\n\n        if (options.uploadImage) {\n            options.status.unshift('upload-image');\n        }\n    }\n\n\n    // Add default preview rendering function\n    if (!options.previewRender) {\n        options.previewRender = function (plainText) {\n            // Note: \"this\" refers to the options object\n            return this.parent.markdown(plainText);\n        };\n    }\n\n\n    // Set default options for parsing config\n    options.parsingConfig = extend({\n        highlightFormatting: true, // needed for toggleCodeBlock to detect types of code\n    }, options.parsingConfig || {});\n\n\n    // Merging the insertTexts, with the given options\n    options.insertTexts = extend({}, insertTexts, options.insertTexts || {});\n\n\n    // Merging the promptTexts, with the given options\n    options.promptTexts = extend({}, promptTexts, options.promptTexts || {});\n\n\n    // Merging the blockStyles, with the given options\n    options.blockStyles = extend({}, blockStyles, options.blockStyles || {});\n\n\n    if (options.autosave != undefined) {\n        // Merging the Autosave timeFormat, with the given options\n        options.autosave.timeFormat = extend({}, timeFormat, options.autosave.timeFormat || {});\n    }\n\n    options.iconClassMap = extend({}, iconClassMap, options.iconClassMap || {});\n\n    // Merging the shortcuts, with the given options\n    options.shortcuts = extend({}, shortcuts, options.shortcuts || {});\n\n    options.maxHeight = options.maxHeight || undefined;\n\n    options.direction = options.direction || 'ltr';\n\n    if (typeof options.maxHeight !== 'undefined') {\n        // Min and max height are equal if maxHeight is set\n        options.minHeight = options.maxHeight;\n    } else {\n        options.minHeight = options.minHeight || '300px';\n    }\n\n    options.errorCallback = options.errorCallback || function (errorMessage) {\n        alert(errorMessage);\n    };\n\n    // Import-image default configuration\n    options.uploadImage = options.uploadImage || false;\n    options.imageMaxSize = options.imageMaxSize || 2097152; // 1024 * 1024 * 2\n    options.imageAccept = options.imageAccept || 'image/png, image/jpeg, image/gif, image/avif';\n    options.imageTexts = extend({}, imageTexts, options.imageTexts || {});\n    options.errorMessages = extend({}, errorMessages, options.errorMessages || {});\n    options.imagePathAbsolute = options.imagePathAbsolute || false;\n    options.imageCSRFName = options.imageCSRFName || 'csrfmiddlewaretoken';\n    options.imageCSRFHeader = options.imageCSRFHeader || false;\n\n\n    // Change unique_id to uniqueId for backwards compatibility\n    if (options.autosave != undefined && options.autosave.unique_id != undefined && options.autosave.unique_id != '')\n        options.autosave.uniqueId = options.autosave.unique_id;\n\n    // If overlay mode is specified and combine is not provided, default it to true\n    if (options.overlayMode && options.overlayMode.combine === undefined) {\n        options.overlayMode.combine = true;\n    }\n\n    // Update this options\n    this.options = options;\n\n\n    // Auto render\n    this.render();\n\n\n    // The codemirror component is only available after rendering\n    // so, the setter for the initialValue can only run after\n    // the element has been rendered\n    if (options.initialValue && (!this.options.autosave || this.options.autosave.foundSavedValue !== true)) {\n        this.value(options.initialValue);\n    }\n\n    if (options.uploadImage) {\n        var self = this;\n\n        this.codemirror.on('dragenter', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbOnDragEnter);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n        this.codemirror.on('dragend', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n        this.codemirror.on('dragleave', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n\n        this.codemirror.on('dragover', function (cm, event) {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbOnDragEnter);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n\n        this.codemirror.on('drop', function (cm, event) {\n            event.stopPropagation();\n            event.preventDefault();\n            if (options.imageUploadFunction) {\n                self.uploadImagesUsingCustomFunction(options.imageUploadFunction, event.dataTransfer.files);\n            } else {\n                self.uploadImages(event.dataTransfer.files);\n            }\n        });\n\n        this.codemirror.on('paste', function (cm, event) {\n            if (options.imageUploadFunction) {\n                self.uploadImagesUsingCustomFunction(options.imageUploadFunction, event.clipboardData.files);\n            } else {\n                self.uploadImages(event.clipboardData.files);\n            }\n        });\n    }\n}\n\n/**\n * Upload asynchronously a list of images to a server.\n *\n * Can be triggered by:\n * - drag&drop;\n * - copy-paste;\n * - the browse-file window (opened when the user clicks on the *upload-image* icon).\n * @param {FileList} files The files to upload the the server.\n * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage\n * @param [onError] {function} see EasyMDE.prototype.uploadImage\n */\nEasyMDE.prototype.uploadImages = function (files, onSuccess, onError) {\n    if (files.length === 0) {\n        return;\n    }\n    var names = [];\n    for (var i = 0; i < files.length; i++) {\n        names.push(files[i].name);\n        this.uploadImage(files[i], onSuccess, onError);\n    }\n    this.updateStatusBar('upload-image', this.options.imageTexts.sbOnDrop.replace('#images_names#', names.join(', ')));\n};\n\n/**\n * Upload asynchronously a list of images to a server.\n *\n * Can be triggered by:\n * - drag&drop;\n * - copy-paste;\n * - the browse-file window (opened when the user clicks on the *upload-image* icon).\n * @param imageUploadFunction {Function} The custom function to upload the image passed in options.\n * @param {FileList} files The files to upload the the server.\n */\nEasyMDE.prototype.uploadImagesUsingCustomFunction = function (imageUploadFunction, files) {\n    if (files.length === 0) {\n        return;\n    }\n    var names = [];\n    for (var i = 0; i < files.length; i++) {\n        names.push(files[i].name);\n        this.uploadImageUsingCustomFunction(imageUploadFunction, files[i]);\n    }\n    this.updateStatusBar('upload-image', this.options.imageTexts.sbOnDrop.replace('#images_names#', names.join(', ')));\n};\n\n/**\n * Update an item in the status bar.\n * @param itemName {string} The name of the item to update (ie. 'upload-image', 'autosave', etc.).\n * @param content {string} the new content of the item to write in the status bar.\n */\nEasyMDE.prototype.updateStatusBar = function (itemName, content) {\n    if (!this.gui.statusbar) {\n        return;\n    }\n\n    var matchingClasses = this.gui.statusbar.getElementsByClassName(itemName);\n    if (matchingClasses.length === 1) {\n        this.gui.statusbar.getElementsByClassName(itemName)[0].textContent = content;\n    } else if (matchingClasses.length === 0) {\n        console.log('EasyMDE: status bar item ' + itemName + ' was not found.');\n    } else {\n        console.log('EasyMDE: Several status bar items named ' + itemName + ' was found.');\n    }\n};\n\n/**\n * Default markdown render.\n */\nEasyMDE.prototype.markdown = function (text) {\n    if (marked) {\n        // Initialize\n        var markedOptions;\n        if (this.options && this.options.renderingConfig && this.options.renderingConfig.markedOptions) {\n            markedOptions = this.options.renderingConfig.markedOptions;\n        } else {\n            markedOptions = {};\n        }\n\n        // Update options\n        if (this.options && this.options.renderingConfig && this.options.renderingConfig.singleLineBreaks === false) {\n            markedOptions.breaks = false;\n        } else {\n            markedOptions.breaks = true;\n        }\n\n        if (this.options && this.options.renderingConfig && this.options.renderingConfig.codeSyntaxHighlighting === true) {\n\n            /* Get HLJS from config or window */\n            var hljs = this.options.renderingConfig.hljs || window.hljs;\n\n            /* Check if HLJS loaded */\n            if (hljs) {\n                markedOptions.highlight = function (code, language) {\n                    if (language && hljs.getLanguage(language)) {\n                        return hljs.highlight(language, code).value;\n                    } else {\n                        return hljs.highlightAuto(code).value;\n                    }\n                };\n            }\n        }\n\n        // Set options\n        marked.setOptions(markedOptions);\n\n        // Convert the markdown to HTML\n        var htmlText = marked.parse(text);\n\n        // Sanitize HTML\n        if (this.options.renderingConfig && typeof this.options.renderingConfig.sanitizerFunction === 'function') {\n            htmlText = this.options.renderingConfig.sanitizerFunction.call(this, htmlText);\n        }\n\n        // Edit the HTML anchors to add 'target=\"_blank\"' by default.\n        htmlText = addAnchorTargetBlank(htmlText);\n\n        // Remove list-style when rendering checkboxes\n        htmlText = removeListStyleWhenCheckbox(htmlText);\n\n        return htmlText;\n    }\n};\n\n/**\n * Render editor to the given element.\n */\nEasyMDE.prototype.render = function (el) {\n    if (!el) {\n        el = this.element || document.getElementsByTagName('textarea')[0];\n    }\n\n    if (this._rendered && this._rendered === el) {\n        // Already rendered.\n        return;\n    }\n\n    this.element = el;\n    var options = this.options;\n\n    var self = this;\n    var keyMaps = {};\n\n    for (var key in options.shortcuts) {\n        // null stands for \"do not bind this command\"\n        if (options.shortcuts[key] !== null && bindings[key] !== null) {\n            (function (key) {\n                keyMaps[fixShortcut(options.shortcuts[key])] = function () {\n                    var action = bindings[key];\n                    if (typeof action === 'function') {\n                        action(self);\n                    } else if (typeof action === 'string') {\n                        window.open(action, '_blank');\n                    }\n                };\n            })(key);\n        }\n    }\n\n    keyMaps['Enter'] = 'newlineAndIndentContinueMarkdownList';\n    keyMaps['Tab'] = 'tabAndIndentMarkdownList';\n    keyMaps['Shift-Tab'] = 'shiftTabAndUnindentMarkdownList';\n    keyMaps['Esc'] = function (cm) {\n        if (cm.getOption('fullScreen')) toggleFullScreen(self);\n    };\n\n    this.documentOnKeyDown = function (e) {\n        e = e || window.event;\n\n        if (e.keyCode == 27) {\n            if (self.codemirror.getOption('fullScreen')) toggleFullScreen(self);\n        }\n    };\n    document.addEventListener('keydown', this.documentOnKeyDown, false);\n\n    var mode, backdrop;\n\n    // CodeMirror overlay mode\n    if (options.overlayMode) {\n        CodeMirror.defineMode('overlay-mode', function (config) {\n            return CodeMirror.overlayMode(CodeMirror.getMode(config, options.spellChecker !== false ? 'spell-checker' : 'gfm'), options.overlayMode.mode, options.overlayMode.combine);\n        });\n\n        mode = 'overlay-mode';\n        backdrop = options.parsingConfig;\n        backdrop.gitHubSpice = false;\n    } else {\n        mode = options.parsingConfig;\n        mode.name = 'gfm';\n        mode.gitHubSpice = false;\n    }\n    if (options.spellChecker !== false) {\n        mode = 'spell-checker';\n        backdrop = options.parsingConfig;\n        backdrop.name = 'gfm';\n        backdrop.gitHubSpice = false;\n\n        if (typeof options.spellChecker === 'function') {\n            options.spellChecker({\n                codeMirrorInstance: CodeMirror,\n            });\n        } else {\n            CodeMirrorSpellChecker({\n                codeMirrorInstance: CodeMirror,\n            });\n        }\n    }\n\n    // eslint-disable-next-line no-unused-vars\n    function configureMouse(cm, repeat, event) {\n        return {\n            addNew: false,\n        };\n    }\n\n    this.codemirror = CodeMirror.fromTextArea(el, {\n        mode: mode,\n        backdrop: backdrop,\n        theme: (options.theme != undefined) ? options.theme : 'easymde',\n        tabSize: (options.tabSize != undefined) ? options.tabSize : 2,\n        indentUnit: (options.tabSize != undefined) ? options.tabSize : 2,\n        indentWithTabs: (options.indentWithTabs === false) ? false : true,\n        lineNumbers: (options.lineNumbers === true) ? true : false,\n        autofocus: (options.autofocus === true) ? true : false,\n        extraKeys: keyMaps,\n        direction: options.direction,\n        lineWrapping: (options.lineWrapping === false) ? false : true,\n        allowDropFileTypes: ['text/plain'],\n        placeholder: options.placeholder || el.getAttribute('placeholder') || '',\n        styleSelectedText: (options.styleSelectedText != undefined) ? options.styleSelectedText : !isMobile(),\n        scrollbarStyle: (options.scrollbarStyle != undefined) ? options.scrollbarStyle : 'native',\n        configureMouse: configureMouse,\n        inputStyle: (options.inputStyle != undefined) ? options.inputStyle : isMobile() ? 'contenteditable' : 'textarea',\n        spellcheck: (options.nativeSpellcheck != undefined) ? options.nativeSpellcheck : true,\n        autoRefresh: (options.autoRefresh != undefined) ? options.autoRefresh : false,\n    });\n\n    this.codemirror.getScrollerElement().style.minHeight = options.minHeight;\n\n    if (typeof options.maxHeight !== 'undefined') {\n        this.codemirror.getScrollerElement().style.height = options.maxHeight;\n    }\n\n    if (options.forceSync === true) {\n        var cm = this.codemirror;\n        cm.on('change', function () {\n            cm.save();\n        });\n    }\n\n    this.gui = {};\n\n    // Wrap Codemirror with container before create toolbar, etc,\n    // to use with sideBySideFullscreen option.\n    var easyMDEContainer = document.createElement('div');\n    easyMDEContainer.classList.add('EasyMDEContainer');\n    easyMDEContainer.setAttribute('role', 'application');\n    var cmWrapper = this.codemirror.getWrapperElement();\n    cmWrapper.parentNode.insertBefore(easyMDEContainer, cmWrapper);\n    easyMDEContainer.appendChild(cmWrapper);\n\n    if (options.toolbar !== false) {\n        this.gui.toolbar = this.createToolbar();\n    }\n    if (options.status !== false) {\n        this.gui.statusbar = this.createStatusbar();\n    }\n    if (options.autosave != undefined && options.autosave.enabled === true) {\n        this.autosave(); // use to load localstorage content\n        this.codemirror.on('change', function () {\n            clearTimeout(self._autosave_timeout);\n            self._autosave_timeout = setTimeout(function () {\n                self.autosave();\n            }, self.options.autosave.submit_delay || self.options.autosave.delay || 1000);\n        });\n    }\n\n    function calcHeight(naturalWidth, naturalHeight) {\n        var height;\n        var viewportWidth = window.getComputedStyle(document.querySelector('.CodeMirror-sizer')).width.replace('px', '');\n        if (naturalWidth < viewportWidth) {\n            height = naturalHeight + 'px';\n        } else {\n            height = (naturalHeight / naturalWidth * 100) + '%';\n        }\n        return height;\n    }\n\n    var _vm = this;\n\n\n    function assignImageBlockAttributes(parentEl, img) {\n        parentEl.setAttribute('data-img-src', img.url);\n        parentEl.setAttribute('style', '--bg-image:url(' + img.url + ');--width:' + img.naturalWidth + 'px;--height:' + calcHeight(img.naturalWidth, img.naturalHeight));\n        _vm.codemirror.setSize();\n    }\n\n    function handleImages() {\n        if (!options.previewImagesInEditor) {\n            return;\n        }\n\n        easyMDEContainer.querySelectorAll('.cm-image-marker').forEach(function (e) {\n            var parentEl = e.parentElement;\n            if (!parentEl.innerText.match(/^!\\[.*?\\]\\(.*\\)/g)) {\n                // if img pasted on the same line with other text, don't preview, preview only images on separate line\n                return;\n            }\n            if (!parentEl.hasAttribute('data-img-src')) {\n                var srcAttr = parentEl.innerText.match('\\\\((.*)\\\\)'); // might require better parsing according to markdown spec\n                if (!window.EMDEimagesCache) {\n                    window.EMDEimagesCache = {};\n                }\n\n                if (srcAttr && srcAttr.length >= 2) {\n                    var keySrc = srcAttr[1];\n\n                    if (options.imagesPreviewHandler) {\n                        var newSrc = options.imagesPreviewHandler(srcAttr[1]);\n                        // defensive check making sure the handler provided by the user returns a string\n                        if (typeof newSrc === 'string') {\n                            keySrc = newSrc;\n                        }\n                    }\n\n                    if (!window.EMDEimagesCache[keySrc]) {\n                        var img = document.createElement('img');\n                        img.onload = function () {\n                            window.EMDEimagesCache[keySrc] = {\n                                naturalWidth: img.naturalWidth,\n                                naturalHeight: img.naturalHeight,\n                                url: keySrc,\n                            };\n                            assignImageBlockAttributes(parentEl, window.EMDEimagesCache[keySrc]);\n                        };\n                        img.src = keySrc;\n                    } else {\n                        assignImageBlockAttributes(parentEl, window.EMDEimagesCache[keySrc]);\n                    }\n                }\n            }\n        });\n    }\n\n    this.codemirror.on('update', function () {\n        handleImages();\n    });\n\n    this.gui.sideBySide = this.createSideBySide();\n    this._rendered = this.element;\n\n    if (options.autofocus === true || el.autofocus) {\n        this.codemirror.focus();\n    }\n\n    // Fixes CodeMirror bug (#344)\n    var temp_cm = this.codemirror;\n    setTimeout(function () {\n        temp_cm.refresh();\n    }.bind(temp_cm), 0);\n};\n\nEasyMDE.prototype.cleanup = function () {\n    document.removeEventListener('keydown', this.documentOnKeyDown);\n};\n\n// Safari, in Private Browsing Mode, looks like it supports localStorage but all calls to setItem throw QuotaExceededError. We're going to detect this and set a variable accordingly.\nfunction isLocalStorageAvailable() {\n    if (typeof localStorage === 'object') {\n        try {\n            localStorage.setItem('smde_localStorage', 1);\n            localStorage.removeItem('smde_localStorage');\n        } catch (e) {\n            return false;\n        }\n    } else {\n        return false;\n    }\n\n    return true;\n}\n\nEasyMDE.prototype.autosave = function () {\n    if (isLocalStorageAvailable()) {\n        var easyMDE = this;\n\n        if (this.options.autosave.uniqueId == undefined || this.options.autosave.uniqueId == '') {\n            console.log('EasyMDE: You must set a uniqueId to use the autosave feature');\n            return;\n        }\n\n        if (this.options.autosave.binded !== true) {\n            if (easyMDE.element.form != null && easyMDE.element.form != undefined) {\n                easyMDE.element.form.addEventListener('submit', function () {\n                    clearTimeout(easyMDE.autosaveTimeoutId);\n                    easyMDE.autosaveTimeoutId = undefined;\n\n                    localStorage.removeItem('smde_' + easyMDE.options.autosave.uniqueId);\n                });\n            }\n\n            this.options.autosave.binded = true;\n        }\n\n        if (this.options.autosave.loaded !== true) {\n            if (typeof localStorage.getItem('smde_' + this.options.autosave.uniqueId) == 'string' && localStorage.getItem('smde_' + this.options.autosave.uniqueId) != '') {\n                this.codemirror.setValue(localStorage.getItem('smde_' + this.options.autosave.uniqueId));\n                this.options.autosave.foundSavedValue = true;\n            }\n\n            this.options.autosave.loaded = true;\n        }\n\n        var value = easyMDE.value();\n        if (value !== '') {\n            localStorage.setItem('smde_' + this.options.autosave.uniqueId, value);\n        } else {\n            localStorage.removeItem('smde_' + this.options.autosave.uniqueId);\n        }\n\n        var el = document.getElementById('autosaved');\n        if (el != null && el != undefined && el != '') {\n            var d = new Date();\n            var dd = new Intl.DateTimeFormat([this.options.autosave.timeFormat.locale, 'en-US'], this.options.autosave.timeFormat.format).format(d);\n            var save = this.options.autosave.text == undefined ? 'Autosaved: ' : this.options.autosave.text;\n\n            el.innerHTML = save + dd;\n        }\n    } else {\n        console.log('EasyMDE: localStorage not available, cannot autosave');\n    }\n};\n\nEasyMDE.prototype.clearAutosavedValue = function () {\n    if (isLocalStorageAvailable()) {\n        if (this.options.autosave == undefined || this.options.autosave.uniqueId == undefined || this.options.autosave.uniqueId == '') {\n            console.log('EasyMDE: You must set a uniqueId to clear the autosave value');\n            return;\n        }\n\n        localStorage.removeItem('smde_' + this.options.autosave.uniqueId);\n    } else {\n        console.log('EasyMDE: localStorage not available, cannot autosave');\n    }\n};\n\n/**\n * Open the browse-file window to upload an image to a server.\n * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage\n * @param [onError] {function} see EasyMDE.prototype.uploadImage\n */\nEasyMDE.prototype.openBrowseFileWindow = function (onSuccess, onError) {\n    var self = this;\n    var imageInput = this.gui.toolbar.getElementsByClassName('imageInput')[0];\n    imageInput.click(); //dispatchEvent(new MouseEvent('click'));  // replaced with click() for IE11 compatibility.\n    function onChange(event) {\n        if (self.options.imageUploadFunction) {\n            self.uploadImagesUsingCustomFunction(self.options.imageUploadFunction, event.target.files);\n        } else {\n            self.uploadImages(event.target.files, onSuccess, onError);\n        }\n        imageInput.removeEventListener('change', onChange);\n    }\n\n    imageInput.addEventListener('change', onChange);\n};\n\n/**\n * Upload an image to the server.\n *\n * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File)\n * @param [onSuccess] {function} A callback function to execute after the image has been successfully uploaded, with one parameter:\n * - url (string): The URL of the uploaded image.\n * @param [onError] {function} A callback function to execute when the image upload fails, with one parameter:\n * - error (string): the detailed error to display to the user (based on messages from options.errorMessages).\n */\nEasyMDE.prototype.uploadImage = function (file, onSuccess, onError) {\n    var self = this;\n    onSuccess = onSuccess || function onSuccess(imageUrl) {\n        afterImageUploaded(self, imageUrl);\n    };\n\n    function onErrorSup(errorMessage) {\n        // show error on status bar and reset after 10000ms\n        self.updateStatusBar('upload-image', errorMessage);\n\n        setTimeout(function () {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n        }, 10000);\n\n        // run custom error handler\n        if (onError && typeof onError === 'function') {\n            onError(errorMessage);\n        }\n        // run error handler from options, this alerts the message.\n        self.options.errorCallback(errorMessage);\n    }\n\n    function fillErrorMessage(errorMessage) {\n        var units = self.options.imageTexts.sizeUnits.split(',');\n        return errorMessage\n            .replace('#image_name#', file.name)\n            .replace('#image_size#', humanFileSize(file.size, units))\n            .replace('#image_max_size#', humanFileSize(self.options.imageMaxSize, units));\n    }\n\n    if (file.size > this.options.imageMaxSize) {\n        onErrorSup(fillErrorMessage(this.options.errorMessages.fileTooLarge));\n        return;\n    }\n\n    var formData = new FormData();\n    formData.append('image', file);\n\n    // insert CSRF body token if provided in config.\n    if (self.options.imageCSRFToken && !self.options.imageCSRFHeader) {\n        formData.append(self.options.imageCSRFName, self.options.imageCSRFToken);\n    }\n\n    var request = new XMLHttpRequest();\n    request.upload.onprogress = function (event) {\n        if (event.lengthComputable) {\n            var progress = '' + Math.round((event.loaded * 100) / event.total);\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbProgress.replace('#file_name#', file.name).replace('#progress#', progress));\n        }\n    };\n    request.open('POST', this.options.imageUploadEndpoint);\n\n    // insert CSRF header token if provided in config.\n    if (self.options.imageCSRFToken && self.options.imageCSRFHeader) {\n        request.setRequestHeader(self.options.imageCSRFName, self.options.imageCSRFToken);\n    }\n\n    request.onload = function () {\n        try {\n            var response = JSON.parse(this.responseText);\n        } catch (error) {\n            console.error('EasyMDE: The server did not return a valid json.');\n            onErrorSup(fillErrorMessage(self.options.errorMessages.importError));\n            return;\n        }\n        if (this.status === 200 && response && !response.error && response.data && response.data.filePath) {\n            onSuccess((self.options.imagePathAbsolute ? '' : (window.location.origin + '/')) + response.data.filePath);\n        } else {\n            if (response.error && response.error in self.options.errorMessages) {  // preformatted error message\n                onErrorSup(fillErrorMessage(self.options.errorMessages[response.error]));\n            } else if (response.error) {  // server side generated error message\n                onErrorSup(fillErrorMessage(response.error));\n            } else {  //unknown error\n                console.error('EasyMDE: Received an unexpected response after uploading the image.'\n                    + this.status + ' (' + this.statusText + ')');\n                onErrorSup(fillErrorMessage(self.options.errorMessages.importError));\n            }\n        }\n    };\n\n    request.onerror = function (event) {\n        console.error('EasyMDE: An unexpected error occurred when trying to upload the image.'\n            + event.target.status + ' (' + event.target.statusText + ')');\n        onErrorSup(self.options.errorMessages.importError);\n    };\n\n    request.send(formData);\n\n};\n\n/**\n * Upload an image to the server using a custom upload function.\n *\n * @param imageUploadFunction {Function} The custom function to upload the image passed in options\n * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File).\n */\nEasyMDE.prototype.uploadImageUsingCustomFunction = function (imageUploadFunction, file) {\n    var self = this;\n\n    function onSuccess(imageUrl) {\n        afterImageUploaded(self, imageUrl);\n    }\n\n    function onError(errorMessage) {\n        var filledErrorMessage = fillErrorMessage(errorMessage);\n        // show error on status bar and reset after 10000ms\n        self.updateStatusBar('upload-image', filledErrorMessage);\n\n        setTimeout(function () {\n            self.updateStatusBar('upload-image', self.options.imageTexts.sbInit);\n        }, 10000);\n\n        // run error handler from options, this alerts the message.\n        self.options.errorCallback(filledErrorMessage);\n    }\n\n    function fillErrorMessage(errorMessage) {\n        var units = self.options.imageTexts.sizeUnits.split(',');\n        return errorMessage\n            .replace('#image_name#', file.name)\n            .replace('#image_size#', humanFileSize(file.size, units))\n            .replace('#image_max_size#', humanFileSize(self.options.imageMaxSize, units));\n    }\n\n    imageUploadFunction.apply(this, [file, onSuccess, onError]);\n};\n\nEasyMDE.prototype.setPreviewMaxHeight = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n\n    // Calc preview max height\n    var paddingTop = parseInt(window.getComputedStyle(wrapper).paddingTop);\n    var borderTopWidth = parseInt(window.getComputedStyle(wrapper).borderTopWidth);\n    var optionsMaxHeight = parseInt(this.options.maxHeight);\n    var wrapperMaxHeight = optionsMaxHeight + paddingTop * 2 + borderTopWidth * 2;\n    var previewMaxHeight = wrapperMaxHeight.toString() + 'px';\n\n    preview.style.height = previewMaxHeight;\n};\n\nEasyMDE.prototype.createSideBySide = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n\n    if (!preview || !preview.classList.contains('editor-preview-side')) {\n        preview = document.createElement('div');\n        preview.className = 'editor-preview-side';\n\n        if (this.options.previewClass) {\n\n            if (Array.isArray(this.options.previewClass)) {\n                for (var i = 0; i < this.options.previewClass.length; i++) {\n                    preview.classList.add(this.options.previewClass[i]);\n                }\n\n            } else if (typeof this.options.previewClass === 'string') {\n                preview.classList.add(this.options.previewClass);\n            }\n        }\n\n        wrapper.parentNode.insertBefore(preview, wrapper.nextSibling);\n    }\n\n    if (typeof this.options.maxHeight !== 'undefined') {\n        this.setPreviewMaxHeight();\n    }\n\n    if (this.options.syncSideBySidePreviewScroll === false) return preview;\n    // Syncs scroll  editor -> preview\n    var cScroll = false;\n    var pScroll = false;\n    cm.on('scroll', function (v) {\n        if (cScroll) {\n            cScroll = false;\n            return;\n        }\n        pScroll = true;\n        var height = v.getScrollInfo().height - v.getScrollInfo().clientHeight;\n        var ratio = parseFloat(v.getScrollInfo().top) / height;\n        var move = (preview.scrollHeight - preview.clientHeight) * ratio;\n        preview.scrollTop = move;\n    });\n\n    // Syncs scroll  preview -> editor\n    preview.onscroll = function () {\n        if (pScroll) {\n            pScroll = false;\n            return;\n        }\n        cScroll = true;\n        var height = preview.scrollHeight - preview.clientHeight;\n        var ratio = parseFloat(preview.scrollTop) / height;\n        var move = (cm.getScrollInfo().height - cm.getScrollInfo().clientHeight) * ratio;\n        cm.scrollTo(0, move);\n    };\n    return preview;\n};\n\nEasyMDE.prototype.createToolbar = function (items) {\n    items = items || this.options.toolbar;\n\n    if (!items || items.length === 0) {\n        return;\n    }\n    var i;\n    for (i = 0; i < items.length; i++) {\n        if (toolbarBuiltInButtons[items[i]] != undefined) {\n            items[i] = toolbarBuiltInButtons[items[i]];\n        }\n    }\n\n    var bar = document.createElement('div');\n    bar.className = 'editor-toolbar';\n    bar.setAttribute('role', 'toolbar');\n\n    var self = this;\n\n    var toolbarData = {};\n    self.toolbar = items;\n\n    for (i = 0; i < items.length; i++) {\n        if (items[i].name == 'guide' && self.options.toolbarGuideIcon === false)\n            continue;\n\n        if (self.options.hideIcons && self.options.hideIcons.indexOf(items[i].name) != -1)\n            continue;\n\n        // Fullscreen does not work well on mobile devices (even tablets)\n        // In the future, hopefully this can be resolved\n        if ((items[i].name == 'fullscreen' || items[i].name == 'side-by-side') && isMobile())\n            continue;\n\n\n        // Don't include trailing separators\n        if (items[i] === '|') {\n            var nonSeparatorIconsFollow = false;\n\n            for (var x = (i + 1); x < items.length; x++) {\n                if (items[x] !== '|' && (!self.options.hideIcons || self.options.hideIcons.indexOf(items[x].name) == -1)) {\n                    nonSeparatorIconsFollow = true;\n                }\n            }\n\n            if (!nonSeparatorIconsFollow)\n                continue;\n        }\n\n\n        // Create the icon and append to the toolbar\n        (function (item) {\n            var el;\n            if (item === '|') {\n                el = createSep();\n            } else if (item.children) {\n                el = createToolbarDropdown(item, self.options.toolbarTips, self.options.shortcuts, self);\n            } else {\n                el = createToolbarButton(item, true, self.options.toolbarTips, self.options.shortcuts, 'button', self);\n            }\n\n\n            toolbarData[item.name || item] = el;\n            bar.appendChild(el);\n\n            // Create the input element (ie. <input type='file'>), used among\n            // with the 'import-image' icon to open the browse-file window.\n            if (item.name === 'upload-image') {\n                var imageInput = document.createElement('input');\n                imageInput.className = 'imageInput';\n                imageInput.type = 'file';\n                imageInput.multiple = true;\n                imageInput.name = 'image';\n                imageInput.accept = self.options.imageAccept;\n                imageInput.style.display = 'none';\n                imageInput.style.opacity = 0;\n                bar.appendChild(imageInput);\n            }\n        })(items[i]);\n    }\n\n    self.toolbar_div = bar;\n    self.toolbarElements = toolbarData;\n\n    var cm = this.codemirror;\n    cm.on('cursorActivity', function () {\n        var stat = getState(cm);\n\n        for (var key in toolbarData) {\n            (function (key) {\n                var el = toolbarData[key];\n                if (stat[key]) {\n                    el.classList.add('active');\n                } else if (key != 'fullscreen' && key != 'side-by-side') {\n                    el.classList.remove('active');\n                }\n            })(key);\n        }\n    });\n\n    var cmWrapper = cm.getWrapperElement();\n    cmWrapper.parentNode.insertBefore(bar, cmWrapper);\n    return bar;\n};\n\nEasyMDE.prototype.createStatusbar = function (status) {\n    // Initialize\n    status = status || this.options.status;\n    var options = this.options;\n    var cm = this.codemirror;\n\n    // Make sure the status variable is valid\n    if (!status || status.length === 0) {\n        return;\n    }\n\n    // Set up the built-in items\n    var items = [];\n    var i, onUpdate, onActivity, defaultValue;\n\n    for (i = 0; i < status.length; i++) {\n        // Reset some values\n        onUpdate = undefined;\n        onActivity = undefined;\n        defaultValue = undefined;\n\n\n        // Handle if custom or not\n        if (typeof status[i] === 'object') {\n            items.push({\n                className: status[i].className,\n                defaultValue: status[i].defaultValue,\n                onUpdate: status[i].onUpdate,\n                onActivity: status[i].onActivity,\n            });\n        } else {\n            var name = status[i];\n\n            if (name === 'words') {\n                defaultValue = function (el) {\n                    el.innerHTML = wordCount(cm.getValue());\n                };\n                onUpdate = function (el) {\n                    el.innerHTML = wordCount(cm.getValue());\n                };\n            } else if (name === 'lines') {\n                defaultValue = function (el) {\n                    el.innerHTML = cm.lineCount();\n                };\n                onUpdate = function (el) {\n                    el.innerHTML = cm.lineCount();\n                };\n            } else if (name === 'cursor') {\n                defaultValue = function (el) {\n                    el.innerHTML = '1:1';\n                };\n                onActivity = function (el) {\n                    var pos = cm.getCursor();\n                    var posLine = pos.line + 1;\n                    var posColumn = pos.ch + 1;\n                    el.innerHTML = posLine + ':' + posColumn;\n                };\n            } else if (name === 'autosave') {\n                defaultValue = function (el) {\n                    if (options.autosave != undefined && options.autosave.enabled === true) {\n                        el.setAttribute('id', 'autosaved');\n                    }\n                };\n            } else if (name === 'upload-image') {\n                defaultValue = function (el) {\n                    el.innerHTML = options.imageTexts.sbInit;\n                };\n            }\n\n            items.push({\n                className: name,\n                defaultValue: defaultValue,\n                onUpdate: onUpdate,\n                onActivity: onActivity,\n            });\n        }\n    }\n\n\n    // Create element for the status bar\n    var bar = document.createElement('div');\n    bar.className = 'editor-statusbar';\n\n\n    // Create a new span for each item\n    for (i = 0; i < items.length; i++) {\n        // Store in temporary variable\n        var item = items[i];\n\n\n        // Create span element\n        var el = document.createElement('span');\n        el.className = item.className;\n\n\n        // Ensure the defaultValue is a function\n        if (typeof item.defaultValue === 'function') {\n            item.defaultValue(el);\n        }\n\n\n        // Ensure the onUpdate is a function\n        if (typeof item.onUpdate === 'function') {\n            // Create a closure around the span of the current action, then execute the onUpdate handler\n            this.codemirror.on('update', (function (el, item) {\n                return function () {\n                    item.onUpdate(el);\n                };\n            }(el, item)));\n        }\n        if (typeof item.onActivity === 'function') {\n            // Create a closure around the span of the current action, then execute the onActivity handler\n            this.codemirror.on('cursorActivity', (function (el, item) {\n                return function () {\n                    item.onActivity(el);\n                };\n            }(el, item)));\n        }\n\n\n        // Append the item to the status bar\n        bar.appendChild(el);\n    }\n\n\n    // Insert the status bar into the DOM\n    var cmWrapper = this.codemirror.getWrapperElement();\n    cmWrapper.parentNode.insertBefore(bar, cmWrapper.nextSibling);\n    return bar;\n};\n\n/**\n * Get or set the text content.\n */\nEasyMDE.prototype.value = function (val) {\n    var cm = this.codemirror;\n    if (val === undefined) {\n        return cm.getValue();\n    } else {\n        cm.getDoc().setValue(val);\n        if (this.isPreviewActive()) {\n            var wrapper = cm.getWrapperElement();\n            var preview = wrapper.lastChild;\n            var preview_result = this.options.previewRender(val, preview);\n            if (preview_result !== null) {\n                preview.innerHTML = preview_result;\n            }\n\n        }\n        return this;\n    }\n};\n\n\n/**\n * Bind static methods for exports.\n */\nEasyMDE.toggleBold = toggleBold;\nEasyMDE.toggleItalic = toggleItalic;\nEasyMDE.toggleStrikethrough = toggleStrikethrough;\nEasyMDE.toggleBlockquote = toggleBlockquote;\nEasyMDE.toggleHeadingSmaller = toggleHeadingSmaller;\nEasyMDE.toggleHeadingBigger = toggleHeadingBigger;\nEasyMDE.toggleHeading1 = toggleHeading1;\nEasyMDE.toggleHeading2 = toggleHeading2;\nEasyMDE.toggleHeading3 = toggleHeading3;\nEasyMDE.toggleHeading4 = toggleHeading4;\nEasyMDE.toggleHeading5 = toggleHeading5;\nEasyMDE.toggleHeading6 = toggleHeading6;\nEasyMDE.toggleCodeBlock = toggleCodeBlock;\nEasyMDE.toggleUnorderedList = toggleUnorderedList;\nEasyMDE.toggleOrderedList = toggleOrderedList;\nEasyMDE.cleanBlock = cleanBlock;\nEasyMDE.drawLink = drawLink;\nEasyMDE.drawImage = drawImage;\nEasyMDE.drawUploadedImage = drawUploadedImage;\nEasyMDE.drawTable = drawTable;\nEasyMDE.drawHorizontalRule = drawHorizontalRule;\nEasyMDE.undo = undo;\nEasyMDE.redo = redo;\nEasyMDE.togglePreview = togglePreview;\nEasyMDE.toggleSideBySide = toggleSideBySide;\nEasyMDE.toggleFullScreen = toggleFullScreen;\n\n/**\n * Bind instance methods for exports.\n */\nEasyMDE.prototype.toggleBold = function () {\n    toggleBold(this);\n};\nEasyMDE.prototype.toggleItalic = function () {\n    toggleItalic(this);\n};\nEasyMDE.prototype.toggleStrikethrough = function () {\n    toggleStrikethrough(this);\n};\nEasyMDE.prototype.toggleBlockquote = function () {\n    toggleBlockquote(this);\n};\nEasyMDE.prototype.toggleHeadingSmaller = function () {\n    toggleHeadingSmaller(this);\n};\nEasyMDE.prototype.toggleHeadingBigger = function () {\n    toggleHeadingBigger(this);\n};\nEasyMDE.prototype.toggleHeading1 = function () {\n    toggleHeading1(this);\n};\nEasyMDE.prototype.toggleHeading2 = function () {\n    toggleHeading2(this);\n};\nEasyMDE.prototype.toggleHeading3 = function () {\n    toggleHeading3(this);\n};\nEasyMDE.prototype.toggleHeading4 = function () {\n    toggleHeading4(this);\n};\nEasyMDE.prototype.toggleHeading5 = function () {\n    toggleHeading5(this);\n};\nEasyMDE.prototype.toggleHeading6 = function () {\n    toggleHeading6(this);\n};\nEasyMDE.prototype.toggleCodeBlock = function () {\n    toggleCodeBlock(this);\n};\nEasyMDE.prototype.toggleUnorderedList = function () {\n    toggleUnorderedList(this);\n};\nEasyMDE.prototype.toggleOrderedList = function () {\n    toggleOrderedList(this);\n};\nEasyMDE.prototype.cleanBlock = function () {\n    cleanBlock(this);\n};\nEasyMDE.prototype.drawLink = function () {\n    drawLink(this);\n};\nEasyMDE.prototype.drawImage = function () {\n    drawImage(this);\n};\nEasyMDE.prototype.drawUploadedImage = function () {\n    drawUploadedImage(this);\n};\nEasyMDE.prototype.drawTable = function () {\n    drawTable(this);\n};\nEasyMDE.prototype.drawHorizontalRule = function () {\n    drawHorizontalRule(this);\n};\nEasyMDE.prototype.undo = function () {\n    undo(this);\n};\nEasyMDE.prototype.redo = function () {\n    redo(this);\n};\nEasyMDE.prototype.togglePreview = function () {\n    togglePreview(this);\n};\nEasyMDE.prototype.toggleSideBySide = function () {\n    toggleSideBySide(this);\n};\nEasyMDE.prototype.toggleFullScreen = function () {\n    toggleFullScreen(this);\n};\n\nEasyMDE.prototype.isPreviewActive = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.lastChild;\n\n    return preview.classList.contains('editor-preview-active');\n};\n\nEasyMDE.prototype.isSideBySideActive = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var preview = wrapper.nextSibling;\n\n    return preview.classList.contains('editor-preview-active-side');\n};\n\nEasyMDE.prototype.isFullscreenActive = function () {\n    var cm = this.codemirror;\n\n    return cm.getOption('fullScreen');\n};\n\nEasyMDE.prototype.getState = function () {\n    var cm = this.codemirror;\n\n    return getState(cm);\n};\n\nEasyMDE.prototype.toTextArea = function () {\n    var cm = this.codemirror;\n    var wrapper = cm.getWrapperElement();\n    var easyMDEContainer = wrapper.parentNode;\n\n    if (easyMDEContainer) {\n        if (this.gui.toolbar) {\n            easyMDEContainer.removeChild(this.gui.toolbar);\n        }\n        if (this.gui.statusbar) {\n            easyMDEContainer.removeChild(this.gui.statusbar);\n        }\n        if (this.gui.sideBySide) {\n            easyMDEContainer.removeChild(this.gui.sideBySide);\n        }\n    }\n\n    // Unwrap easyMDEcontainer before codemirror toTextArea() call\n    easyMDEContainer.parentNode.insertBefore(wrapper, easyMDEContainer);\n    easyMDEContainer.remove();\n\n    cm.toTextArea();\n\n    if (this.autosaveTimeoutId) {\n        clearTimeout(this.autosaveTimeoutId);\n        this.autosaveTimeoutId = undefined;\n        this.clearAutosavedValue();\n    }\n};\n\nmodule.exports = EasyMDE;\n"],"mappings":"AAAA,YAAY;;AACZ,IAAIA,UAAU,GAAGC,OAAO,CAAC,YAAY,CAAC;AACtCA,OAAO,CAAC,uCAAuC,CAAC;AAChDA,OAAO,CAAC,sBAAsB,CAAC;AAC/BA,OAAO,CAAC,wCAAwC,CAAC;AACjDA,OAAO,CAAC,sCAAsC,CAAC;AAC/CA,OAAO,CAAC,kCAAkC,CAAC;AAC3CA,OAAO,CAAC,yCAAyC,CAAC;AAClDA,OAAO,CAAC,yCAAyC,CAAC;AAClDA,OAAO,CAAC,8CAA8C,CAAC;AACvDA,OAAO,CAAC,yCAAyC,CAAC;AAClDA,OAAO,CAAC,4BAA4B,CAAC;AACrCA,OAAO,CAAC,4BAA4B,CAAC;AACrC,IAAIC,sBAAsB,GAAGD,OAAO,CAAC,0BAA0B,CAAC;AAChE,IAAIE,MAAM,GAAGF,OAAO,CAAC,QAAQ,CAAC,CAACE,MAAM;;AAGrC;AACA,IAAIC,KAAK,GAAG,KAAK,CAACC,IAAI,CAACC,SAAS,CAACC,QAAQ,CAAC;AAC1C,IAAIC,qBAAqB,GAAG,IAAIC,MAAM,CAAC,+BAA+B,CAAC;;AAEvE;AACA,IAAIC,QAAQ,GAAG;EACX,YAAY,EAAEC,UAAU;EACxB,cAAc,EAAEC,YAAY;EAC5B,UAAU,EAAEC,QAAQ;EACpB,sBAAsB,EAAEC,oBAAoB;EAC5C,qBAAqB,EAAEC,mBAAmB;EAC1C,WAAW,EAAEC,SAAS;EACtB,kBAAkB,EAAEC,gBAAgB;EACpC,mBAAmB,EAAEC,iBAAiB;EACtC,qBAAqB,EAAEC,mBAAmB;EAC1C,iBAAiB,EAAEC,eAAe;EAClC,eAAe,EAAEC,aAAa;EAC9B,qBAAqB,EAAEC,mBAAmB;EAC1C,gBAAgB,EAAEC,cAAc;EAChC,gBAAgB,EAAEC,cAAc;EAChC,gBAAgB,EAAEC,cAAc;EAChC,gBAAgB,EAAEC,cAAc;EAChC,gBAAgB,EAAEC,cAAc;EAChC,gBAAgB,EAAEC,cAAc;EAChC,YAAY,EAAEC,UAAU;EACxB,WAAW,EAAEC,SAAS;EACtB,oBAAoB,EAAEC,kBAAkB;EACxC,MAAM,EAAEC,IAAI;EACZ,MAAM,EAAEC,IAAI;EACZ,kBAAkB,EAAEC,gBAAgB;EACpC,kBAAkB,EAAEC;AACxB,CAAC;AAED,IAAIC,SAAS,GAAG;EACZ,YAAY,EAAE,OAAO;EACrB,cAAc,EAAE,OAAO;EACvB,UAAU,EAAE,OAAO;EACnB,sBAAsB,EAAE,OAAO;EAC/B,qBAAqB,EAAE,aAAa;EACpC,gBAAgB,EAAE,YAAY;EAC9B,gBAAgB,EAAE,YAAY;EAC9B,gBAAgB,EAAE,YAAY;EAC9B,gBAAgB,EAAE,YAAY;EAC9B,gBAAgB,EAAE,YAAY;EAC9B,gBAAgB,EAAE,YAAY;EAC9B,YAAY,EAAE,OAAO;EACrB,WAAW,EAAE,WAAW;EACxB,kBAAkB,EAAE,QAAQ;EAC5B,mBAAmB,EAAE,WAAW;EAChC,qBAAqB,EAAE,OAAO;EAC9B,iBAAiB,EAAE,WAAW;EAC9B,eAAe,EAAE,OAAO;EACxB,kBAAkB,EAAE,IAAI;EACxB,kBAAkB,EAAE;AACxB,CAAC;AAED,IAAIC,cAAc,GAAG,SAAAA,CAAUC,CAAC,EAAE;EAC9B,KAAK,IAAIC,GAAG,IAAI7B,QAAQ,EAAE;IACtB,IAAIA,QAAQ,CAAC6B,GAAG,CAAC,KAAKD,CAAC,EAAE;MACrB,OAAOC,GAAG;IACd;EACJ;EACA,OAAO,IAAI;AACf,CAAC;AAED,IAAIC,QAAQ,GAAG,SAAAA,CAAA,EAAY;EACvB,IAAIC,KAAK,GAAG,KAAK;EACjB,CAAC,UAAUC,CAAC,EAAE;IACV,IAAI,qVAAqV,CAACrC,IAAI,CAACqC,CAAC,CAAC,IAAI,2hDAA2hD,CAACrC,IAAI,CAACqC,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAEF,KAAK,GAAG,IAAI;EACv6D,CAAC,EAAEnC,SAAS,CAACsC,SAAS,IAAItC,SAAS,CAACuC,MAAM,IAAIC,MAAM,CAACC,KAAK,CAAC;EAC3D,OAAON,KAAK;AAChB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,SAASO,oBAAoBA,CAACC,QAAQ,EAAE;EACpC,IAAIC,KAAK;EACT,OAAO,CAACA,KAAK,GAAG1C,qBAAqB,CAAC2C,IAAI,CAACF,QAAQ,CAAC,MAAM,IAAI,EAAE;IAC5D;IACA,IAAIG,UAAU,GAAGF,KAAK,CAAC,CAAC,CAAC;IAEzB,IAAIE,UAAU,CAACC,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;MACtC,IAAIC,eAAe,GAAGF,UAAU,CAACG,OAAO,CAAC,IAAI,EAAE,mBAAmB,CAAC;MACnEN,QAAQ,GAAGA,QAAQ,CAACM,OAAO,CAACH,UAAU,EAAEE,eAAe,CAAC;IAC5D;EACJ;EACA,OAAOL,QAAQ;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASO,2BAA2BA,CAACP,QAAQ,EAAE;EAE3C,IAAIQ,MAAM,GAAG,IAAIC,SAAS,CAAC,CAAC;EAC5B,IAAIC,OAAO,GAAGF,MAAM,CAACG,eAAe,CAACX,QAAQ,EAAE,WAAW,CAAC;EAC3D,IAAIY,SAAS,GAAGF,OAAO,CAACG,oBAAoB,CAAC,IAAI,CAAC;EAElD,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,SAAS,CAACG,MAAM,EAAED,CAAC,EAAE,EAAE;IACvC,IAAIE,QAAQ,GAAGJ,SAAS,CAACE,CAAC,CAAC;IAE3B,KAAK,IAAIG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,QAAQ,CAACE,QAAQ,CAACH,MAAM,EAAEE,CAAC,EAAE,EAAE;MAC/C,IAAIE,aAAa,GAAGH,QAAQ,CAACE,QAAQ,CAACD,CAAC,CAAC;MAExC,IAAIE,aAAa,YAAYC,gBAAgB,IAAID,aAAa,CAACE,IAAI,KAAK,UAAU,EAAE;QAChF;QACAL,QAAQ,CAACM,KAAK,CAACC,UAAU,GAAG,QAAQ;QACpCP,QAAQ,CAACM,KAAK,CAACE,aAAa,GAAG,MAAM;MACzC;IACJ;EACJ;EAEA,OAAOd,OAAO,CAACe,eAAe,CAACC,SAAS;AAC5C;;AAEA;AACA;AACA;AACA,SAASC,WAAWA,CAACC,IAAI,EAAE;EACvB,IAAIzE,KAAK,EAAE;IACPyE,IAAI,GAAGA,IAAI,CAACtB,OAAO,CAAC,MAAM,EAAE,KAAK,CAAC;EACtC,CAAC,MAAM;IACHsB,IAAI,GAAGA,IAAI,CAACtB,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC;EACtC;EACA,OAAOsB,IAAI;AACf;;AAEA;AACA;AACA;AACA,SAASC,qBAAqBA,CAACC,OAAO,EAAEC,cAAc,EAAE5C,SAAS,EAAE6C,MAAM,EAAE;EACvE,IAAIC,EAAE,GAAGC,mBAAmB,CAACJ,OAAO,EAAE,KAAK,EAAEC,cAAc,EAAE5C,SAAS,EAAE,QAAQ,EAAE6C,MAAM,CAAC;EACzFC,EAAE,CAACE,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;EAEpCH,EAAE,CAACI,OAAO,GAAG,YAAY;IACrBJ,EAAE,CAACK,KAAK,CAAC,CAAC;EACd,CAAC;EAED,IAAIC,OAAO,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;EAC3CF,OAAO,CAACG,SAAS,GAAG,0BAA0B;EAC9C,KAAK,IAAIC,aAAa,GAAG,CAAC,EAAEA,aAAa,GAAGb,OAAO,CAACZ,QAAQ,CAACH,MAAM,EAAE4B,aAAa,EAAE,EAAE;IAElF,IAAIC,KAAK,GAAGd,OAAO,CAACZ,QAAQ,CAACyB,aAAa,CAAC;IAC3C,IAAIE,YAAY;IAEhB,IAAI,OAAOD,KAAK,KAAK,QAAQ,IAAIA,KAAK,IAAIE,qBAAqB,EAAE;MAC7DD,YAAY,GAAGX,mBAAmB,CAACY,qBAAqB,CAACF,KAAK,CAAC,EAAE,IAAI,EAAEb,cAAc,EAAE5C,SAAS,EAAE,QAAQ,EAAE6C,MAAM,CAAC;IACvH,CAAC,MAAM;MACHa,YAAY,GAAGX,mBAAmB,CAACU,KAAK,EAAE,IAAI,EAAEb,cAAc,EAAE5C,SAAS,EAAE,QAAQ,EAAE6C,MAAM,CAAC;IAChG;IAEAa,YAAY,CAACE,gBAAgB,CAAC,OAAO,EAAE,UAAUC,CAAC,EAAE;MAAEA,CAAC,CAACC,eAAe,CAAC,CAAC;IAAE,CAAC,EAAE,KAAK,CAAC;IACpFV,OAAO,CAACW,WAAW,CAACL,YAAY,CAAC;EACrC;EACAZ,EAAE,CAACiB,WAAW,CAACX,OAAO,CAAC;EACvB,OAAON,EAAE;AACb;;AAEA;AACA;AACA;AACA,SAASC,mBAAmBA,CAACJ,OAAO,EAAEqB,aAAa,EAAEpB,cAAc,EAAE5C,SAAS,EAAEiE,MAAM,EAAEpB,MAAM,EAAE;EAC5FF,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;EACvB,IAAIG,EAAE,GAAGO,QAAQ,CAACC,aAAa,CAACW,MAAM,CAAC;;EAEvC;EACA,IAAItB,OAAO,CAACuB,UAAU,EAAE;IACpB,KAAK,IAAIC,SAAS,IAAIxB,OAAO,CAACuB,UAAU,EAAE;MACtC,IAAIE,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAAC5B,OAAO,CAACuB,UAAU,EAAEC,SAAS,CAAC,EAAE;QACrErB,EAAE,CAAC0B,YAAY,CAACL,SAAS,EAAExB,OAAO,CAACuB,UAAU,CAACC,SAAS,CAAC,CAAC;MAC7D;IACJ;EACJ;EAEA,IAAIM,eAAe,GAAG5B,MAAM,CAACF,OAAO,CAAC+B,wBAAwB,GAAG7B,MAAM,CAACF,OAAO,CAAC+B,wBAAwB,GAAG,GAAG,GAAG,EAAE;EAClH5B,EAAE,CAACS,SAAS,GAAGkB,eAAe,GAAG9B,OAAO,CAACF,IAAI;EAC7CK,EAAE,CAAC0B,YAAY,CAAC,MAAM,EAAEP,MAAM,CAAC;EAC/BrB,cAAc,GAAIA,cAAc,IAAI+B,SAAS,GAAI,IAAI,GAAG/B,cAAc;EAEtE,IAAID,OAAO,CAACiC,IAAI,EAAE;IACd9B,EAAE,CAAC+B,SAAS,GAAGlC,OAAO,CAACiC,IAAI;EAC/B;;EAEA;EACA,IAAIjC,OAAO,CAACF,IAAI,IAAIE,OAAO,CAACF,IAAI,IAAIzC,SAAS,EAAE;IAC3C1B,QAAQ,CAACqE,OAAO,CAACF,IAAI,CAAC,GAAGE,OAAO,CAACmC,MAAM;EAC3C;EAEA,IAAInC,OAAO,CAACoC,KAAK,IAAInC,cAAc,EAAE;IACjCE,EAAE,CAACiC,KAAK,GAAGC,aAAa,CAACrC,OAAO,CAACoC,KAAK,EAAEpC,OAAO,CAACmC,MAAM,EAAE9E,SAAS,CAAC;IAElE,IAAIhC,KAAK,EAAE;MACP8E,EAAE,CAACiC,KAAK,GAAGjC,EAAE,CAACiC,KAAK,CAAC5D,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;MACxC2B,EAAE,CAACiC,KAAK,GAAGjC,EAAE,CAACiC,KAAK,CAAC5D,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;IAC3C;EACJ;EAEA,IAAIwB,OAAO,CAACoC,KAAK,EAAE;IACfjC,EAAE,CAAC0B,YAAY,CAAC,YAAY,EAAE7B,OAAO,CAACoC,KAAK,CAAC;EAChD;EAEA,IAAIpC,OAAO,CAACsC,SAAS,EAAE;IACnBnC,EAAE,CAACE,SAAS,CAACC,GAAG,CAAC,YAAY,CAAC;EAClC;EAEA,IAAIN,OAAO,CAACuC,QAAQ,EAAE;IAClBpC,EAAE,CAACE,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;EACjC;;EAEA;EACA,IAAIkC,cAAc,GAAG,EAAE;EACvB,IAAI,OAAOxC,OAAO,CAACY,SAAS,KAAK,WAAW,EAAE;IAC1C4B,cAAc,GAAGxC,OAAO,CAACY,SAAS,CAAC6B,KAAK,CAAC,GAAG,CAAC;EACjD;;EAEA;EACA,IAAIC,WAAW,GAAG,EAAE;EACpB,KAAK,IAAIC,cAAc,GAAG,CAAC,EAAEA,cAAc,GAAGH,cAAc,CAACvD,MAAM,EAAE0D,cAAc,EAAE,EAAE;IACnF,IAAIC,aAAa,GAAGJ,cAAc,CAACG,cAAc,CAAC;IAClD;IACA;IACA,IAAIC,aAAa,CAACzE,KAAK,CAAC,yBAAyB,CAAC,EAAE;MAChDuE,WAAW,CAACG,IAAI,CAACD,aAAa,CAAC;IACnC,CAAC,MAAM;MACHzC,EAAE,CAACE,SAAS,CAACC,GAAG,CAACsC,aAAa,CAAC;IACnC;EACJ;EAEAzC,EAAE,CAAC2C,QAAQ,GAAG,CAAC,CAAC;EAEhB,IAAIJ,WAAW,CAACzD,MAAM,GAAG,CAAC,EAAE;IACxB;IACA,IAAI8D,IAAI,GAAGrC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACtC,KAAK,IAAIqC,cAAc,GAAG,CAAC,EAAEA,cAAc,GAAGN,WAAW,CAACzD,MAAM,EAAE+D,cAAc,EAAE,EAAE;MAChF,IAAIC,SAAS,GAAGP,WAAW,CAACM,cAAc,CAAC;MAC3CD,IAAI,CAAC1C,SAAS,CAACC,GAAG,CAAC2C,SAAS,CAAC;IACjC;IACA9C,EAAE,CAACiB,WAAW,CAAC2B,IAAI,CAAC;EACxB;;EAEA;EACA,IAAI,OAAO/C,OAAO,CAAC+C,IAAI,KAAK,WAAW,EAAE;IACrC5C,EAAE,CAACP,SAAS,GAAGI,OAAO,CAAC+C,IAAI;EAC/B;EAEA,IAAI/C,OAAO,CAACmC,MAAM,IAAId,aAAa,EAAE;IACjC,IAAI,OAAOrB,OAAO,CAACmC,MAAM,KAAK,UAAU,EAAE;MACtChC,EAAE,CAACI,OAAO,GAAG,UAAUW,CAAC,EAAE;QACtBA,CAAC,CAACgC,cAAc,CAAC,CAAC;QAClBlD,OAAO,CAACmC,MAAM,CAACjC,MAAM,CAAC;MAC1B,CAAC;IACL,CAAC,MAAM,IAAI,OAAOF,OAAO,CAACmC,MAAM,KAAK,QAAQ,EAAE;MAC3ChC,EAAE,CAACI,OAAO,GAAG,UAAUW,CAAC,EAAE;QACtBA,CAAC,CAACgC,cAAc,CAAC,CAAC;QAClBnF,MAAM,CAACoF,IAAI,CAACnD,OAAO,CAACmC,MAAM,EAAE,QAAQ,CAAC;MACzC,CAAC;IACL;EACJ;EAEA,OAAOhC,EAAE;AACb;AAEA,SAASiD,SAASA,CAAA,EAAG;EACjB,IAAIjD,EAAE,GAAGO,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;EACpCR,EAAE,CAACS,SAAS,GAAG,WAAW;EAC1BT,EAAE,CAACP,SAAS,GAAG,GAAG;EAClB,OAAOO,EAAE;AACb;AAEA,SAASkC,aAAaA,CAACD,KAAK,EAAED,MAAM,EAAE9E,SAAS,EAAE;EAC7C,IAAIgG,UAAU;EACd,IAAIC,OAAO,GAAGlB,KAAK;EAEnB,IAAID,MAAM,EAAE;IACRkB,UAAU,GAAG/F,cAAc,CAAC6E,MAAM,CAAC;IACnC,IAAI9E,SAAS,CAACgG,UAAU,CAAC,EAAE;MACvBC,OAAO,IAAI,IAAI,GAAGzD,WAAW,CAACxC,SAAS,CAACgG,UAAU,CAAC,CAAC,GAAG,GAAG;IAC9D;EACJ;EAEA,OAAOC,OAAO;AAClB;;AAEA;AACA;AACA;AACA,SAASC,QAAQA,CAACC,EAAE,EAAEC,GAAG,EAAE;EACvBA,GAAG,GAAGA,GAAG,IAAID,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC;EAClC,IAAIC,IAAI,GAAGH,EAAE,CAACI,UAAU,CAACH,GAAG,CAAC;EAC7B,IAAI,CAACE,IAAI,CAACpE,IAAI,EAAE,OAAO,CAAC,CAAC;EAEzB,IAAIsE,KAAK,GAAGF,IAAI,CAACpE,IAAI,CAACkD,KAAK,CAAC,GAAG,CAAC;EAEhC,IAAIqB,GAAG,GAAG,CAAC,CAAC;IACRC,IAAI;IAAE9B,IAAI;EACd,KAAK,IAAIjD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG6E,KAAK,CAAC5E,MAAM,EAAED,CAAC,EAAE,EAAE;IACnC+E,IAAI,GAAGF,KAAK,CAAC7E,CAAC,CAAC;IACf,IAAI+E,IAAI,KAAK,QAAQ,EAAE;MACnBD,GAAG,CAACE,IAAI,GAAG,IAAI;IACnB,CAAC,MAAM,IAAID,IAAI,KAAK,YAAY,EAAE;MAC9B9B,IAAI,GAAGuB,EAAE,CAACS,OAAO,CAACR,GAAG,CAACS,IAAI,CAAC;MAC3B,IAAI,aAAa,CAAC5I,IAAI,CAAC2G,IAAI,CAAC,EAAE;QAC1B6B,GAAG,CAAC,cAAc,CAAC,GAAG,IAAI;MAC9B,CAAC,MAAM;QACHA,GAAG,CAAC,gBAAgB,CAAC,GAAG,IAAI;MAChC;IACJ,CAAC,MAAM,IAAIC,IAAI,KAAK,MAAM,EAAE;MACxBD,GAAG,CAACK,KAAK,GAAG,IAAI;IACpB,CAAC,MAAM,IAAIJ,IAAI,KAAK,IAAI,EAAE;MACtBD,GAAG,CAACM,MAAM,GAAG,IAAI;IACrB,CAAC,MAAM,IAAIL,IAAI,KAAK,OAAO,EAAE;MACzBD,GAAG,CAACK,KAAK,GAAG,IAAI;IACpB,CAAC,MAAM,IAAIJ,IAAI,KAAK,eAAe,EAAE;MACjCD,GAAG,CAACO,aAAa,GAAG,IAAI;IAC5B,CAAC,MAAM,IAAIN,IAAI,KAAK,SAAS,EAAE;MAC3BD,GAAG,CAACQ,IAAI,GAAG,IAAI;IACnB,CAAC,MAAM,IAAIP,IAAI,KAAK,MAAM,IAAI,CAACD,GAAG,CAACS,KAAK,EAAE;MACtCT,GAAG,CAACU,IAAI,GAAG,IAAI;IACnB,CAAC,MAAM,IAAIT,IAAI,KAAK,OAAO,EAAE;MACzBD,GAAG,CAACS,KAAK,GAAG,IAAI;IACpB,CAAC,MAAM,IAAIR,IAAI,CAAC5F,KAAK,CAAC,mBAAmB,CAAC,EAAE;MACxC2F,GAAG,CAACC,IAAI,CAACvF,OAAO,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC,GAAG,IAAI;IACjD;EACJ;EACA,OAAOsF,GAAG;AACd;;AAGA;AACA,IAAIW,cAAc,GAAG,EAAE;;AAEvB;AACA;AACA;AACA;AACA,SAASrH,gBAAgBA,CAACsH,MAAM,EAAE;EAC9B;EACA,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1BnB,EAAE,CAACoB,SAAS,CAAC,YAAY,EAAE,CAACpB,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC,CAAC;;EAGvD;EACA,IAAIrB,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC,EAAE;IAC5BJ,cAAc,GAAG/D,QAAQ,CAACoE,IAAI,CAACtF,KAAK,CAACuF,QAAQ;IAC7CrE,QAAQ,CAACoE,IAAI,CAACtF,KAAK,CAACuF,QAAQ,GAAG,QAAQ;EAC3C,CAAC,MAAM;IACHrE,QAAQ,CAACoE,IAAI,CAACtF,KAAK,CAACuF,QAAQ,GAAGN,cAAc;EACjD;EAEA,IAAIO,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIC,UAAU,GAAGF,OAAO,CAACG,WAAW;EAEpC,IAAID,UAAU,CAAC7E,SAAS,CAAC+E,QAAQ,CAAC,4BAA4B,CAAC,EAAE;IAC7D,IAAIV,MAAM,CAAC1E,OAAO,CAACqF,oBAAoB,KAAK,KAAK,EAAE;MAC/C;MACA,IAAIC,gBAAgB,GAAGN,OAAO,CAACO,UAAU;MACzC,IAAI/B,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC,EAAE;QAC5BS,gBAAgB,CAACjF,SAAS,CAACmF,MAAM,CAAC,sBAAsB,CAAC;MAC7D,CAAC,MAAM;QACHF,gBAAgB,CAACjF,SAAS,CAACC,GAAG,CAAC,sBAAsB,CAAC;MAC1D;IACJ,CAAC,MAAM;MACHnD,gBAAgB,CAACuH,MAAM,CAAC;IAC5B;EACJ;EAEA,IAAIA,MAAM,CAAC1E,OAAO,CAACyF,kBAAkB,EAAE;IACnCf,MAAM,CAAC1E,OAAO,CAACyF,kBAAkB,CAACjC,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC,IAAI,KAAK,CAAC;EAC1E;;EAEA;EACA,IAAI,OAAOH,MAAM,CAAC1E,OAAO,CAAC0F,SAAS,KAAK,WAAW,EAAE;IACjD,IAAIlC,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC,EAAE;MAC5BrB,EAAE,CAACmC,kBAAkB,CAAC,CAAC,CAACnG,KAAK,CAACoG,cAAc,CAAC,QAAQ,CAAC;MACtDV,UAAU,CAAC1F,KAAK,CAACoG,cAAc,CAAC,QAAQ,CAAC;IAC7C,CAAC,MAAM;MACHpC,EAAE,CAACmC,kBAAkB,CAAC,CAAC,CAACnG,KAAK,CAACqG,MAAM,GAAGnB,MAAM,CAAC1E,OAAO,CAAC0F,SAAS;MAC/DhB,MAAM,CAACoB,mBAAmB,CAAC,CAAC;IAChC;EACJ;;EAEA;EACApB,MAAM,CAACqB,WAAW,CAAC1F,SAAS,CAAC2F,MAAM,CAAC,YAAY,CAAC;;EAEjD;EACA,IAAItB,MAAM,CAACuB,eAAe,IAAIvB,MAAM,CAACuB,eAAe,CAACC,UAAU,EAAE;IAC7D,IAAIC,aAAa,GAAGzB,MAAM,CAACuB,eAAe,CAACC,UAAU;IACrDC,aAAa,CAAC9F,SAAS,CAAC2F,MAAM,CAAC,QAAQ,CAAC;EAC5C;AACJ;;AAGA;AACA;AACA;AACA;AACA,SAASpK,UAAUA,CAAC8I,MAAM,EAAE;EACxB0B,YAAY,CAAC1B,MAAM,EAAE,MAAM,EAAEA,MAAM,CAAC1E,OAAO,CAACqG,WAAW,CAACrC,IAAI,CAAC;AACjE;;AAGA;AACA;AACA;AACA;AACA,SAASnI,YAAYA,CAAC6I,MAAM,EAAE;EAC1B0B,YAAY,CAAC1B,MAAM,EAAE,QAAQ,EAAEA,MAAM,CAAC1E,OAAO,CAACqG,WAAW,CAACjC,MAAM,CAAC;AACrE;;AAGA;AACA;AACA;AACA;AACA,SAAS7H,mBAAmBA,CAACmI,MAAM,EAAE;EACjC0B,YAAY,CAAC1B,MAAM,EAAE,eAAe,EAAE,IAAI,CAAC;AAC/C;;AAEA;AACA;AACA;AACA;AACA,SAASrI,eAAeA,CAACqI,MAAM,EAAE;EAC7B,IAAI4B,kBAAkB,GAAG5B,MAAM,CAAC1E,OAAO,CAACqG,WAAW,CAAC/B,IAAI;EAExD,SAASiC,YAAYA,CAACrC,IAAI,EAAE;IACxB;IACA,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;MAC1B,MAAM,kFAAkF,GAAG,OAAOA,IAAI,GAAG,IAAI,GAAGA,IAAI;IACxH;IACA,OAAOA,IAAI,CAACsC,MAAM,IAAItC,IAAI,CAACsC,MAAM,CAAC,CAAC,CAAC,IAAItC,IAAI,CAACsC,MAAM,CAAC,CAAC,CAAC,CAAClI,OAAO,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;EAClG;EAEA,SAASmI,WAAWA,CAACC,KAAK,EAAE;IACxB;IACA,OAAOA,KAAK,CAACC,KAAK,CAACC,IAAI,CAACA,IAAI,IAAIF,KAAK,CAACC,KAAK,CAACC,IAAI;EACpD;EAEA,SAASC,SAASA,CAACrD,EAAE,EAAEsD,QAAQ,EAAE5C,IAAI,EAAE6C,QAAQ,EAAEC,OAAO,EAAE;IACtD;AACR;AACA;AACA;AACA;AACA;IACQ9C,IAAI,GAAGA,IAAI,IAAIV,EAAE,CAACyD,aAAa,CAACH,QAAQ,CAAC;IACzCC,QAAQ,GAAGA,QAAQ,IAAIvD,EAAE,CAACI,UAAU,CAAC;MACjCM,IAAI,EAAE4C,QAAQ;MACdI,EAAE,EAAE;IACR,CAAC,CAAC;IACFF,OAAO,GAAGA,OAAO,IAAK,CAAC,CAAC9C,IAAI,CAACjC,IAAI,IAAIuB,EAAE,CAACI,UAAU,CAAC;MAC/CM,IAAI,EAAE4C,QAAQ;MACdI,EAAE,EAAEhD,IAAI,CAACjC,IAAI,CAAChD,MAAM,GAAG;IAC3B,CAAC,CAAE;IACH,IAAI4E,KAAK,GAAGkD,QAAQ,CAACxH,IAAI,GAAGwH,QAAQ,CAACxH,IAAI,CAACkD,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE;IACzD,IAAIuE,OAAO,IAAIP,WAAW,CAACO,OAAO,CAAC,CAACG,YAAY,EAAE;MAC9C;MACA,OAAO,UAAU;IACrB,CAAC,MAAM,IAAItD,KAAK,CAACvF,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;MACxC;MACA,OAAO,KAAK;IAChB,CAAC,MAAM,IAAImI,WAAW,CAACM,QAAQ,CAAC,CAACK,WAAW,IAAIX,WAAW,CAACO,OAAO,CAAC,CAACI,WAAW,IAAIb,YAAY,CAACrC,IAAI,CAAC,EAAE;MACpG,OAAO,QAAQ;IACnB,CAAC,MAAM;MACH,OAAO,QAAQ;IACnB;EACJ;EAEA,SAASmD,wBAAwBA,CAAC7D,EAAE,EAAE8D,SAAS,EAAEC,OAAO,EAAEjB,kBAAkB,EAAE;IAC1E,IAAIkB,cAAc,GAAGF,SAAS,CAACpD,IAAI,GAAG,CAAC;MACnCuD,YAAY,GAAGF,OAAO,CAACrD,IAAI,GAAG,CAAC;MAC/BwD,SAAS,GAAGJ,SAAS,CAACpD,IAAI,KAAKqD,OAAO,CAACrD,IAAI;MAC3CyD,UAAU,GAAGrB,kBAAkB,GAAG,IAAI;MACtCsB,QAAQ,GAAG,IAAI,GAAGtB,kBAAkB;IACxC,IAAIoB,SAAS,EAAE;MACXD,YAAY,EAAE;IAClB;IACA;IACA,IAAIC,SAAS,IAAIH,OAAO,CAACL,EAAE,KAAK,CAAC,EAAE;MAC/BU,QAAQ,GAAGtB,kBAAkB,GAAG,IAAI;MACpCmB,YAAY,EAAE;IAClB;IACAI,iBAAiB,CAACrE,EAAE,EAAE,KAAK,EAAE,CAACmE,UAAU,EAAEC,QAAQ,CAAC,CAAC;IACpDpE,EAAE,CAACsE,YAAY,CAAC;MACZ5D,IAAI,EAAEsD,cAAc;MACpBN,EAAE,EAAE;IACR,CAAC,EAAE;MACChD,IAAI,EAAEuD,YAAY;MAClBP,EAAE,EAAE;IACR,CAAC,CAAC;EACN;EAEA,IAAI1D,EAAE,GAAGkB,MAAM,CAACC,UAAU;IACtB2C,SAAS,GAAG9D,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC;IACjC6D,OAAO,GAAG/D,EAAE,CAACE,SAAS,CAAC,KAAK,CAAC;IAC7BqE,GAAG,GAAGvE,EAAE,CAACI,UAAU,CAAC;MAChBM,IAAI,EAAEoD,SAAS,CAACpD,IAAI;MACpBgD,EAAE,EAAEI,SAAS,CAACJ,EAAE,IAAI;IACxB,CAAC,CAAC;IAAE;IACJhD,IAAI,GAAGV,EAAE,CAACyD,aAAa,CAACK,SAAS,CAACpD,IAAI,CAAC;IACvC8D,OAAO,GAAGnB,SAAS,CAACrD,EAAE,EAAE8D,SAAS,CAACpD,IAAI,EAAEA,IAAI,EAAE6D,GAAG,CAAC;EACtD,IAAIE,WAAW,EAAEC,SAAS,EAAEC,SAAS;EAErC,IAAIH,OAAO,KAAK,QAAQ,EAAE;IACtB;IACA,IAAII,KAAK,GAAGlE,IAAI,CAACjC,IAAI,CAACoG,KAAK,CAAC,CAAC,EAAEf,SAAS,CAACJ,EAAE,CAAC,CAAC1I,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC;MACzD8J,GAAG,GAAGpE,IAAI,CAACjC,IAAI,CAACoG,KAAK,CAACf,SAAS,CAACJ,EAAE,CAAC,CAAC1I,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC;IACxDgF,EAAE,CAAC+E,YAAY,CAACH,KAAK,GAAGE,GAAG,EAAE;MACzBpE,IAAI,EAAEoD,SAAS,CAACpD,IAAI;MACpBgD,EAAE,EAAE;IACR,CAAC,EAAE;MACChD,IAAI,EAAEoD,SAAS,CAACpD,IAAI;MACpBgD,EAAE,EAAE;IACR,CAAC,CAAC;IACFI,SAAS,CAACJ,EAAE,EAAE;IACd,IAAII,SAAS,KAAKC,OAAO,EAAE;MACvBA,OAAO,CAACL,EAAE,EAAE;IAChB;IACA1D,EAAE,CAACsE,YAAY,CAACR,SAAS,EAAEC,OAAO,CAAC;IACnC/D,EAAE,CAAChD,KAAK,CAAC,CAAC;EACd,CAAC,MAAM,IAAIwH,OAAO,KAAK,QAAQ,EAAE;IAC7B,IAAIV,SAAS,CAACpD,IAAI,KAAKqD,OAAO,CAACrD,IAAI,IAAIoD,SAAS,CAACJ,EAAE,KAAKK,OAAO,CAACL,EAAE,EAAE;MAChE;;MAEA;MACA,KAAKe,WAAW,GAAGX,SAAS,CAACpD,IAAI,EAAE+D,WAAW,IAAI,CAAC,EAAEA,WAAW,EAAE,EAAE;QAChE/D,IAAI,GAAGV,EAAE,CAACyD,aAAa,CAACgB,WAAW,CAAC;QACpC,IAAI1B,YAAY,CAACrC,IAAI,CAAC,EAAE;UACpB;QACJ;MACJ;MACA,IAAIsE,SAAS,GAAGhF,EAAE,CAACI,UAAU,CAAC;QAC1BM,IAAI,EAAE+D,WAAW;QACjBf,EAAE,EAAE;MACR,CAAC,CAAC;MACF,IAAIuB,WAAW,GAAGhC,WAAW,CAAC+B,SAAS,CAAC,CAACpB,WAAW;MACpD,IAAIsB,UAAU,EAAEC,UAAU;MAC1B,IAAIC,QAAQ,EAAEC,QAAQ;MACtB;MACA,IAAItC,YAAY,CAAC/C,EAAE,CAACyD,aAAa,CAACK,SAAS,CAACpD,IAAI,CAAC,CAAC,EAAE;QAChDwE,UAAU,GAAG,EAAE;QACfC,UAAU,GAAGrB,SAAS,CAACpD,IAAI;MAC/B,CAAC,MAAM,IAAIqC,YAAY,CAAC/C,EAAE,CAACyD,aAAa,CAACK,SAAS,CAACpD,IAAI,GAAG,CAAC,CAAC,CAAC,EAAE;QAC3DwE,UAAU,GAAG,EAAE;QACfC,UAAU,GAAGrB,SAAS,CAACpD,IAAI,GAAG,CAAC;MACnC,CAAC,MAAM;QACHwE,UAAU,GAAGD,WAAW,GAAG,IAAI;QAC/BE,UAAU,GAAGrB,SAAS,CAACpD,IAAI;MAC/B;MACA,IAAIqC,YAAY,CAAC/C,EAAE,CAACyD,aAAa,CAACM,OAAO,CAACrD,IAAI,CAAC,CAAC,EAAE;QAC9C0E,QAAQ,GAAG,EAAE;QACbC,QAAQ,GAAGtB,OAAO,CAACrD,IAAI;QACvB,IAAIqD,OAAO,CAACL,EAAE,KAAK,CAAC,EAAE;UAClB2B,QAAQ,IAAI,CAAC;QACjB;MACJ,CAAC,MAAM,IAAItB,OAAO,CAACL,EAAE,KAAK,CAAC,IAAIX,YAAY,CAAC/C,EAAE,CAACyD,aAAa,CAACM,OAAO,CAACrD,IAAI,GAAG,CAAC,CAAC,CAAC,EAAE;QAC7E0E,QAAQ,GAAG,EAAE;QACbC,QAAQ,GAAGtB,OAAO,CAACrD,IAAI,GAAG,CAAC;MAC/B,CAAC,MAAM;QACH0E,QAAQ,GAAGH,WAAW,GAAG,IAAI;QAC7BI,QAAQ,GAAGtB,OAAO,CAACrD,IAAI,GAAG,CAAC;MAC/B;MACA,IAAIqD,OAAO,CAACL,EAAE,KAAK,CAAC,EAAE;QAClB;QACA2B,QAAQ,IAAI,CAAC;MACjB;MACArF,EAAE,CAACsF,SAAS,CAAC,YAAY;QACrB;QACAtF,EAAE,CAAC+E,YAAY,CAACK,QAAQ,EAAE;UACtB1E,IAAI,EAAE2E,QAAQ;UACd3B,EAAE,EAAE;QACR,CAAC,EAAE;UACChD,IAAI,EAAE2E,QAAQ,IAAID,QAAQ,GAAG,CAAC,GAAG,CAAC,CAAC;UACnC1B,EAAE,EAAE;QACR,CAAC,CAAC;QACF1D,EAAE,CAAC+E,YAAY,CAACG,UAAU,EAAE;UACxBxE,IAAI,EAAEyE,UAAU;UAChBzB,EAAE,EAAE;QACR,CAAC,EAAE;UACChD,IAAI,EAAEyE,UAAU,IAAID,UAAU,GAAG,CAAC,GAAG,CAAC,CAAC;UACvCxB,EAAE,EAAE;QACR,CAAC,CAAC;MACN,CAAC,CAAC;MACF1D,EAAE,CAACsE,YAAY,CAAC;QACZ5D,IAAI,EAAEyE,UAAU,IAAID,UAAU,GAAG,CAAC,GAAG,CAAC,CAAC;QACvCxB,EAAE,EAAE;MACR,CAAC,EAAE;QACChD,IAAI,EAAE2E,QAAQ,IAAIH,UAAU,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;QACtCxB,EAAE,EAAE;MACR,CAAC,CAAC;MACF1D,EAAE,CAAChD,KAAK,CAAC,CAAC;IACd,CAAC,MAAM;MACH;MACA,IAAIuI,WAAW,GAAGzB,SAAS,CAACpD,IAAI;MAChC,IAAIqC,YAAY,CAAC/C,EAAE,CAACyD,aAAa,CAACK,SAAS,CAACpD,IAAI,CAAC,CAAC,EAAE;QAAE;QAClD,IAAI2C,SAAS,CAACrD,EAAE,EAAE8D,SAAS,CAACpD,IAAI,GAAG,CAAC,CAAC,KAAK,QAAQ,EAAE;UAChD+D,WAAW,GAAGX,SAAS,CAACpD,IAAI;UAC5B6E,WAAW,GAAGzB,SAAS,CAACpD,IAAI,GAAG,CAAC,CAAC,CAAC;QACtC,CAAC,MAAM;UACHgE,SAAS,GAAGZ,SAAS,CAACpD,IAAI;UAC1B6E,WAAW,GAAGzB,SAAS,CAACpD,IAAI,GAAG,CAAC,CAAC,CAAC;QACtC;MACJ;;MACA,IAAI+D,WAAW,KAAKjG,SAAS,EAAE;QAC3B,KAAKiG,WAAW,GAAGc,WAAW,EAAEd,WAAW,IAAI,CAAC,EAAEA,WAAW,EAAE,EAAE;UAC7D/D,IAAI,GAAGV,EAAE,CAACyD,aAAa,CAACgB,WAAW,CAAC;UACpC,IAAI1B,YAAY,CAACrC,IAAI,CAAC,EAAE;YACpB;UACJ;QACJ;MACJ;MACA,IAAIgE,SAAS,KAAKlG,SAAS,EAAE;QACzBmG,SAAS,GAAG3E,EAAE,CAAC2E,SAAS,CAAC,CAAC;QAC1B,KAAKD,SAAS,GAAGa,WAAW,EAAEb,SAAS,GAAGC,SAAS,EAAED,SAAS,EAAE,EAAE;UAC9DhE,IAAI,GAAGV,EAAE,CAACyD,aAAa,CAACiB,SAAS,CAAC;UAClC,IAAI3B,YAAY,CAACrC,IAAI,CAAC,EAAE;YACpB;UACJ;QACJ;MACJ;MACAV,EAAE,CAACsF,SAAS,CAAC,YAAY;QACrBtF,EAAE,CAAC+E,YAAY,CAAC,EAAE,EAAE;UAChBrE,IAAI,EAAE+D,WAAW;UACjBf,EAAE,EAAE;QACR,CAAC,EAAE;UACChD,IAAI,EAAE+D,WAAW,GAAG,CAAC;UACrBf,EAAE,EAAE;QACR,CAAC,CAAC;QACF1D,EAAE,CAAC+E,YAAY,CAAC,EAAE,EAAE;UAChBrE,IAAI,EAAEgE,SAAS,GAAG,CAAC;UACnBhB,EAAE,EAAE;QACR,CAAC,EAAE;UACChD,IAAI,EAAEgE,SAAS;UACfhB,EAAE,EAAE;QACR,CAAC,CAAC;MACN,CAAC,CAAC;MACF1D,EAAE,CAAChD,KAAK,CAAC,CAAC;IACd;EACJ,CAAC,MAAM,IAAIwH,OAAO,KAAK,UAAU,EAAE;IAC/B,IAAIV,SAAS,CAACpD,IAAI,KAAKqD,OAAO,CAACrD,IAAI,IAAIoD,SAAS,CAACJ,EAAE,KAAKK,OAAO,CAACL,EAAE,EAAE;MAChE;MACAe,WAAW,GAAGX,SAAS,CAACpD,IAAI;MAC5BgE,SAAS,GAAGX,OAAO,CAACrD,IAAI;MACxB,IAAIqD,OAAO,CAACL,EAAE,KAAK,CAAC,EAAE;QAClBgB,SAAS,EAAE;MACf;IACJ,CAAC,MAAM;MACH;MACA,KAAKD,WAAW,GAAGX,SAAS,CAACpD,IAAI,EAAE+D,WAAW,IAAI,CAAC,EAAEA,WAAW,EAAE,EAAE;QAChE/D,IAAI,GAAGV,EAAE,CAACyD,aAAa,CAACgB,WAAW,CAAC;QACpC,IAAI/D,IAAI,CAACjC,IAAI,CAAC9D,KAAK,CAAC,OAAO,CAAC,EAAE;UAC1B;UACA;QACJ,CAAC,MAAM;UACH,IAAI0I,SAAS,CAACrD,EAAE,EAAEyE,WAAW,EAAE/D,IAAI,CAAC,KAAK,UAAU,EAAE;YACjD+D,WAAW,IAAI,CAAC;YAChB;UACJ;QACJ;MACJ;MACAE,SAAS,GAAG3E,EAAE,CAAC2E,SAAS,CAAC,CAAC;MAC1B,KAAKD,SAAS,GAAGZ,SAAS,CAACpD,IAAI,EAAEgE,SAAS,GAAGC,SAAS,EAAED,SAAS,EAAE,EAAE;QACjEhE,IAAI,GAAGV,EAAE,CAACyD,aAAa,CAACiB,SAAS,CAAC;QAClC,IAAIhE,IAAI,CAACjC,IAAI,CAAC9D,KAAK,CAAC,OAAO,CAAC,EAAE;UAC1B;UACA;QACJ,CAAC,MAAM;UACH,IAAI0I,SAAS,CAACrD,EAAE,EAAE0E,SAAS,EAAEhE,IAAI,CAAC,KAAK,UAAU,EAAE;YAC/CgE,SAAS,IAAI,CAAC;YACd;UACJ;QACJ;MACJ;IACJ;IACA;IACA;IACA,IAAIc,SAAS,GAAGxF,EAAE,CAACyD,aAAa,CAACiB,SAAS,GAAG,CAAC,CAAC;MAC3Ce,kBAAkB,GAAGD,SAAS,IAAIxF,EAAE,CAACI,UAAU,CAAC;QAC5CM,IAAI,EAAEgE,SAAS,GAAG,CAAC;QACnBhB,EAAE,EAAE8B,SAAS,CAAC/G,IAAI,CAAChD,MAAM,GAAG;MAChC,CAAC,CAAC;MACFiK,kBAAkB,GAAGD,kBAAkB,IAAIxC,WAAW,CAACwC,kBAAkB,CAAC,CAAC9B,YAAY;IAC3F,IAAI+B,kBAAkB,EAAE;MACpB1F,EAAE,CAAC+E,YAAY,CAAC,IAAI,EAAE;QAClBrE,IAAI,EAAEgE,SAAS,GAAG,CAAC;QACnBhB,EAAE,EAAE;MACR,CAAC,CAAC;IACN;IAEA,KAAK,IAAIlI,CAAC,GAAGiJ,WAAW,EAAEjJ,CAAC,IAAIkJ,SAAS,EAAElJ,CAAC,EAAE,EAAE;MAC3CwE,EAAE,CAAC2F,UAAU,CAACnK,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;IAClC;;IACAwE,EAAE,CAAChD,KAAK,CAAC,CAAC;EACd,CAAC,MAAM;IACH;IACA,IAAI4I,2BAA2B,GAAI9B,SAAS,CAACpD,IAAI,KAAKqD,OAAO,CAACrD,IAAI,IAAIoD,SAAS,CAACJ,EAAE,KAAKK,OAAO,CAACL,EAAE,IAAII,SAAS,CAACJ,EAAE,KAAK,CAAE;IACxH,IAAIQ,SAAS,GAAGJ,SAAS,CAACpD,IAAI,KAAKqD,OAAO,CAACrD,IAAI;IAC/C,IAAIkF,2BAA2B,IAAI1B,SAAS,EAAE;MAC1CL,wBAAwB,CAAC7D,EAAE,EAAE8D,SAAS,EAAEC,OAAO,EAAEjB,kBAAkB,CAAC;IACxE,CAAC,MAAM;MACHuB,iBAAiB,CAACrE,EAAE,EAAE,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;IAC5C;EACJ;AACJ;;AAEA;AACA;AACA;AACA,SAAStH,gBAAgBA,CAACwI,MAAM,EAAE;EAC9B2E,WAAW,CAAC3E,MAAM,CAACC,UAAU,EAAE,OAAO,CAAC;AAC3C;;AAEA;AACA;AACA;AACA,SAAS5I,oBAAoBA,CAAC2I,MAAM,EAAE;EAClC4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE,SAAS,CAAC;AAChD;;AAEA;AACA;AACA;AACA,SAAS3I,mBAAmBA,CAAC0I,MAAM,EAAE;EACjC4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE,QAAQ,CAAC;AAC/C;;AAEA;AACA;AACA;AACA,SAASnI,cAAcA,CAACkI,MAAM,EAAE;EAC5B4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE3C,SAAS,EAAE,CAAC,CAAC;AACnD;;AAEA;AACA;AACA;AACA,SAASvF,cAAcA,CAACiI,MAAM,EAAE;EAC5B4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE3C,SAAS,EAAE,CAAC,CAAC;AACnD;;AAEA;AACA;AACA;AACA,SAAStF,cAAcA,CAACgI,MAAM,EAAE;EAC5B4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE3C,SAAS,EAAE,CAAC,CAAC;AACnD;;AAEA;AACA;AACA;AACA,SAASrF,cAAcA,CAAC+H,MAAM,EAAE;EAC5B4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE3C,SAAS,EAAE,CAAC,CAAC;AACnD;;AAEA;AACA;AACA;AACA,SAASpF,cAAcA,CAAC8H,MAAM,EAAE;EAC5B4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE3C,SAAS,EAAE,CAAC,CAAC;AACnD;;AAEA;AACA;AACA;AACA,SAASnF,cAAcA,CAAC6H,MAAM,EAAE;EAC5B4E,cAAc,CAAC5E,MAAM,CAACC,UAAU,EAAE3C,SAAS,EAAE,CAAC,CAAC;AACnD;;AAGA;AACA;AACA;AACA,SAAS5F,mBAAmBA,CAACsI,MAAM,EAAE;EACjC,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAE1B,IAAI4E,SAAS,GAAG,GAAG,CAAC,CAAC;EACrB,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAACC,QAAQ,CAAC9E,MAAM,CAAC1E,OAAO,CAACyJ,kBAAkB,CAAC,EAAE;IAC7DF,SAAS,GAAG7E,MAAM,CAAC1E,OAAO,CAACyJ,kBAAkB;EACjD;EAEAJ,WAAW,CAAC7F,EAAE,EAAE,gBAAgB,EAAE+F,SAAS,CAAC;AAChD;;AAGA;AACA;AACA;AACA,SAASpN,iBAAiBA,CAACuI,MAAM,EAAE;EAC/B2E,WAAW,CAAC3E,MAAM,CAACC,UAAU,EAAE,cAAc,CAAC;AAClD;;AAEA;AACA;AACA;AACA,SAAS7H,UAAUA,CAAC4H,MAAM,EAAE;EACxBgF,WAAW,CAAChF,MAAM,CAACC,UAAU,CAAC;AAClC;;AAEA;AACA;AACA;AACA;AACA,SAAS7I,QAAQA,CAAC4I,MAAM,EAAE;EACtB,IAAI1E,OAAO,GAAG0E,MAAM,CAAC1E,OAAO;EAC5B,IAAI2J,GAAG,GAAG,UAAU;EACpB,IAAI3J,OAAO,CAAC4J,UAAU,EAAE;IACpB,IAAIC,MAAM,GAAGC,MAAM,CAAC9J,OAAO,CAAC+J,WAAW,CAACvF,IAAI,EAAEmF,GAAG,CAAC;IAClD,IAAI,CAACE,MAAM,EAAE;MACT,OAAO,KAAK;IAChB;IACAF,GAAG,GAAGK,eAAe,CAACH,MAAM,CAAC;EACjC;EACAI,WAAW,CAACvF,MAAM,EAAE,MAAM,EAAE1E,OAAO,CAACkK,WAAW,CAAC1F,IAAI,EAAEmF,GAAG,CAAC;AAC9D;;AAEA;AACA;AACA;AACA;AACA,SAAS1N,SAASA,CAACyI,MAAM,EAAE;EACvB,IAAI1E,OAAO,GAAG0E,MAAM,CAAC1E,OAAO;EAC5B,IAAI2J,GAAG,GAAG,UAAU;EACpB,IAAI3J,OAAO,CAAC4J,UAAU,EAAE;IACpB,IAAIC,MAAM,GAAGC,MAAM,CAAC9J,OAAO,CAAC+J,WAAW,CAACxF,KAAK,EAAEoF,GAAG,CAAC;IACnD,IAAI,CAACE,MAAM,EAAE;MACT,OAAO,KAAK;IAChB;IACAF,GAAG,GAAGK,eAAe,CAACH,MAAM,CAAC;EACjC;EACAI,WAAW,CAACvF,MAAM,EAAE,OAAO,EAAE1E,OAAO,CAACkK,WAAW,CAAC3F,KAAK,EAAEoF,GAAG,CAAC;AAChE;;AAEA;AACA;AACA;AACA;AACA,SAASK,eAAeA,CAACL,GAAG,EAAE;EAC1B,OAAOQ,SAAS,CAACR,GAAG,CAAC,CAACnL,OAAO,CAAC,WAAW,EAAE,MAAM,CAAC;AACtD;;AAEA;AACA;AACA;AACA;AACA,SAAS4L,iBAAiBA,CAAC1F,MAAM,EAAE;EAC/B;EACAA,MAAM,CAAC2F,oBAAoB,CAAC,CAAC;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASC,kBAAkBA,CAAC5F,MAAM,EAAEiF,GAAG,EAAE;EACrC,IAAInG,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1B,IAAIhB,IAAI,GAAGJ,QAAQ,CAACC,EAAE,CAAC;EACvB,IAAIxD,OAAO,GAAG0E,MAAM,CAAC1E,OAAO;EAC5B,IAAIuK,SAAS,GAAGZ,GAAG,CAAC/L,MAAM,CAAC+L,GAAG,CAACa,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EACpD,IAAIC,GAAG,GAAGF,SAAS,CAACG,SAAS,CAACH,SAAS,CAACC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAChM,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAACmM,WAAW,CAAC,CAAC;;EAEhG;EACA,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,CAACnB,QAAQ,CAACiB,GAAG,CAAC,EAAE;IAC5E5C,iBAAiB,CAACrE,EAAE,EAAEG,IAAI,CAACY,KAAK,EAAEvE,OAAO,CAACkK,WAAW,CAACU,aAAa,EAAEjB,GAAG,CAAC;EAC7E,CAAC,MAAM;IACH,IAAIkB,SAAS,GAAG7K,OAAO,CAACkK,WAAW,CAAC1F,IAAI;IACxCqG,SAAS,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGN,SAAS;IAC9B1C,iBAAiB,CAACrE,EAAE,EAAEG,IAAI,CAACa,IAAI,EAAEqG,SAAS,EAAElB,GAAG,CAAC;EACpD;;EAEA;EACAjF,MAAM,CAACoG,eAAe,CAAC,cAAc,EAAEpG,MAAM,CAAC1E,OAAO,CAAC+K,UAAU,CAACC,YAAY,CAACxM,OAAO,CAAC,cAAc,EAAE+L,SAAS,CAAC,CAAC;EACjHU,UAAU,CAAC,YAAY;IACnBvG,MAAM,CAACoG,eAAe,CAAC,cAAc,EAAEpG,MAAM,CAAC1E,OAAO,CAAC+K,UAAU,CAACG,MAAM,CAAC;EAC5E,CAAC,EAAE,IAAI,CAAC;AACZ;;AAEA;AACA;AACA;AACA;AACA,SAASnO,SAASA,CAAC2H,MAAM,EAAE;EACvB,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1B,IAAIhB,IAAI,GAAGJ,QAAQ,CAACC,EAAE,CAAC;EACvB,IAAIxD,OAAO,GAAG0E,MAAM,CAAC1E,OAAO;EAC5B6H,iBAAiB,CAACrE,EAAE,EAAEG,IAAI,CAACwH,KAAK,EAAEnL,OAAO,CAACkK,WAAW,CAACiB,KAAK,CAAC;AAChE;;AAEA;AACA;AACA;AACA;AACA,SAASnO,kBAAkBA,CAAC0H,MAAM,EAAE;EAChC,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1B,IAAIhB,IAAI,GAAGJ,QAAQ,CAACC,EAAE,CAAC;EACvB,IAAIxD,OAAO,GAAG0E,MAAM,CAAC1E,OAAO;EAC5B6H,iBAAiB,CAACrE,EAAE,EAAEG,IAAI,CAACY,KAAK,EAAEvE,OAAO,CAACkK,WAAW,CAACkB,cAAc,CAAC;AACzE;;AAGA;AACA;AACA;AACA;AACA,SAASnO,IAAIA,CAACyH,MAAM,EAAE;EAClB,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1BnB,EAAE,CAACvG,IAAI,CAAC,CAAC;EACTuG,EAAE,CAAChD,KAAK,CAAC,CAAC;AACd;;AAGA;AACA;AACA;AACA;AACA,SAAStD,IAAIA,CAACwH,MAAM,EAAE;EAClB,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1BnB,EAAE,CAACtG,IAAI,CAAC,CAAC;EACTsG,EAAE,CAAChD,KAAK,CAAC,CAAC;AACd;;AAGA;AACA;AACA;AACA;AACA,SAASrD,gBAAgBA,CAACuH,MAAM,EAAE;EAC9B,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1B,IAAIK,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIoG,OAAO,GAAGrG,OAAO,CAACG,WAAW;EACjC,IAAIgB,aAAa,GAAGzB,MAAM,CAACuB,eAAe,IAAIvB,MAAM,CAACuB,eAAe,CAAC,cAAc,CAAC;EACpF,IAAIqF,qBAAqB,GAAG,KAAK;EAEjC,IAAIhG,gBAAgB,GAAGN,OAAO,CAACO,UAAU;EAEzC,IAAI8F,OAAO,CAAChL,SAAS,CAAC+E,QAAQ,CAAC,4BAA4B,CAAC,EAAE;IAC1D,IAAIV,MAAM,CAAC1E,OAAO,CAACqF,oBAAoB,KAAK,KAAK,EAAE;MAC/C;MACAC,gBAAgB,CAACjF,SAAS,CAACmF,MAAM,CAAC,sBAAsB,CAAC;IAC7D;IACA6F,OAAO,CAAChL,SAAS,CAACmF,MAAM,CAAC,4BAA4B,CAAC;IACtD,IAAIW,aAAa,EAAEA,aAAa,CAAC9F,SAAS,CAACmF,MAAM,CAAC,QAAQ,CAAC;IAC3DR,OAAO,CAAC3E,SAAS,CAACmF,MAAM,CAAC,kBAAkB,CAAC;EAChD,CAAC,MAAM;IACH;IACA;IACA;IACAyF,UAAU,CAAC,YAAY;MACnB,IAAI,CAACzH,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC,EAAE;QAC7B,IAAIH,MAAM,CAAC1E,OAAO,CAACqF,oBAAoB,KAAK,KAAK,EAAE;UAC/C;UACAC,gBAAgB,CAACjF,SAAS,CAACC,GAAG,CAAC,sBAAsB,CAAC;QAC1D,CAAC,MAAM;UACHlD,gBAAgB,CAACsH,MAAM,CAAC;QAC5B;MACJ;MACA2G,OAAO,CAAChL,SAAS,CAACC,GAAG,CAAC,4BAA4B,CAAC;IACvD,CAAC,EAAE,CAAC,CAAC;IACL,IAAI6F,aAAa,EAAEA,aAAa,CAAC9F,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;IACxD0E,OAAO,CAAC3E,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;IACzCgL,qBAAqB,GAAG,IAAI;EAChC;;EAEA;EACA,IAAIC,aAAa,GAAGvG,OAAO,CAACwG,SAAS;EACrC,IAAID,aAAa,CAAClL,SAAS,CAAC+E,QAAQ,CAAC,uBAAuB,CAAC,EAAE;IAC3DmG,aAAa,CAAClL,SAAS,CAACmF,MAAM,CAAC,uBAAuB,CAAC;IACvD,IAAIiG,OAAO,GAAG/G,MAAM,CAACuB,eAAe,CAACoF,OAAO;IAC5C,IAAItF,WAAW,GAAGrB,MAAM,CAACqB,WAAW;IACpC0F,OAAO,CAACpL,SAAS,CAACmF,MAAM,CAAC,QAAQ,CAAC;IAClCO,WAAW,CAAC1F,SAAS,CAACmF,MAAM,CAAC,sBAAsB,CAAC;EACxD;EAEA,IAAIkG,2BAA2B,GAAG,SAAAA,CAAA,EAAY;IAC1C,IAAIC,QAAQ,GAAGjH,MAAM,CAAC1E,OAAO,CAAC4L,aAAa,CAAClH,MAAM,CAACmH,KAAK,CAAC,CAAC,EAAER,OAAO,CAAC;IACpE,IAAIM,QAAQ,IAAI,IAAI,EAAE;MAClBN,OAAO,CAACzL,SAAS,GAAG+L,QAAQ;IAChC;EACJ,CAAC;EAED,IAAI,CAACnI,EAAE,CAACkI,2BAA2B,EAAE;IACjClI,EAAE,CAACkI,2BAA2B,GAAGA,2BAA2B;EAChE;EAEA,IAAIJ,qBAAqB,EAAE;IACvB,IAAIK,QAAQ,GAAGjH,MAAM,CAAC1E,OAAO,CAAC4L,aAAa,CAAClH,MAAM,CAACmH,KAAK,CAAC,CAAC,EAAER,OAAO,CAAC;IACpE,IAAIM,QAAQ,IAAI,IAAI,EAAE;MAClBN,OAAO,CAACzL,SAAS,GAAG+L,QAAQ;IAChC;IACAnI,EAAE,CAACsI,EAAE,CAAC,QAAQ,EAAEtI,EAAE,CAACkI,2BAA2B,CAAC;EACnD,CAAC,MAAM;IACHlI,EAAE,CAACuI,GAAG,CAAC,QAAQ,EAAEvI,EAAE,CAACkI,2BAA2B,CAAC;EACpD;;EAEA;EACAlI,EAAE,CAACwI,OAAO,CAAC,CAAC;AAChB;;AAGA;AACA;AACA;AACA;AACA,SAAS1P,aAAaA,CAACoI,MAAM,EAAE;EAC3B,IAAIlB,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1B,IAAIK,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIc,WAAW,GAAGrB,MAAM,CAACqB,WAAW;EACpC,IAAI0F,OAAO,GAAG/G,MAAM,CAAC1E,OAAO,CAACyL,OAAO,GAAG/G,MAAM,CAACuB,eAAe,CAACoF,OAAO,GAAG,KAAK;EAC7E,IAAIA,OAAO,GAAGrG,OAAO,CAACwG,SAAS;;EAE/B;EACA,IAAItG,UAAU,GAAG1B,EAAE,CAACyB,iBAAiB,CAAC,CAAC,CAACE,WAAW;EACnD,IAAID,UAAU,CAAC7E,SAAS,CAAC+E,QAAQ,CAAC,4BAA4B,CAAC,EAC3DjI,gBAAgB,CAACuH,MAAM,CAAC;EAE5B,IAAI,CAAC2G,OAAO,IAAI,CAACA,OAAO,CAAChL,SAAS,CAAC+E,QAAQ,CAAC,qBAAqB,CAAC,EAAE;IAEhEiG,OAAO,GAAG3K,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACvC0K,OAAO,CAACzK,SAAS,GAAG,qBAAqB;IAEzC,IAAI8D,MAAM,CAAC1E,OAAO,CAACiM,YAAY,EAAE;MAE7B,IAAIC,KAAK,CAACC,OAAO,CAACzH,MAAM,CAAC1E,OAAO,CAACiM,YAAY,CAAC,EAAE;QAC5C,KAAK,IAAIjN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0F,MAAM,CAAC1E,OAAO,CAACiM,YAAY,CAAChN,MAAM,EAAED,CAAC,EAAE,EAAE;UACzDqM,OAAO,CAAChL,SAAS,CAACC,GAAG,CAACoE,MAAM,CAAC1E,OAAO,CAACiM,YAAY,CAACjN,CAAC,CAAC,CAAC;QACzD;MAEJ,CAAC,MAAM,IAAI,OAAO0F,MAAM,CAAC1E,OAAO,CAACiM,YAAY,KAAK,QAAQ,EAAE;QACxDZ,OAAO,CAAChL,SAAS,CAACC,GAAG,CAACoE,MAAM,CAAC1E,OAAO,CAACiM,YAAY,CAAC;MACtD;IACJ;IAEAjH,OAAO,CAAC5D,WAAW,CAACiK,OAAO,CAAC;EAChC;EAEA,IAAIA,OAAO,CAAChL,SAAS,CAAC+E,QAAQ,CAAC,uBAAuB,CAAC,EAAE;IACrDiG,OAAO,CAAChL,SAAS,CAACmF,MAAM,CAAC,uBAAuB,CAAC;IACjD,IAAIiG,OAAO,EAAE;MACTA,OAAO,CAACpL,SAAS,CAACmF,MAAM,CAAC,QAAQ,CAAC;MAClCO,WAAW,CAAC1F,SAAS,CAACmF,MAAM,CAAC,sBAAsB,CAAC;IACxD;EACJ,CAAC,MAAM;IACH;IACA;IACA;IACAyF,UAAU,CAAC,YAAY;MACnBI,OAAO,CAAChL,SAAS,CAACC,GAAG,CAAC,uBAAuB,CAAC;IAClD,CAAC,EAAE,CAAC,CAAC;IACL,IAAImL,OAAO,EAAE;MACTA,OAAO,CAACpL,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;MAC/ByF,WAAW,CAAC1F,SAAS,CAACC,GAAG,CAAC,sBAAsB,CAAC;IACrD;EACJ;EAEA,IAAI8L,cAAc,GAAG1H,MAAM,CAAC1E,OAAO,CAAC4L,aAAa,CAAClH,MAAM,CAACmH,KAAK,CAAC,CAAC,EAAER,OAAO,CAAC;EAC1E,IAAIe,cAAc,KAAK,IAAI,EAAE;IACzBf,OAAO,CAACzL,SAAS,GAAGwM,cAAc;EACtC;AAEJ;AAEA,SAASvE,iBAAiBA,CAACrE,EAAE,EAAE6I,MAAM,EAAEC,QAAQ,EAAE3C,GAAG,EAAE;EAClD,IAAInG,EAAE,CAACyB,iBAAiB,CAAC,CAAC,CAACuG,SAAS,CAACnL,SAAS,CAAC+E,QAAQ,CAAC,uBAAuB,CAAC,EAC5E;EAEJ,IAAInD,IAAI;EACR,IAAImG,KAAK,GAAGkE,QAAQ,CAAC,CAAC,CAAC;EACvB,IAAIhE,GAAG,GAAGgE,QAAQ,CAAC,CAAC,CAAC;EACrB,IAAIC,UAAU,GAAG,CAAC,CAAC;IACfC,QAAQ,GAAG,CAAC,CAAC;EACjB/K,MAAM,CAACgL,MAAM,CAACF,UAAU,EAAE/I,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC,CAAC;EAChDjC,MAAM,CAACgL,MAAM,CAACD,QAAQ,EAAEhJ,EAAE,CAACE,SAAS,CAAC,KAAK,CAAC,CAAC;EAC5C,IAAIiG,GAAG,EAAE;IACLvB,KAAK,GAAGA,KAAK,CAAC5J,OAAO,CAAC,OAAO,EAAEmL,GAAG,CAAC,CAAC,CAAE;IACtCrB,GAAG,GAAGA,GAAG,CAAC9J,OAAO,CAAC,OAAO,EAAEmL,GAAG,CAAC;EACnC;EACA,IAAI0C,MAAM,EAAE;IACRpK,IAAI,GAAGuB,EAAE,CAACS,OAAO,CAACsI,UAAU,CAACrI,IAAI,CAAC;IAClCkE,KAAK,GAAGnG,IAAI,CAACoG,KAAK,CAAC,CAAC,EAAEkE,UAAU,CAACrF,EAAE,CAAC;IACpCoB,GAAG,GAAGrG,IAAI,CAACoG,KAAK,CAACkE,UAAU,CAACrF,EAAE,CAAC;IAC/B1D,EAAE,CAAC+E,YAAY,CAACH,KAAK,GAAGE,GAAG,EAAE;MACzBpE,IAAI,EAAEqI,UAAU,CAACrI,IAAI;MACrBgD,EAAE,EAAE;IACR,CAAC,CAAC;EACN,CAAC,MAAM;IACHjF,IAAI,GAAGuB,EAAE,CAACkJ,YAAY,CAAC,CAAC;IACxBlJ,EAAE,CAACmJ,gBAAgB,CAACvE,KAAK,GAAGnG,IAAI,GAAGqG,GAAG,CAAC;IAEvCiE,UAAU,CAACrF,EAAE,IAAIkB,KAAK,CAACnJ,MAAM;IAC7B,IAAIsN,UAAU,KAAKC,QAAQ,EAAE;MACzBA,QAAQ,CAACtF,EAAE,IAAIkB,KAAK,CAACnJ,MAAM;IAC/B;EACJ;EACAuE,EAAE,CAACsE,YAAY,CAACyE,UAAU,EAAEC,QAAQ,CAAC;EACrChJ,EAAE,CAAChD,KAAK,CAAC,CAAC;AACd;AAGA,SAAS8I,cAAcA,CAAC9F,EAAE,EAAEoJ,SAAS,EAAEC,IAAI,EAAE;EACzC,IAAIrJ,EAAE,CAACyB,iBAAiB,CAAC,CAAC,CAACuG,SAAS,CAACnL,SAAS,CAAC+E,QAAQ,CAAC,uBAAuB,CAAC,EAC5E;EAEJ,IAAImH,UAAU,GAAG/I,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC;EACtC,IAAI8I,QAAQ,GAAGhJ,EAAE,CAACE,SAAS,CAAC,KAAK,CAAC;EAClC,KAAK,IAAI1E,CAAC,GAAGuN,UAAU,CAACrI,IAAI,EAAElF,CAAC,IAAIwN,QAAQ,CAACtI,IAAI,EAAElF,CAAC,EAAE,EAAE;IACnD,CAAC,UAAUA,CAAC,EAAE;MACV,IAAIiD,IAAI,GAAGuB,EAAE,CAACS,OAAO,CAACjF,CAAC,CAAC;MACxB,IAAI8N,gBAAgB,GAAG7K,IAAI,CAAC8K,MAAM,CAAC,MAAM,CAAC;MAE1C,IAAIH,SAAS,KAAK5K,SAAS,EAAE;QACzB,IAAI8K,gBAAgB,IAAI,CAAC,EAAE;UACvB,IAAIF,SAAS,IAAI,QAAQ,EAAE;YACvB3K,IAAI,GAAG,SAAS,GAAGA,IAAI;UAC3B,CAAC,MAAM;YACHA,IAAI,GAAG,IAAI,GAAGA,IAAI;UACtB;QACJ,CAAC,MAAM,IAAI6K,gBAAgB,IAAI,CAAC,IAAIF,SAAS,IAAI,SAAS,EAAE;UACxD3K,IAAI,GAAGA,IAAI,CAACrE,MAAM,CAAC,CAAC,CAAC;QACzB,CAAC,MAAM,IAAIkP,gBAAgB,IAAI,CAAC,IAAIF,SAAS,IAAI,QAAQ,EAAE;UACvD3K,IAAI,GAAGA,IAAI,CAACrE,MAAM,CAAC,CAAC,CAAC;QACzB,CAAC,MAAM;UACH,IAAIgP,SAAS,IAAI,QAAQ,EAAE;YACvB3K,IAAI,GAAGA,IAAI,CAACrE,MAAM,CAAC,CAAC,CAAC;UACzB,CAAC,MAAM;YACHqE,IAAI,GAAG,GAAG,GAAGA,IAAI;UACrB;QACJ;MACJ,CAAC,MAAM;QACH,IAAI6K,gBAAgB,IAAI,CAAC,EAAE;UACvB7K,IAAI,GAAG,GAAG,CAAC+K,MAAM,CAACH,IAAI,CAAC,GAAG,GAAG,GAAG5K,IAAI;QACxC,CAAC,MAAM,IAAI6K,gBAAgB,IAAID,IAAI,EAAE;UACjC5K,IAAI,GAAGA,IAAI,CAACrE,MAAM,CAACkP,gBAAgB,GAAG,CAAC,CAAC;QAC5C,CAAC,MAAM;UACH7K,IAAI,GAAG,GAAG,CAAC+K,MAAM,CAACH,IAAI,CAAC,GAAG,GAAG,GAAG5K,IAAI,CAACrE,MAAM,CAACkP,gBAAgB,GAAG,CAAC,CAAC;QACrE;MACJ;MAEAtJ,EAAE,CAAC+E,YAAY,CAACtG,IAAI,EAAE;QAClBiC,IAAI,EAAElF,CAAC;QACPkI,EAAE,EAAE;MACR,CAAC,EAAE;QACChD,IAAI,EAAElF,CAAC;QACPkI,EAAE,EAAE;MACR,CAAC,CAAC;IACN,CAAC,EAAElI,CAAC,CAAC;EACT;EACAwE,EAAE,CAAChD,KAAK,CAAC,CAAC;AACd;AAGA,SAAS6I,WAAWA,CAAC7F,EAAE,EAAE1D,IAAI,EAAEmN,SAAS,EAAE;EACtC,IAAIzJ,EAAE,CAACyB,iBAAiB,CAAC,CAAC,CAACuG,SAAS,CAACnL,SAAS,CAAC+E,QAAQ,CAAC,uBAAuB,CAAC,EAC5E;EAEJ,IAAI8H,UAAU,GAAG,4BAA4B;EAC7C,IAAIC,iBAAiB,GAAG,MAAM;EAE9B,IAAIxJ,IAAI,GAAGJ,QAAQ,CAACC,EAAE,CAAC;EACvB,IAAI+I,UAAU,GAAG/I,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC;EACtC,IAAI8I,QAAQ,GAAGhJ,EAAE,CAACE,SAAS,CAAC,KAAK,CAAC;EAClC,IAAI0J,IAAI,GAAG;IACP,OAAO,EAAE,YAAY;IACrB,gBAAgB,EAAEF,UAAU;IAC5B,cAAc,EAAEA;EACpB,CAAC;EAED,IAAIG,QAAQ,GAAG,SAAAA,CAAUvN,IAAI,EAAEd,CAAC,EAAE;IAC9B,IAAIsO,GAAG,GAAG;MACN,OAAO,EAAE,GAAG;MACZ,gBAAgB,EAAEL,SAAS;MAC3B,cAAc,EAAE;IACpB,CAAC;IAED,OAAOK,GAAG,CAACxN,IAAI,CAAC,CAACtB,OAAO,CAAC,KAAK,EAAEQ,CAAC,CAAC;EACtC,CAAC;EAED,IAAIuO,UAAU,GAAG,SAAAA,CAAUzN,IAAI,EAAE0N,IAAI,EAAE;IACnC,IAAIF,GAAG,GAAG;MACN,OAAO,EAAE,GAAG;MACZ,gBAAgB,EAAE,IAAI,GAAGL,SAAS;MAClC,cAAc,EAAE;IACpB,CAAC;IACD,IAAIQ,EAAE,GAAG,IAAI/R,MAAM,CAAC4R,GAAG,CAACxN,IAAI,CAAC,CAAC;IAE9B,OAAO0N,IAAI,IAAIC,EAAE,CAACnS,IAAI,CAACkS,IAAI,CAAC;EAChC,CAAC;EAED,IAAIE,OAAO,GAAG,SAAAA,CAAU5N,IAAI,EAAEmC,IAAI,EAAE0L,YAAY,EAAE;IAC9C,IAAIC,GAAG,GAAGV,UAAU,CAAC9O,IAAI,CAAC6D,IAAI,CAAC;IAC/B,IAAIuL,IAAI,GAAGH,QAAQ,CAACvN,IAAI,EAAEoE,IAAI,CAAC;IAC/B,IAAI0J,GAAG,KAAK,IAAI,EAAE;MACd,IAAIL,UAAU,CAACzN,IAAI,EAAE8N,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;QAC1BJ,IAAI,GAAG,EAAE;MACb;MACAvL,IAAI,GAAG2L,GAAG,CAAC,CAAC,CAAC,GAAGJ,IAAI,GAAGI,GAAG,CAAC,CAAC,CAAC,GAAG3L,IAAI,CAACzD,OAAO,CAAC2O,iBAAiB,EAAE,EAAE,CAAC,CAAC3O,OAAO,CAAC4O,IAAI,CAACtN,IAAI,CAAC,EAAE,IAAI,CAAC;IACjG,CAAC,MAAM,IAAI6N,YAAY,IAAI,KAAK,EAAE;MAC9B1L,IAAI,GAAGuL,IAAI,GAAG,GAAG,GAAGvL,IAAI;IAC5B;IACA,OAAOA,IAAI;EACf,CAAC;EAED,IAAIiC,IAAI,GAAG,CAAC;EACZ,KAAK,IAAIlF,CAAC,GAAGuN,UAAU,CAACrI,IAAI,EAAElF,CAAC,IAAIwN,QAAQ,CAACtI,IAAI,EAAElF,CAAC,EAAE,EAAE;IACnD,CAAC,UAAUA,CAAC,EAAE;MACV,IAAIiD,IAAI,GAAGuB,EAAE,CAACS,OAAO,CAACjF,CAAC,CAAC;MACxB,IAAI2E,IAAI,CAAC7D,IAAI,CAAC,EAAE;QACZmC,IAAI,GAAGA,IAAI,CAACzD,OAAO,CAAC4O,IAAI,CAACtN,IAAI,CAAC,EAAE,IAAI,CAAC;MACzC,CAAC,MAAM;QACH;QACA;QACA;QACA,IAAIA,IAAI,IAAI,gBAAgB,EAAE;UAC1BmC,IAAI,GAAGyL,OAAO,CAAC,cAAc,EAAEzL,IAAI,EAAE,IAAI,CAAC;QAC9C;QACAA,IAAI,GAAGyL,OAAO,CAAC5N,IAAI,EAAEmC,IAAI,EAAE,KAAK,CAAC;QACjCiC,IAAI,IAAI,CAAC;MACb;MACAV,EAAE,CAAC+E,YAAY,CAACtG,IAAI,EAAE;QAClBiC,IAAI,EAAElF,CAAC;QACPkI,EAAE,EAAE;MACR,CAAC,EAAE;QACChD,IAAI,EAAElF,CAAC;QACPkI,EAAE,EAAE;MACR,CAAC,CAAC;IACN,CAAC,EAAElI,CAAC,CAAC;EACT;EACAwE,EAAE,CAAChD,KAAK,CAAC,CAAC;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASyJ,WAAWA,CAACvF,MAAM,EAAEnF,IAAI,EAAE+M,QAAQ,EAAE3C,GAAG,EAAE;EAC9C,IAAI,CAACjF,MAAM,CAACC,UAAU,IAAID,MAAM,CAACmJ,eAAe,CAAC,CAAC,EAAE;IAChD;EACJ;EAEA,IAAIrK,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1B,IAAIhB,IAAI,GAAGJ,QAAQ,CAACC,EAAE,CAAC;EACvB,IAAI6I,MAAM,GAAG1I,IAAI,CAACpE,IAAI,CAAC;EACvB,IAAI,CAAC8M,MAAM,EAAE;IACTxE,iBAAiB,CAACrE,EAAE,EAAE6I,MAAM,EAAEC,QAAQ,EAAE3C,GAAG,CAAC;IAC5C;EACJ;EAEA,IAAI4C,UAAU,GAAG/I,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC;EACtC,IAAI8I,QAAQ,GAAGhJ,EAAE,CAACE,SAAS,CAAC,KAAK,CAAC;EAClC,IAAIzB,IAAI,GAAGuB,EAAE,CAACS,OAAO,CAACsI,UAAU,CAACrI,IAAI,CAAC;EACtC,IAAIkE,KAAK,GAAGnG,IAAI,CAACoG,KAAK,CAAC,CAAC,EAAEkE,UAAU,CAACrF,EAAE,CAAC;EACxC,IAAIoB,GAAG,GAAGrG,IAAI,CAACoG,KAAK,CAACkE,UAAU,CAACrF,EAAE,CAAC;EAEnC,IAAI3H,IAAI,IAAI,MAAM,EAAE;IAChB6I,KAAK,GAAGA,KAAK,CAAC5J,OAAO,CAAC,YAAY,EAAE,IAAI,CAAC;EAC7C,CAAC,MAAM,IAAIe,IAAI,IAAI,OAAO,EAAE;IACxB6I,KAAK,GAAGA,KAAK,CAAC5J,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC;EAC3C;EACA8J,GAAG,GAAGA,GAAG,CAAC9J,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;EAEjCgF,EAAE,CAAC+E,YAAY,CAACH,KAAK,GAAGE,GAAG,EAAE;IACzBpE,IAAI,EAAEqI,UAAU,CAACrI,IAAI;IACrBgD,EAAE,EAAE;EACR,CAAC,EAAE;IACChD,IAAI,EAAEqI,UAAU,CAACrI,IAAI;IACrBgD,EAAE,EAAE;EACR,CAAC,CAAC;EAEFqF,UAAU,CAACrF,EAAE,IAAIoF,QAAQ,CAAC,CAAC,CAAC,CAACrN,MAAM;EACnC,IAAIsN,UAAU,KAAKC,QAAQ,EAAE;IACzBA,QAAQ,CAACtF,EAAE,IAAIoF,QAAQ,CAAC,CAAC,CAAC,CAACrN,MAAM;EACrC;EACAuE,EAAE,CAACsE,YAAY,CAACyE,UAAU,EAAEC,QAAQ,CAAC;EACrChJ,EAAE,CAAChD,KAAK,CAAC,CAAC;AACd;;AAEA;AACA;AACA;AACA,SAAS4F,YAAYA,CAAC1B,MAAM,EAAEnF,IAAI,EAAEuO,WAAW,EAAEC,SAAS,EAAE;EACxD,IAAI,CAACrJ,MAAM,CAACC,UAAU,IAAID,MAAM,CAACmJ,eAAe,CAAC,CAAC,EAAE;IAChD;EACJ;EAEAE,SAAS,GAAI,OAAOA,SAAS,KAAK,WAAW,GAAID,WAAW,GAAGC,SAAS;EACxE,IAAIvK,EAAE,GAAGkB,MAAM,CAACC,UAAU;EAC1B,IAAIhB,IAAI,GAAGJ,QAAQ,CAACC,EAAE,CAAC;EAEvB,IAAIvB,IAAI;EACR,IAAImG,KAAK,GAAG0F,WAAW;EACvB,IAAIxF,GAAG,GAAGyF,SAAS;EAEnB,IAAIxB,UAAU,GAAG/I,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC;EACtC,IAAI8I,QAAQ,GAAGhJ,EAAE,CAACE,SAAS,CAAC,KAAK,CAAC;EAElC,IAAIC,IAAI,CAACpE,IAAI,CAAC,EAAE;IACZ0C,IAAI,GAAGuB,EAAE,CAACS,OAAO,CAACsI,UAAU,CAACrI,IAAI,CAAC;IAClCkE,KAAK,GAAGnG,IAAI,CAACoG,KAAK,CAAC,CAAC,EAAEkE,UAAU,CAACrF,EAAE,CAAC;IACpCoB,GAAG,GAAGrG,IAAI,CAACoG,KAAK,CAACkE,UAAU,CAACrF,EAAE,CAAC;IAC/B,IAAI3H,IAAI,IAAI,MAAM,EAAE;MAChB6I,KAAK,GAAGA,KAAK,CAAC5J,OAAO,CAAC,+BAA+B,EAAE,EAAE,CAAC;MAC1D8J,GAAG,GAAGA,GAAG,CAAC9J,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC;IACtC,CAAC,MAAM,IAAIe,IAAI,IAAI,QAAQ,EAAE;MACzB6I,KAAK,GAAGA,KAAK,CAAC5J,OAAO,CAAC,yBAAyB,EAAE,EAAE,CAAC;MACpD8J,GAAG,GAAGA,GAAG,CAAC9J,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;IACnC,CAAC,MAAM,IAAIe,IAAI,IAAI,eAAe,EAAE;MAChC6I,KAAK,GAAGA,KAAK,CAAC5J,OAAO,CAAC,+BAA+B,EAAE,EAAE,CAAC;MAC1D8J,GAAG,GAAGA,GAAG,CAAC9J,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC;IACtC;IACAgF,EAAE,CAAC+E,YAAY,CAACH,KAAK,GAAGE,GAAG,EAAE;MACzBpE,IAAI,EAAEqI,UAAU,CAACrI,IAAI;MACrBgD,EAAE,EAAE;IACR,CAAC,EAAE;MACChD,IAAI,EAAEqI,UAAU,CAACrI,IAAI;MACrBgD,EAAE,EAAE;IACR,CAAC,CAAC;IAEF,IAAI3H,IAAI,IAAI,MAAM,IAAIA,IAAI,IAAI,eAAe,EAAE;MAC3CgN,UAAU,CAACrF,EAAE,IAAI,CAAC;MAClB,IAAIqF,UAAU,KAAKC,QAAQ,EAAE;QACzBA,QAAQ,CAACtF,EAAE,IAAI,CAAC;MACpB;IACJ,CAAC,MAAM,IAAI3H,IAAI,IAAI,QAAQ,EAAE;MACzBgN,UAAU,CAACrF,EAAE,IAAI,CAAC;MAClB,IAAIqF,UAAU,KAAKC,QAAQ,EAAE;QACzBA,QAAQ,CAACtF,EAAE,IAAI,CAAC;MACpB;IACJ;EACJ,CAAC,MAAM;IACHjF,IAAI,GAAGuB,EAAE,CAACkJ,YAAY,CAAC,CAAC;IACxB,IAAInN,IAAI,IAAI,MAAM,EAAE;MAChB0C,IAAI,GAAGA,IAAI,CAACQ,KAAK,CAAC,IAAI,CAAC,CAACuL,IAAI,CAAC,EAAE,CAAC;MAChC/L,IAAI,GAAGA,IAAI,CAACQ,KAAK,CAAC,IAAI,CAAC,CAACuL,IAAI,CAAC,EAAE,CAAC;IACpC,CAAC,MAAM,IAAIzO,IAAI,IAAI,QAAQ,EAAE;MACzB0C,IAAI,GAAGA,IAAI,CAACQ,KAAK,CAAC,GAAG,CAAC,CAACuL,IAAI,CAAC,EAAE,CAAC;MAC/B/L,IAAI,GAAGA,IAAI,CAACQ,KAAK,CAAC,GAAG,CAAC,CAACuL,IAAI,CAAC,EAAE,CAAC;IACnC,CAAC,MAAM,IAAIzO,IAAI,IAAI,eAAe,EAAE;MAChC0C,IAAI,GAAGA,IAAI,CAACQ,KAAK,CAAC,IAAI,CAAC,CAACuL,IAAI,CAAC,EAAE,CAAC;IACpC;IACAxK,EAAE,CAACmJ,gBAAgB,CAACvE,KAAK,GAAGnG,IAAI,GAAGqG,GAAG,CAAC;IAEvCiE,UAAU,CAACrF,EAAE,IAAI4G,WAAW,CAAC7O,MAAM;IACnCuN,QAAQ,CAACtF,EAAE,GAAGqF,UAAU,CAACrF,EAAE,GAAGjF,IAAI,CAAChD,MAAM;EAC7C;EAEAuE,EAAE,CAACsE,YAAY,CAACyE,UAAU,EAAEC,QAAQ,CAAC;EACrChJ,EAAE,CAAChD,KAAK,CAAC,CAAC;AACd;AAEA,SAASkJ,WAAWA,CAAClG,EAAE,EAAE;EACrB,IAAIA,EAAE,CAACyB,iBAAiB,CAAC,CAAC,CAACuG,SAAS,CAACnL,SAAS,CAAC+E,QAAQ,CAAC,uBAAuB,CAAC,EAC5E;EAEJ,IAAImH,UAAU,GAAG/I,EAAE,CAACE,SAAS,CAAC,OAAO,CAAC;EACtC,IAAI8I,QAAQ,GAAGhJ,EAAE,CAACE,SAAS,CAAC,KAAK,CAAC;EAClC,IAAIzB,IAAI;EAER,KAAK,IAAIiC,IAAI,GAAGqI,UAAU,CAACrI,IAAI,EAAEA,IAAI,IAAIsI,QAAQ,CAACtI,IAAI,EAAEA,IAAI,EAAE,EAAE;IAC5DjC,IAAI,GAAGuB,EAAE,CAACS,OAAO,CAACC,IAAI,CAAC;IACvBjC,IAAI,GAAGA,IAAI,CAACzD,OAAO,CAAC,0CAA0C,EAAE,EAAE,CAAC;IAEnEgF,EAAE,CAAC+E,YAAY,CAACtG,IAAI,EAAE;MAClBiC,IAAI,EAAEA,IAAI;MACVgD,EAAE,EAAE;IACR,CAAC,EAAE;MACChD,IAAI,EAAEA,IAAI;MACVgD,EAAE,EAAE;IACR,CAAC,CAAC;EACN;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS+G,aAAaA,CAACC,KAAK,EAAEC,KAAK,EAAE;EACjC,IAAIC,IAAI,CAACC,GAAG,CAACH,KAAK,CAAC,GAAG,IAAI,EAAE;IACxB,OAAO,EAAE,GAAGA,KAAK,GAAGC,KAAK,CAAC,CAAC,CAAC;EAChC;EACA,IAAIG,CAAC,GAAG,CAAC;EACT,GAAG;IACCJ,KAAK,IAAI,IAAI;IACb,EAAEI,CAAC;EACP,CAAC,QAAQF,IAAI,CAACC,GAAG,CAACH,KAAK,CAAC,IAAI,IAAI,IAAII,CAAC,GAAGH,KAAK,CAAClP,MAAM;EACpD,OAAO,EAAE,GAAGiP,KAAK,CAACK,OAAO,CAAC,CAAC,CAAC,GAAGJ,KAAK,CAACG,CAAC,CAAC;AAC3C;;AAEA;AACA,SAASE,gBAAgBA,CAACC,MAAM,EAAEC,MAAM,EAAE;EACtC,KAAK,IAAIC,QAAQ,IAAID,MAAM,EAAE;IACzB,IAAIjN,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAAC8M,MAAM,EAAEC,QAAQ,CAAC,EAAE;MACxD,IAAID,MAAM,CAACC,QAAQ,CAAC,YAAYzC,KAAK,EAAE;QACnCuC,MAAM,CAACE,QAAQ,CAAC,GAAGD,MAAM,CAACC,QAAQ,CAAC,CAACC,MAAM,CAACH,MAAM,CAACE,QAAQ,CAAC,YAAYzC,KAAK,GAAGuC,MAAM,CAACE,QAAQ,CAAC,GAAG,EAAE,CAAC;MACzG,CAAC,MAAM,IACHD,MAAM,CAACC,QAAQ,CAAC,KAAK,IAAI,IACzB,OAAOD,MAAM,CAACC,QAAQ,CAAC,KAAK,QAAQ,IACpCD,MAAM,CAACC,QAAQ,CAAC,CAACE,WAAW,KAAKpN,MAAM,EACzC;QACEgN,MAAM,CAACE,QAAQ,CAAC,GAAGH,gBAAgB,CAACC,MAAM,CAACE,QAAQ,CAAC,IAAI,CAAC,CAAC,EAAED,MAAM,CAACC,QAAQ,CAAC,CAAC;MACjF,CAAC,MAAM;QACHF,MAAM,CAACE,QAAQ,CAAC,GAAGD,MAAM,CAACC,QAAQ,CAAC;MACvC;IACJ;EACJ;EAEA,OAAOF,MAAM;AACjB;;AAEA;AACA,SAASK,MAAMA,CAACL,MAAM,EAAE;EACpB,KAAK,IAAIzP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+P,SAAS,CAAC9P,MAAM,EAAED,CAAC,EAAE,EAAE;IACvCyP,MAAM,GAAGD,gBAAgB,CAACC,MAAM,EAAEM,SAAS,CAAC/P,CAAC,CAAC,CAAC;EACnD;EAEA,OAAOyP,MAAM;AACjB;;AAEA;AACA,SAASO,SAASA,CAACjL,IAAI,EAAE;EACrB,IAAIkL,OAAO,GAAG,4HAA4H;EAC1I,IAAIC,CAAC,GAAGnL,IAAI,CAAC5F,KAAK,CAAC8Q,OAAO,CAAC;EAC3B,IAAIE,KAAK,GAAG,CAAC;EACb,IAAID,CAAC,KAAK,IAAI,EAAE,OAAOC,KAAK;EAC5B,KAAK,IAAInQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkQ,CAAC,CAACjQ,MAAM,EAAED,CAAC,EAAE,EAAE;IAC/B,IAAIkQ,CAAC,CAAClQ,CAAC,CAAC,CAACoQ,UAAU,CAAC,CAAC,CAAC,IAAI,MAAM,EAAE;MAC9BD,KAAK,IAAID,CAAC,CAAClQ,CAAC,CAAC,CAACC,MAAM;IACxB,CAAC,MAAM;MACHkQ,KAAK,IAAI,CAAC;IACd;EACJ;EACA,OAAOA,KAAK;AAChB;AAEA,IAAIE,YAAY,GAAG;EACf,MAAM,EAAE,YAAY;EACpB,QAAQ,EAAE,cAAc;EACxB,eAAe,EAAE,qBAAqB;EACtC,SAAS,EAAE,yBAAyB;EACpC,iBAAiB,EAAE,wCAAwC;EAC3D,gBAAgB,EAAE,uCAAuC;EACzD,WAAW,EAAE,kCAAkC;EAC/C,WAAW,EAAE,kCAAkC;EAC/C,WAAW,EAAE,kCAAkC;EAC/C,MAAM,EAAE,YAAY;EACpB,OAAO,EAAE,kBAAkB;EAC3B,cAAc,EAAE,eAAe;EAC/B,gBAAgB,EAAE,eAAe;EACjC,aAAa,EAAE,cAAc;EAC7B,MAAM,EAAE,YAAY;EACpB,OAAO,EAAE,aAAa;EACtB,cAAc,EAAE,aAAa;EAC7B,OAAO,EAAE,aAAa;EACtB,iBAAiB,EAAE,aAAa;EAChC,SAAS,EAAE,WAAW;EACtB,cAAc,EAAE,eAAe;EAC/B,YAAY,EAAE,kBAAkB;EAChC,OAAO,EAAE,uBAAuB;EAChC,MAAM,EAAE,YAAY;EACpB,MAAM,EAAE;AACZ,CAAC;AAED,IAAIrO,qBAAqB,GAAG;EACxB,MAAM,EAAE;IACJlB,IAAI,EAAE,MAAM;IACZqC,MAAM,EAAEvG,UAAU;IAClBgF,SAAS,EAAEyO,YAAY,CAAC,MAAM,CAAC;IAC/BjN,KAAK,EAAE,MAAM;IACbkN,OAAO,EAAE;EACb,CAAC;EACD,QAAQ,EAAE;IACNxP,IAAI,EAAE,QAAQ;IACdqC,MAAM,EAAEtG,YAAY;IACpB+E,SAAS,EAAEyO,YAAY,CAAC,QAAQ,CAAC;IACjCjN,KAAK,EAAE,QAAQ;IACfkN,OAAO,EAAE;EACb,CAAC;EACD,eAAe,EAAE;IACbxP,IAAI,EAAE,eAAe;IACrBqC,MAAM,EAAE5F,mBAAmB;IAC3BqE,SAAS,EAAEyO,YAAY,CAAC,eAAe,CAAC;IACxCjN,KAAK,EAAE;EACX,CAAC;EACD,SAAS,EAAE;IACPtC,IAAI,EAAE,SAAS;IACfqC,MAAM,EAAEpG,oBAAoB;IAC5B6E,SAAS,EAAEyO,YAAY,CAAC,SAAS,CAAC;IAClCjN,KAAK,EAAE,SAAS;IAChBkN,OAAO,EAAE;EACb,CAAC;EACD,iBAAiB,EAAE;IACfxP,IAAI,EAAE,iBAAiB;IACvBqC,MAAM,EAAEpG,oBAAoB;IAC5B6E,SAAS,EAAEyO,YAAY,CAAC,iBAAiB,CAAC;IAC1CjN,KAAK,EAAE;EACX,CAAC;EACD,gBAAgB,EAAE;IACdtC,IAAI,EAAE,gBAAgB;IACtBqC,MAAM,EAAEnG,mBAAmB;IAC3B4E,SAAS,EAAEyO,YAAY,CAAC,gBAAgB,CAAC;IACzCjN,KAAK,EAAE;EACX,CAAC;EACD,WAAW,EAAE;IACTtC,IAAI,EAAE,WAAW;IACjBqC,MAAM,EAAE3F,cAAc;IACtBoE,SAAS,EAAEyO,YAAY,CAAC,WAAW,CAAC;IACpCjN,KAAK,EAAE;EACX,CAAC;EACD,WAAW,EAAE;IACTtC,IAAI,EAAE,WAAW;IACjBqC,MAAM,EAAE1F,cAAc;IACtBmE,SAAS,EAAEyO,YAAY,CAAC,WAAW,CAAC;IACpCjN,KAAK,EAAE;EACX,CAAC;EACD,WAAW,EAAE;IACTtC,IAAI,EAAE,WAAW;IACjBqC,MAAM,EAAEzF,cAAc;IACtBkE,SAAS,EAAEyO,YAAY,CAAC,WAAW,CAAC;IACpCjN,KAAK,EAAE;EACX,CAAC;EACD,aAAa,EAAE;IACXtC,IAAI,EAAE;EACV,CAAC;EACD,MAAM,EAAE;IACJA,IAAI,EAAE,MAAM;IACZqC,MAAM,EAAE9F,eAAe;IACvBuE,SAAS,EAAEyO,YAAY,CAAC,MAAM,CAAC;IAC/BjN,KAAK,EAAE;EACX,CAAC;EACD,OAAO,EAAE;IACLtC,IAAI,EAAE,OAAO;IACbqC,MAAM,EAAEjG,gBAAgB;IACxB0E,SAAS,EAAEyO,YAAY,CAAC,OAAO,CAAC;IAChCjN,KAAK,EAAE,OAAO;IACdkN,OAAO,EAAE;EACb,CAAC;EACD,gBAAgB,EAAE;IACdxP,IAAI,EAAE,gBAAgB;IACtBqC,MAAM,EAAE/F,mBAAmB;IAC3BwE,SAAS,EAAEyO,YAAY,CAAC,gBAAgB,CAAC;IACzCjN,KAAK,EAAE,cAAc;IACrBkN,OAAO,EAAE;EACb,CAAC;EACD,cAAc,EAAE;IACZxP,IAAI,EAAE,cAAc;IACpBqC,MAAM,EAAEhG,iBAAiB;IACzByE,SAAS,EAAEyO,YAAY,CAAC,cAAc,CAAC;IACvCjN,KAAK,EAAE,eAAe;IACtBkN,OAAO,EAAE;EACb,CAAC;EACD,aAAa,EAAE;IACXxP,IAAI,EAAE,aAAa;IACnBqC,MAAM,EAAErF,UAAU;IAClB8D,SAAS,EAAEyO,YAAY,CAAC,aAAa,CAAC;IACtCjN,KAAK,EAAE;EACX,CAAC;EACD,aAAa,EAAE;IACXtC,IAAI,EAAE;EACV,CAAC;EACD,MAAM,EAAE;IACJA,IAAI,EAAE,MAAM;IACZqC,MAAM,EAAErG,QAAQ;IAChB8E,SAAS,EAAEyO,YAAY,CAAC,MAAM,CAAC;IAC/BjN,KAAK,EAAE,aAAa;IACpBkN,OAAO,EAAE;EACb,CAAC;EACD,OAAO,EAAE;IACLxP,IAAI,EAAE,OAAO;IACbqC,MAAM,EAAElG,SAAS;IACjB2E,SAAS,EAAEyO,YAAY,CAAC,OAAO,CAAC;IAChCjN,KAAK,EAAE,cAAc;IACrBkN,OAAO,EAAE;EACb,CAAC;EACD,cAAc,EAAE;IACZxP,IAAI,EAAE,cAAc;IACpBqC,MAAM,EAAEiI,iBAAiB;IACzBxJ,SAAS,EAAEyO,YAAY,CAAC,cAAc,CAAC;IACvCjN,KAAK,EAAE;EACX,CAAC;EACD,OAAO,EAAE;IACLtC,IAAI,EAAE,OAAO;IACbqC,MAAM,EAAEpF,SAAS;IACjB6D,SAAS,EAAEyO,YAAY,CAAC,OAAO,CAAC;IAChCjN,KAAK,EAAE;EACX,CAAC;EACD,iBAAiB,EAAE;IACftC,IAAI,EAAE,iBAAiB;IACvBqC,MAAM,EAAEnF,kBAAkB;IAC1B4D,SAAS,EAAEyO,YAAY,CAAC,iBAAiB,CAAC;IAC1CjN,KAAK,EAAE;EACX,CAAC;EACD,aAAa,EAAE;IACXtC,IAAI,EAAE;EACV,CAAC;EACD,SAAS,EAAE;IACPA,IAAI,EAAE,SAAS;IACfqC,MAAM,EAAE7F,aAAa;IACrBsE,SAAS,EAAEyO,YAAY,CAAC,SAAS,CAAC;IAClC/M,SAAS,EAAE,IAAI;IACfF,KAAK,EAAE,gBAAgB;IACvBkN,OAAO,EAAE;EACb,CAAC;EACD,cAAc,EAAE;IACZxP,IAAI,EAAE,cAAc;IACpBqC,MAAM,EAAEhF,gBAAgB;IACxByD,SAAS,EAAEyO,YAAY,CAAC,cAAc,CAAC;IACvC/M,SAAS,EAAE,IAAI;IACfC,QAAQ,EAAE,IAAI;IACdH,KAAK,EAAE,qBAAqB;IAC5BkN,OAAO,EAAE;EACb,CAAC;EACD,YAAY,EAAE;IACVxP,IAAI,EAAE,YAAY;IAClBqC,MAAM,EAAE/E,gBAAgB;IACxBwD,SAAS,EAAEyO,YAAY,CAAC,YAAY,CAAC;IACrC/M,SAAS,EAAE,IAAI;IACfC,QAAQ,EAAE,IAAI;IACdH,KAAK,EAAE,mBAAmB;IAC1BkN,OAAO,EAAE;EACb,CAAC;EACD,aAAa,EAAE;IACXxP,IAAI,EAAE;EACV,CAAC;EACD,OAAO,EAAE;IACLA,IAAI,EAAE,OAAO;IACbqC,MAAM,EAAE,6CAA6C;IACrDvB,SAAS,EAAEyO,YAAY,CAAC,OAAO,CAAC;IAChC/M,SAAS,EAAE,IAAI;IACfF,KAAK,EAAE,gBAAgB;IACvBkN,OAAO,EAAE;EACb,CAAC;EACD,aAAa,EAAE;IACXxP,IAAI,EAAE;EACV,CAAC;EACD,MAAM,EAAE;IACJA,IAAI,EAAE,MAAM;IACZqC,MAAM,EAAElF,IAAI;IACZ2D,SAAS,EAAEyO,YAAY,CAAC,MAAM,CAAC;IAC/B/M,SAAS,EAAE,IAAI;IACfF,KAAK,EAAE;EACX,CAAC;EACD,MAAM,EAAE;IACJtC,IAAI,EAAE,MAAM;IACZqC,MAAM,EAAEjF,IAAI;IACZ0D,SAAS,EAAEyO,YAAY,CAAC,MAAM,CAAC;IAC/B/M,SAAS,EAAE,IAAI;IACfF,KAAK,EAAE;EACX;AACJ,CAAC;AAED,IAAI8H,WAAW,GAAG;EACd1F,IAAI,EAAE,CAAC,GAAG,EAAE,UAAU,CAAC;EACvBD,KAAK,EAAE,CAAC,IAAI,EAAE,UAAU,CAAC;EACzBqG,aAAa,EAAE,CAAC,YAAY,EAAE,EAAE,CAAC;EACjC;EACAO,KAAK,EAAE,CAAC,EAAE,EAAE,oHAAoH,CAAC;EACjIC,cAAc,EAAE,CAAC,EAAE,EAAE,eAAe;AACxC,CAAC;AAED,IAAIrB,WAAW,GAAG;EACdvF,IAAI,EAAE,mBAAmB;EACzBD,KAAK,EAAE;AACX,CAAC;AAED,IAAIgL,UAAU,GAAG;EACbC,MAAM,EAAE,OAAO;EACfC,MAAM,EAAE;IACJC,IAAI,EAAE,SAAS;IACfC,MAAM,EAAE;EACZ;AACJ,CAAC;AAED,IAAItJ,WAAW,GAAG;EACd,MAAM,EAAE,IAAI;EACZ,MAAM,EAAE,KAAK;EACb,QAAQ,EAAE;AACd,CAAC;;AAED;AACA;AACA;AACA;AACA,IAAI0E,UAAU,GAAG;EACbG,MAAM,EAAE,8DAA8D;EACtE0E,aAAa,EAAE,0BAA0B;EACzCC,QAAQ,EAAE,mCAAmC;EAC7CC,UAAU,EAAE,oCAAoC;EAChD9E,YAAY,EAAE,uBAAuB;EACrC+E,SAAS,EAAE;AACf,CAAC;;AAED;AACA;AACA;AACA;AACA,IAAIC,aAAa,GAAG;EAChBC,WAAW,EAAE,yBAAyB;EACtCC,cAAc,EAAE,iCAAiC;EACjDC,YAAY,EAAE,iDAAiD,GAC3D,wCAAwC;EAC5CC,WAAW,EAAE;AACjB,CAAC;;AAED;AACA;AACA;AACA,SAASC,OAAOA,CAACrQ,OAAO,EAAE;EACtB;EACAA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;;EAEvB;EACAA,OAAO,CAACE,MAAM,GAAG,IAAI;;EAErB;EACA,IAAIoQ,cAAc,GAAG,IAAI;EAEzB,IAAItQ,OAAO,CAACuQ,uBAAuB,KAAK,KAAK,EAAE;IAC3CD,cAAc,GAAG,KAAK;EAC1B;EAEA,IAAItQ,OAAO,CAACuQ,uBAAuB,KAAK,IAAI,EAAE;IAC1C,IAAIC,WAAW,GAAG9P,QAAQ,CAAC8P,WAAW;IACtC,KAAK,IAAIxR,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwR,WAAW,CAACvR,MAAM,EAAED,CAAC,EAAE,EAAE;MACzC,IAAI,CAACwR,WAAW,CAACxR,CAAC,CAAC,CAACyR,IAAI,EACpB;MAEJ,IAAID,WAAW,CAACxR,CAAC,CAAC,CAACyR,IAAI,CAACnS,OAAO,CAAC,yCAAyC,CAAC,GAAG,CAAC,CAAC,EAAE;QAC7EgS,cAAc,GAAG,KAAK;MAC1B;IACJ;EACJ;EAEA,IAAIA,cAAc,EAAE;IAChB,IAAI9L,IAAI,GAAG9D,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;IACzC6D,IAAI,CAACkM,GAAG,GAAG,YAAY;IACvBlM,IAAI,CAACiM,IAAI,GAAG,8EAA8E;IAC1F/P,QAAQ,CAAC3B,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAACqC,WAAW,CAACoD,IAAI,CAAC;EAC9D;;EAGA;EACA,IAAIxE,OAAO,CAAC2Q,OAAO,EAAE;IACjB,IAAI,CAACA,OAAO,GAAG3Q,OAAO,CAAC2Q,OAAO;EAClC,CAAC,MAAM,IAAI3Q,OAAO,CAAC2Q,OAAO,KAAK,IAAI,EAAE;IACjC;IACAC,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;IACpD;EACJ;;EAGA;EACA,IAAI7Q,OAAO,CAACyL,OAAO,KAAKzJ,SAAS,EAAE;IAC/B;IACAhC,OAAO,CAACyL,OAAO,GAAG,EAAE;;IAGpB;IACA,KAAK,IAAIjO,GAAG,IAAIwD,qBAAqB,EAAE;MACnC,IAAIS,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAACZ,qBAAqB,EAAExD,GAAG,CAAC,EAAE;QAClE,IAAIA,GAAG,CAACc,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE;UACjC0B,OAAO,CAACyL,OAAO,CAAC5I,IAAI,CAAC,GAAG,CAAC;QAC7B;QAEA,IAAI7B,qBAAqB,CAACxD,GAAG,CAAC,CAAC8R,OAAO,KAAK,IAAI,IAAKtP,OAAO,CAAC8Q,SAAS,IAAI9Q,OAAO,CAAC8Q,SAAS,CAACjC,WAAW,KAAK3C,KAAK,IAAIlM,OAAO,CAAC8Q,SAAS,CAACxS,OAAO,CAACd,GAAG,CAAC,IAAI,CAAC,CAAE,EAAE;UACvJwC,OAAO,CAACyL,OAAO,CAAC5I,IAAI,CAACrF,GAAG,CAAC;QAC7B;MACJ;IACJ;EACJ;;EAEA;EACA,IAAI,CAACiE,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAAC5B,OAAO,EAAE,cAAc,CAAC,EAAE;IAChEA,OAAO,CAACiM,YAAY,GAAG,gBAAgB;EAC3C;;EAEA;EACA,IAAI,CAACxK,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAAC5B,OAAO,EAAE,QAAQ,CAAC,EAAE;IAC1DA,OAAO,CAAC+Q,MAAM,GAAG,CAAC,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC;IAEzD,IAAI/Q,OAAO,CAACgR,WAAW,EAAE;MACrBhR,OAAO,CAAC+Q,MAAM,CAACE,OAAO,CAAC,cAAc,CAAC;IAC1C;EACJ;;EAGA;EACA,IAAI,CAACjR,OAAO,CAAC4L,aAAa,EAAE;IACxB5L,OAAO,CAAC4L,aAAa,GAAG,UAAUsF,SAAS,EAAE;MACzC;MACA,OAAO,IAAI,CAAChR,MAAM,CAACiR,QAAQ,CAACD,SAAS,CAAC;IAC1C,CAAC;EACL;;EAGA;EACAlR,OAAO,CAACoR,aAAa,GAAGtC,MAAM,CAAC;IAC3BuC,mBAAmB,EAAE,IAAI,CAAE;EAC/B,CAAC,EAAErR,OAAO,CAACoR,aAAa,IAAI,CAAC,CAAC,CAAC;;EAG/B;EACApR,OAAO,CAACkK,WAAW,GAAG4E,MAAM,CAAC,CAAC,CAAC,EAAE5E,WAAW,EAAElK,OAAO,CAACkK,WAAW,IAAI,CAAC,CAAC,CAAC;;EAGxE;EACAlK,OAAO,CAAC+J,WAAW,GAAG+E,MAAM,CAAC,CAAC,CAAC,EAAE/E,WAAW,EAAE/J,OAAO,CAAC+J,WAAW,IAAI,CAAC,CAAC,CAAC;;EAGxE;EACA/J,OAAO,CAACqG,WAAW,GAAGyI,MAAM,CAAC,CAAC,CAAC,EAAEzI,WAAW,EAAErG,OAAO,CAACqG,WAAW,IAAI,CAAC,CAAC,CAAC;EAGxE,IAAIrG,OAAO,CAACsR,QAAQ,IAAItP,SAAS,EAAE;IAC/B;IACAhC,OAAO,CAACsR,QAAQ,CAAC/B,UAAU,GAAGT,MAAM,CAAC,CAAC,CAAC,EAAES,UAAU,EAAEvP,OAAO,CAACsR,QAAQ,CAAC/B,UAAU,IAAI,CAAC,CAAC,CAAC;EAC3F;EAEAvP,OAAO,CAACqP,YAAY,GAAGP,MAAM,CAAC,CAAC,CAAC,EAAEO,YAAY,EAAErP,OAAO,CAACqP,YAAY,IAAI,CAAC,CAAC,CAAC;;EAE3E;EACArP,OAAO,CAAC3C,SAAS,GAAGyR,MAAM,CAAC,CAAC,CAAC,EAAEzR,SAAS,EAAE2C,OAAO,CAAC3C,SAAS,IAAI,CAAC,CAAC,CAAC;EAElE2C,OAAO,CAAC0F,SAAS,GAAG1F,OAAO,CAAC0F,SAAS,IAAI1D,SAAS;EAElDhC,OAAO,CAAC4M,SAAS,GAAG5M,OAAO,CAAC4M,SAAS,IAAI,KAAK;EAE9C,IAAI,OAAO5M,OAAO,CAAC0F,SAAS,KAAK,WAAW,EAAE;IAC1C;IACA1F,OAAO,CAACuR,SAAS,GAAGvR,OAAO,CAAC0F,SAAS;EACzC,CAAC,MAAM;IACH1F,OAAO,CAACuR,SAAS,GAAGvR,OAAO,CAACuR,SAAS,IAAI,OAAO;EACpD;EAEAvR,OAAO,CAACwR,aAAa,GAAGxR,OAAO,CAACwR,aAAa,IAAI,UAAUC,YAAY,EAAE;IACrEC,KAAK,CAACD,YAAY,CAAC;EACvB,CAAC;;EAED;EACAzR,OAAO,CAACgR,WAAW,GAAGhR,OAAO,CAACgR,WAAW,IAAI,KAAK;EAClDhR,OAAO,CAAC2R,YAAY,GAAG3R,OAAO,CAAC2R,YAAY,IAAI,OAAO,CAAC,CAAC;EACxD3R,OAAO,CAAC4R,WAAW,GAAG5R,OAAO,CAAC4R,WAAW,IAAI,8CAA8C;EAC3F5R,OAAO,CAAC+K,UAAU,GAAG+D,MAAM,CAAC,CAAC,CAAC,EAAE/D,UAAU,EAAE/K,OAAO,CAAC+K,UAAU,IAAI,CAAC,CAAC,CAAC;EACrE/K,OAAO,CAACgQ,aAAa,GAAGlB,MAAM,CAAC,CAAC,CAAC,EAAEkB,aAAa,EAAEhQ,OAAO,CAACgQ,aAAa,IAAI,CAAC,CAAC,CAAC;EAC9EhQ,OAAO,CAAC6R,iBAAiB,GAAG7R,OAAO,CAAC6R,iBAAiB,IAAI,KAAK;EAC9D7R,OAAO,CAAC8R,aAAa,GAAG9R,OAAO,CAAC8R,aAAa,IAAI,qBAAqB;EACtE9R,OAAO,CAAC+R,eAAe,GAAG/R,OAAO,CAAC+R,eAAe,IAAI,KAAK;;EAG1D;EACA,IAAI/R,OAAO,CAACsR,QAAQ,IAAItP,SAAS,IAAIhC,OAAO,CAACsR,QAAQ,CAACU,SAAS,IAAIhQ,SAAS,IAAIhC,OAAO,CAACsR,QAAQ,CAACU,SAAS,IAAI,EAAE,EAC5GhS,OAAO,CAACsR,QAAQ,CAACW,QAAQ,GAAGjS,OAAO,CAACsR,QAAQ,CAACU,SAAS;;EAE1D;EACA,IAAIhS,OAAO,CAACkS,WAAW,IAAIlS,OAAO,CAACkS,WAAW,CAACC,OAAO,KAAKnQ,SAAS,EAAE;IAClEhC,OAAO,CAACkS,WAAW,CAACC,OAAO,GAAG,IAAI;EACtC;;EAEA;EACA,IAAI,CAACnS,OAAO,GAAGA,OAAO;;EAGtB;EACA,IAAI,CAACoS,MAAM,CAAC,CAAC;;EAGb;EACA;EACA;EACA,IAAIpS,OAAO,CAACqS,YAAY,KAAK,CAAC,IAAI,CAACrS,OAAO,CAACsR,QAAQ,IAAI,IAAI,CAACtR,OAAO,CAACsR,QAAQ,CAACgB,eAAe,KAAK,IAAI,CAAC,EAAE;IACpG,IAAI,CAACzG,KAAK,CAAC7L,OAAO,CAACqS,YAAY,CAAC;EACpC;EAEA,IAAIrS,OAAO,CAACgR,WAAW,EAAE;IACrB,IAAIuB,IAAI,GAAG,IAAI;IAEf,IAAI,CAAC5N,UAAU,CAACmH,EAAE,CAAC,WAAW,EAAE,UAAUtI,EAAE,EAAEgP,KAAK,EAAE;MACjDD,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEyH,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAAC6E,aAAa,CAAC;MAC3E4C,KAAK,CAACrR,eAAe,CAAC,CAAC;MACvBqR,KAAK,CAACtP,cAAc,CAAC,CAAC;IAC1B,CAAC,CAAC;IACF,IAAI,CAACyB,UAAU,CAACmH,EAAE,CAAC,SAAS,EAAE,UAAUtI,EAAE,EAAEgP,KAAK,EAAE;MAC/CD,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEyH,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAACG,MAAM,CAAC;MACpEsH,KAAK,CAACrR,eAAe,CAAC,CAAC;MACvBqR,KAAK,CAACtP,cAAc,CAAC,CAAC;IAC1B,CAAC,CAAC;IACF,IAAI,CAACyB,UAAU,CAACmH,EAAE,CAAC,WAAW,EAAE,UAAUtI,EAAE,EAAEgP,KAAK,EAAE;MACjDD,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEyH,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAACG,MAAM,CAAC;MACpEsH,KAAK,CAACrR,eAAe,CAAC,CAAC;MACvBqR,KAAK,CAACtP,cAAc,CAAC,CAAC;IAC1B,CAAC,CAAC;IAEF,IAAI,CAACyB,UAAU,CAACmH,EAAE,CAAC,UAAU,EAAE,UAAUtI,EAAE,EAAEgP,KAAK,EAAE;MAChDD,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEyH,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAAC6E,aAAa,CAAC;MAC3E4C,KAAK,CAACrR,eAAe,CAAC,CAAC;MACvBqR,KAAK,CAACtP,cAAc,CAAC,CAAC;IAC1B,CAAC,CAAC;IAEF,IAAI,CAACyB,UAAU,CAACmH,EAAE,CAAC,MAAM,EAAE,UAAUtI,EAAE,EAAEgP,KAAK,EAAE;MAC5CA,KAAK,CAACrR,eAAe,CAAC,CAAC;MACvBqR,KAAK,CAACtP,cAAc,CAAC,CAAC;MACtB,IAAIlD,OAAO,CAACyS,mBAAmB,EAAE;QAC7BF,IAAI,CAACG,+BAA+B,CAAC1S,OAAO,CAACyS,mBAAmB,EAAED,KAAK,CAACG,YAAY,CAACC,KAAK,CAAC;MAC/F,CAAC,MAAM;QACHL,IAAI,CAACM,YAAY,CAACL,KAAK,CAACG,YAAY,CAACC,KAAK,CAAC;MAC/C;IACJ,CAAC,CAAC;IAEF,IAAI,CAACjO,UAAU,CAACmH,EAAE,CAAC,OAAO,EAAE,UAAUtI,EAAE,EAAEgP,KAAK,EAAE;MAC7C,IAAIxS,OAAO,CAACyS,mBAAmB,EAAE;QAC7BF,IAAI,CAACG,+BAA+B,CAAC1S,OAAO,CAACyS,mBAAmB,EAAED,KAAK,CAACM,aAAa,CAACF,KAAK,CAAC;MAChG,CAAC,MAAM;QACHL,IAAI,CAACM,YAAY,CAACL,KAAK,CAACM,aAAa,CAACF,KAAK,CAAC;MAChD;IACJ,CAAC,CAAC;EACN;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAvC,OAAO,CAAC3O,SAAS,CAACmR,YAAY,GAAG,UAAUD,KAAK,EAAEG,SAAS,EAAEC,OAAO,EAAE;EAClE,IAAIJ,KAAK,CAAC3T,MAAM,KAAK,CAAC,EAAE;IACpB;EACJ;EACA,IAAIgU,KAAK,GAAG,EAAE;EACd,KAAK,IAAIjU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4T,KAAK,CAAC3T,MAAM,EAAED,CAAC,EAAE,EAAE;IACnCiU,KAAK,CAACpQ,IAAI,CAAC+P,KAAK,CAAC5T,CAAC,CAAC,CAACc,IAAI,CAAC;IACzB,IAAI,CAACkR,WAAW,CAAC4B,KAAK,CAAC5T,CAAC,CAAC,EAAE+T,SAAS,EAAEC,OAAO,CAAC;EAClD;EACA,IAAI,CAAClI,eAAe,CAAC,cAAc,EAAE,IAAI,CAAC9K,OAAO,CAAC+K,UAAU,CAAC8E,QAAQ,CAACrR,OAAO,CAAC,gBAAgB,EAAEyU,KAAK,CAACjF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AACtH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAqC,OAAO,CAAC3O,SAAS,CAACgR,+BAA+B,GAAG,UAAUD,mBAAmB,EAAEG,KAAK,EAAE;EACtF,IAAIA,KAAK,CAAC3T,MAAM,KAAK,CAAC,EAAE;IACpB;EACJ;EACA,IAAIgU,KAAK,GAAG,EAAE;EACd,KAAK,IAAIjU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4T,KAAK,CAAC3T,MAAM,EAAED,CAAC,EAAE,EAAE;IACnCiU,KAAK,CAACpQ,IAAI,CAAC+P,KAAK,CAAC5T,CAAC,CAAC,CAACc,IAAI,CAAC;IACzB,IAAI,CAACoT,8BAA8B,CAACT,mBAAmB,EAAEG,KAAK,CAAC5T,CAAC,CAAC,CAAC;EACtE;EACA,IAAI,CAAC8L,eAAe,CAAC,cAAc,EAAE,IAAI,CAAC9K,OAAO,CAAC+K,UAAU,CAAC8E,QAAQ,CAACrR,OAAO,CAAC,gBAAgB,EAAEyU,KAAK,CAACjF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AACtH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACAqC,OAAO,CAAC3O,SAAS,CAACoJ,eAAe,GAAG,UAAUqI,QAAQ,EAAE1S,OAAO,EAAE;EAC7D,IAAI,CAAC,IAAI,CAAC2S,GAAG,CAACC,SAAS,EAAE;IACrB;EACJ;EAEA,IAAIC,eAAe,GAAG,IAAI,CAACF,GAAG,CAACC,SAAS,CAACE,sBAAsB,CAACJ,QAAQ,CAAC;EACzE,IAAIG,eAAe,CAACrU,MAAM,KAAK,CAAC,EAAE;IAC9B,IAAI,CAACmU,GAAG,CAACC,SAAS,CAACE,sBAAsB,CAACJ,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACK,WAAW,GAAG/S,OAAO;EAChF,CAAC,MAAM,IAAI6S,eAAe,CAACrU,MAAM,KAAK,CAAC,EAAE;IACrC2R,OAAO,CAACC,GAAG,CAAC,2BAA2B,GAAGsC,QAAQ,GAAG,iBAAiB,CAAC;EAC3E,CAAC,MAAM;IACHvC,OAAO,CAACC,GAAG,CAAC,0CAA0C,GAAGsC,QAAQ,GAAG,aAAa,CAAC;EACtF;AACJ,CAAC;;AAED;AACA;AACA;AACA9C,OAAO,CAAC3O,SAAS,CAACyP,QAAQ,GAAG,UAAUlP,IAAI,EAAE;EACzC,IAAI7G,MAAM,EAAE;IACR;IACA,IAAIqY,aAAa;IACjB,IAAI,IAAI,CAACzT,OAAO,IAAI,IAAI,CAACA,OAAO,CAAC0T,eAAe,IAAI,IAAI,CAAC1T,OAAO,CAAC0T,eAAe,CAACD,aAAa,EAAE;MAC5FA,aAAa,GAAG,IAAI,CAACzT,OAAO,CAAC0T,eAAe,CAACD,aAAa;IAC9D,CAAC,MAAM;MACHA,aAAa,GAAG,CAAC,CAAC;IACtB;;IAEA;IACA,IAAI,IAAI,CAACzT,OAAO,IAAI,IAAI,CAACA,OAAO,CAAC0T,eAAe,IAAI,IAAI,CAAC1T,OAAO,CAAC0T,eAAe,CAACC,gBAAgB,KAAK,KAAK,EAAE;MACzGF,aAAa,CAACG,MAAM,GAAG,KAAK;IAChC,CAAC,MAAM;MACHH,aAAa,CAACG,MAAM,GAAG,IAAI;IAC/B;IAEA,IAAI,IAAI,CAAC5T,OAAO,IAAI,IAAI,CAACA,OAAO,CAAC0T,eAAe,IAAI,IAAI,CAAC1T,OAAO,CAAC0T,eAAe,CAACG,sBAAsB,KAAK,IAAI,EAAE;MAE9G;MACA,IAAIC,IAAI,GAAG,IAAI,CAAC9T,OAAO,CAAC0T,eAAe,CAACI,IAAI,IAAI/V,MAAM,CAAC+V,IAAI;;MAE3D;MACA,IAAIA,IAAI,EAAE;QACNL,aAAa,CAACM,SAAS,GAAG,UAAUzP,IAAI,EAAE0P,QAAQ,EAAE;UAChD,IAAIA,QAAQ,IAAIF,IAAI,CAACG,WAAW,CAACD,QAAQ,CAAC,EAAE;YACxC,OAAOF,IAAI,CAACC,SAAS,CAACC,QAAQ,EAAE1P,IAAI,CAAC,CAACuH,KAAK;UAC/C,CAAC,MAAM;YACH,OAAOiI,IAAI,CAACI,aAAa,CAAC5P,IAAI,CAAC,CAACuH,KAAK;UACzC;QACJ,CAAC;MACL;IACJ;;IAEA;IACAzQ,MAAM,CAAC+Y,UAAU,CAACV,aAAa,CAAC;;IAEhC;IACA,IAAIvV,QAAQ,GAAG9C,MAAM,CAACgZ,KAAK,CAACnS,IAAI,CAAC;;IAEjC;IACA,IAAI,IAAI,CAACjC,OAAO,CAAC0T,eAAe,IAAI,OAAO,IAAI,CAAC1T,OAAO,CAAC0T,eAAe,CAACW,iBAAiB,KAAK,UAAU,EAAE;MACtGnW,QAAQ,GAAG,IAAI,CAAC8B,OAAO,CAAC0T,eAAe,CAACW,iBAAiB,CAACzS,IAAI,CAAC,IAAI,EAAE1D,QAAQ,CAAC;IAClF;;IAEA;IACAA,QAAQ,GAAGD,oBAAoB,CAACC,QAAQ,CAAC;;IAEzC;IACAA,QAAQ,GAAGO,2BAA2B,CAACP,QAAQ,CAAC;IAEhD,OAAOA,QAAQ;EACnB;AACJ,CAAC;;AAED;AACA;AACA;AACAmS,OAAO,CAAC3O,SAAS,CAAC0Q,MAAM,GAAG,UAAUjS,EAAE,EAAE;EACrC,IAAI,CAACA,EAAE,EAAE;IACLA,EAAE,GAAG,IAAI,CAACwQ,OAAO,IAAIjQ,QAAQ,CAAC3B,oBAAoB,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;EACrE;EAEA,IAAI,IAAI,CAACuV,SAAS,IAAI,IAAI,CAACA,SAAS,KAAKnU,EAAE,EAAE;IACzC;IACA;EACJ;EAEA,IAAI,CAACwQ,OAAO,GAAGxQ,EAAE;EACjB,IAAIH,OAAO,GAAG,IAAI,CAACA,OAAO;EAE1B,IAAIuS,IAAI,GAAG,IAAI;EACf,IAAIgC,OAAO,GAAG,CAAC,CAAC;EAEhB,KAAK,IAAI/W,GAAG,IAAIwC,OAAO,CAAC3C,SAAS,EAAE;IAC/B;IACA,IAAI2C,OAAO,CAAC3C,SAAS,CAACG,GAAG,CAAC,KAAK,IAAI,IAAI7B,QAAQ,CAAC6B,GAAG,CAAC,KAAK,IAAI,EAAE;MAC3D,CAAC,UAAUA,GAAG,EAAE;QACZ+W,OAAO,CAAC1U,WAAW,CAACG,OAAO,CAAC3C,SAAS,CAACG,GAAG,CAAC,CAAC,CAAC,GAAG,YAAY;UACvD,IAAI2E,MAAM,GAAGxG,QAAQ,CAAC6B,GAAG,CAAC;UAC1B,IAAI,OAAO2E,MAAM,KAAK,UAAU,EAAE;YAC9BA,MAAM,CAACoQ,IAAI,CAAC;UAChB,CAAC,MAAM,IAAI,OAAOpQ,MAAM,KAAK,QAAQ,EAAE;YACnCpE,MAAM,CAACoF,IAAI,CAAChB,MAAM,EAAE,QAAQ,CAAC;UACjC;QACJ,CAAC;MACL,CAAC,EAAE3E,GAAG,CAAC;IACX;EACJ;EAEA+W,OAAO,CAAC,OAAO,CAAC,GAAG,sCAAsC;EACzDA,OAAO,CAAC,KAAK,CAAC,GAAG,0BAA0B;EAC3CA,OAAO,CAAC,WAAW,CAAC,GAAG,iCAAiC;EACxDA,OAAO,CAAC,KAAK,CAAC,GAAG,UAAU/Q,EAAE,EAAE;IAC3B,IAAIA,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC,EAAEzH,gBAAgB,CAACmV,IAAI,CAAC;EAC1D,CAAC;EAED,IAAI,CAACiC,iBAAiB,GAAG,UAAUtT,CAAC,EAAE;IAClCA,CAAC,GAAGA,CAAC,IAAInD,MAAM,CAACyU,KAAK;IAErB,IAAItR,CAAC,CAACuT,OAAO,IAAI,EAAE,EAAE;MACjB,IAAIlC,IAAI,CAAC5N,UAAU,CAACE,SAAS,CAAC,YAAY,CAAC,EAAEzH,gBAAgB,CAACmV,IAAI,CAAC;IACvE;EACJ,CAAC;EACD7R,QAAQ,CAACO,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACuT,iBAAiB,EAAE,KAAK,CAAC;EAEnE,IAAIE,IAAI,EAAEC,QAAQ;;EAElB;EACA,IAAI3U,OAAO,CAACkS,WAAW,EAAE;IACrBjX,UAAU,CAAC2Z,UAAU,CAAC,cAAc,EAAE,UAAUC,MAAM,EAAE;MACpD,OAAO5Z,UAAU,CAACiX,WAAW,CAACjX,UAAU,CAAC6Z,OAAO,CAACD,MAAM,EAAE7U,OAAO,CAAC+U,YAAY,KAAK,KAAK,GAAG,eAAe,GAAG,KAAK,CAAC,EAAE/U,OAAO,CAACkS,WAAW,CAACwC,IAAI,EAAE1U,OAAO,CAACkS,WAAW,CAACC,OAAO,CAAC;IAC9K,CAAC,CAAC;IAEFuC,IAAI,GAAG,cAAc;IACrBC,QAAQ,GAAG3U,OAAO,CAACoR,aAAa;IAChCuD,QAAQ,CAACK,WAAW,GAAG,KAAK;EAChC,CAAC,MAAM;IACHN,IAAI,GAAG1U,OAAO,CAACoR,aAAa;IAC5BsD,IAAI,CAAC5U,IAAI,GAAG,KAAK;IACjB4U,IAAI,CAACM,WAAW,GAAG,KAAK;EAC5B;EACA,IAAIhV,OAAO,CAAC+U,YAAY,KAAK,KAAK,EAAE;IAChCL,IAAI,GAAG,eAAe;IACtBC,QAAQ,GAAG3U,OAAO,CAACoR,aAAa;IAChCuD,QAAQ,CAAC7U,IAAI,GAAG,KAAK;IACrB6U,QAAQ,CAACK,WAAW,GAAG,KAAK;IAE5B,IAAI,OAAOhV,OAAO,CAAC+U,YAAY,KAAK,UAAU,EAAE;MAC5C/U,OAAO,CAAC+U,YAAY,CAAC;QACjBE,kBAAkB,EAAEha;MACxB,CAAC,CAAC;IACN,CAAC,MAAM;MACHE,sBAAsB,CAAC;QACnB8Z,kBAAkB,EAAEha;MACxB,CAAC,CAAC;IACN;EACJ;;EAEA;EACA,SAASia,cAAcA,CAAC1R,EAAE,EAAEwJ,MAAM,EAAEwF,KAAK,EAAE;IACvC,OAAO;MACH2C,MAAM,EAAE;IACZ,CAAC;EACL;EAEA,IAAI,CAACxQ,UAAU,GAAG1J,UAAU,CAACma,YAAY,CAACjV,EAAE,EAAE;IAC1CuU,IAAI,EAAEA,IAAI;IACVC,QAAQ,EAAEA,QAAQ;IAClBU,KAAK,EAAGrV,OAAO,CAACqV,KAAK,IAAIrT,SAAS,GAAIhC,OAAO,CAACqV,KAAK,GAAG,SAAS;IAC/DC,OAAO,EAAGtV,OAAO,CAACsV,OAAO,IAAItT,SAAS,GAAIhC,OAAO,CAACsV,OAAO,GAAG,CAAC;IAC7DC,UAAU,EAAGvV,OAAO,CAACsV,OAAO,IAAItT,SAAS,GAAIhC,OAAO,CAACsV,OAAO,GAAG,CAAC;IAChEE,cAAc,EAAGxV,OAAO,CAACwV,cAAc,KAAK,KAAK,GAAI,KAAK,GAAG,IAAI;IACjEC,WAAW,EAAGzV,OAAO,CAACyV,WAAW,KAAK,IAAI,GAAI,IAAI,GAAG,KAAK;IAC1DC,SAAS,EAAG1V,OAAO,CAAC0V,SAAS,KAAK,IAAI,GAAI,IAAI,GAAG,KAAK;IACtDC,SAAS,EAAEpB,OAAO;IAClB3H,SAAS,EAAE5M,OAAO,CAAC4M,SAAS;IAC5BgJ,YAAY,EAAG5V,OAAO,CAAC4V,YAAY,KAAK,KAAK,GAAI,KAAK,GAAG,IAAI;IAC7DC,kBAAkB,EAAE,CAAC,YAAY,CAAC;IAClCC,WAAW,EAAE9V,OAAO,CAAC8V,WAAW,IAAI3V,EAAE,CAAC4V,YAAY,CAAC,aAAa,CAAC,IAAI,EAAE;IACxEC,iBAAiB,EAAGhW,OAAO,CAACgW,iBAAiB,IAAIhU,SAAS,GAAIhC,OAAO,CAACgW,iBAAiB,GAAG,CAACvY,QAAQ,CAAC,CAAC;IACrGwY,cAAc,EAAGjW,OAAO,CAACiW,cAAc,IAAIjU,SAAS,GAAIhC,OAAO,CAACiW,cAAc,GAAG,QAAQ;IACzFf,cAAc,EAAEA,cAAc;IAC9BgB,UAAU,EAAGlW,OAAO,CAACkW,UAAU,IAAIlU,SAAS,GAAIhC,OAAO,CAACkW,UAAU,GAAGzY,QAAQ,CAAC,CAAC,GAAG,iBAAiB,GAAG,UAAU;IAChH0Y,UAAU,EAAGnW,OAAO,CAACoW,gBAAgB,IAAIpU,SAAS,GAAIhC,OAAO,CAACoW,gBAAgB,GAAG,IAAI;IACrFC,WAAW,EAAGrW,OAAO,CAACqW,WAAW,IAAIrU,SAAS,GAAIhC,OAAO,CAACqW,WAAW,GAAG;EAC5E,CAAC,CAAC;EAEF,IAAI,CAAC1R,UAAU,CAACgB,kBAAkB,CAAC,CAAC,CAACnG,KAAK,CAAC+R,SAAS,GAAGvR,OAAO,CAACuR,SAAS;EAExE,IAAI,OAAOvR,OAAO,CAAC0F,SAAS,KAAK,WAAW,EAAE;IAC1C,IAAI,CAACf,UAAU,CAACgB,kBAAkB,CAAC,CAAC,CAACnG,KAAK,CAACqG,MAAM,GAAG7F,OAAO,CAAC0F,SAAS;EACzE;EAEA,IAAI1F,OAAO,CAACsW,SAAS,KAAK,IAAI,EAAE;IAC5B,IAAI9S,EAAE,GAAG,IAAI,CAACmB,UAAU;IACxBnB,EAAE,CAACsI,EAAE,CAAC,QAAQ,EAAE,YAAY;MACxBtI,EAAE,CAAC+S,IAAI,CAAC,CAAC;IACb,CAAC,CAAC;EACN;EAEA,IAAI,CAACnD,GAAG,GAAG,CAAC,CAAC;;EAEb;EACA;EACA,IAAI9N,gBAAgB,GAAG5E,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;EACpD2E,gBAAgB,CAACjF,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;EAClDgF,gBAAgB,CAACzD,YAAY,CAAC,MAAM,EAAE,aAAa,CAAC;EACpD,IAAI2U,SAAS,GAAG,IAAI,CAAC7R,UAAU,CAACM,iBAAiB,CAAC,CAAC;EACnDuR,SAAS,CAACjR,UAAU,CAACkR,YAAY,CAACnR,gBAAgB,EAAEkR,SAAS,CAAC;EAC9DlR,gBAAgB,CAAClE,WAAW,CAACoV,SAAS,CAAC;EAEvC,IAAIxW,OAAO,CAACyL,OAAO,KAAK,KAAK,EAAE;IAC3B,IAAI,CAAC2H,GAAG,CAAC3H,OAAO,GAAG,IAAI,CAACiL,aAAa,CAAC,CAAC;EAC3C;EACA,IAAI1W,OAAO,CAAC+Q,MAAM,KAAK,KAAK,EAAE;IAC1B,IAAI,CAACqC,GAAG,CAACC,SAAS,GAAG,IAAI,CAACsD,eAAe,CAAC,CAAC;EAC/C;EACA,IAAI3W,OAAO,CAACsR,QAAQ,IAAItP,SAAS,IAAIhC,OAAO,CAACsR,QAAQ,CAACsF,OAAO,KAAK,IAAI,EAAE;IACpE,IAAI,CAACtF,QAAQ,CAAC,CAAC,CAAC,CAAC;IACjB,IAAI,CAAC3M,UAAU,CAACmH,EAAE,CAAC,QAAQ,EAAE,YAAY;MACrC+K,YAAY,CAACtE,IAAI,CAACuE,iBAAiB,CAAC;MACpCvE,IAAI,CAACuE,iBAAiB,GAAG7L,UAAU,CAAC,YAAY;QAC5CsH,IAAI,CAACjB,QAAQ,CAAC,CAAC;MACnB,CAAC,EAAEiB,IAAI,CAACvS,OAAO,CAACsR,QAAQ,CAACyF,YAAY,IAAIxE,IAAI,CAACvS,OAAO,CAACsR,QAAQ,CAAC0F,KAAK,IAAI,IAAI,CAAC;IACjF,CAAC,CAAC;EACN;EAEA,SAASC,UAAUA,CAACC,YAAY,EAAEC,aAAa,EAAE;IAC7C,IAAItR,MAAM;IACV,IAAIuR,aAAa,GAAGrZ,MAAM,CAACsZ,gBAAgB,CAAC3W,QAAQ,CAAC4W,aAAa,CAAC,mBAAmB,CAAC,CAAC,CAACC,KAAK,CAAC/Y,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;IAChH,IAAI0Y,YAAY,GAAGE,aAAa,EAAE;MAC9BvR,MAAM,GAAGsR,aAAa,GAAG,IAAI;IACjC,CAAC,MAAM;MACHtR,MAAM,GAAIsR,aAAa,GAAGD,YAAY,GAAG,GAAG,GAAI,GAAG;IACvD;IACA,OAAOrR,MAAM;EACjB;EAEA,IAAI2R,GAAG,GAAG,IAAI;EAGd,SAASC,0BAA0BA,CAACC,QAAQ,EAAEC,GAAG,EAAE;IAC/CD,QAAQ,CAAC7V,YAAY,CAAC,cAAc,EAAE8V,GAAG,CAAChO,GAAG,CAAC;IAC9C+N,QAAQ,CAAC7V,YAAY,CAAC,OAAO,EAAE,iBAAiB,GAAG8V,GAAG,CAAChO,GAAG,GAAG,YAAY,GAAGgO,GAAG,CAACT,YAAY,GAAG,cAAc,GAAGD,UAAU,CAACU,GAAG,CAACT,YAAY,EAAES,GAAG,CAACR,aAAa,CAAC,CAAC;IAChKK,GAAG,CAAC7S,UAAU,CAACiT,OAAO,CAAC,CAAC;EAC5B;EAEA,SAASC,YAAYA,CAAA,EAAG;IACpB,IAAI,CAAC7X,OAAO,CAAC8X,qBAAqB,EAAE;MAChC;IACJ;IAEAxS,gBAAgB,CAACyS,gBAAgB,CAAC,kBAAkB,CAAC,CAACC,OAAO,CAAC,UAAU9W,CAAC,EAAE;MACvE,IAAIwW,QAAQ,GAAGxW,CAAC,CAAC+W,aAAa;MAC9B,IAAI,CAACP,QAAQ,CAACxV,SAAS,CAAC/D,KAAK,CAAC,kBAAkB,CAAC,EAAE;QAC/C;QACA;MACJ;MACA,IAAI,CAACuZ,QAAQ,CAACQ,YAAY,CAAC,cAAc,CAAC,EAAE;QACxC,IAAIC,OAAO,GAAGT,QAAQ,CAACxV,SAAS,CAAC/D,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC;QACtD,IAAI,CAACJ,MAAM,CAACqa,eAAe,EAAE;UACzBra,MAAM,CAACqa,eAAe,GAAG,CAAC,CAAC;QAC/B;QAEA,IAAID,OAAO,IAAIA,OAAO,CAAClZ,MAAM,IAAI,CAAC,EAAE;UAChC,IAAIoZ,MAAM,GAAGF,OAAO,CAAC,CAAC,CAAC;UAEvB,IAAInY,OAAO,CAACsY,oBAAoB,EAAE;YAC9B,IAAIC,MAAM,GAAGvY,OAAO,CAACsY,oBAAoB,CAACH,OAAO,CAAC,CAAC,CAAC,CAAC;YACrD;YACA,IAAI,OAAOI,MAAM,KAAK,QAAQ,EAAE;cAC5BF,MAAM,GAAGE,MAAM;YACnB;UACJ;UAEA,IAAI,CAACxa,MAAM,CAACqa,eAAe,CAACC,MAAM,CAAC,EAAE;YACjC,IAAIV,GAAG,GAAGjX,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YACvCgX,GAAG,CAACa,MAAM,GAAG,YAAY;cACrBza,MAAM,CAACqa,eAAe,CAACC,MAAM,CAAC,GAAG;gBAC7BnB,YAAY,EAAES,GAAG,CAACT,YAAY;gBAC9BC,aAAa,EAAEQ,GAAG,CAACR,aAAa;gBAChCxN,GAAG,EAAE0O;cACT,CAAC;cACDZ,0BAA0B,CAACC,QAAQ,EAAE3Z,MAAM,CAACqa,eAAe,CAACC,MAAM,CAAC,CAAC;YACxE,CAAC;YACDV,GAAG,CAACc,GAAG,GAAGJ,MAAM;UACpB,CAAC,MAAM;YACHZ,0BAA0B,CAACC,QAAQ,EAAE3Z,MAAM,CAACqa,eAAe,CAACC,MAAM,CAAC,CAAC;UACxE;QACJ;MACJ;IACJ,CAAC,CAAC;EACN;EAEA,IAAI,CAAC1T,UAAU,CAACmH,EAAE,CAAC,QAAQ,EAAE,YAAY;IACrC+L,YAAY,CAAC,CAAC;EAClB,CAAC,CAAC;EAEF,IAAI,CAACzE,GAAG,CAACsF,UAAU,GAAG,IAAI,CAACC,gBAAgB,CAAC,CAAC;EAC7C,IAAI,CAACrE,SAAS,GAAG,IAAI,CAAC3D,OAAO;EAE7B,IAAI3Q,OAAO,CAAC0V,SAAS,KAAK,IAAI,IAAIvV,EAAE,CAACuV,SAAS,EAAE;IAC5C,IAAI,CAAC/Q,UAAU,CAACnE,KAAK,CAAC,CAAC;EAC3B;;EAEA;EACA,IAAIoY,OAAO,GAAG,IAAI,CAACjU,UAAU;EAC7BsG,UAAU,CAAC,YAAY;IACnB2N,OAAO,CAAC5M,OAAO,CAAC,CAAC;EACrB,CAAC,CAAC6M,IAAI,CAACD,OAAO,CAAC,EAAE,CAAC,CAAC;AACvB,CAAC;AAEDvI,OAAO,CAAC3O,SAAS,CAACoX,OAAO,GAAG,YAAY;EACpCpY,QAAQ,CAACqY,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAACvE,iBAAiB,CAAC;AACnE,CAAC;;AAED;AACA,SAASwE,uBAAuBA,CAAA,EAAG;EAC/B,IAAI,OAAOC,YAAY,KAAK,QAAQ,EAAE;IAClC,IAAI;MACAA,YAAY,CAACC,OAAO,CAAC,mBAAmB,EAAE,CAAC,CAAC;MAC5CD,YAAY,CAACE,UAAU,CAAC,mBAAmB,CAAC;IAChD,CAAC,CAAC,OAAOjY,CAAC,EAAE;MACR,OAAO,KAAK;IAChB;EACJ,CAAC,MAAM;IACH,OAAO,KAAK;EAChB;EAEA,OAAO,IAAI;AACf;AAEAmP,OAAO,CAAC3O,SAAS,CAAC4P,QAAQ,GAAG,YAAY;EACrC,IAAI0H,uBAAuB,CAAC,CAAC,EAAE;IAC3B,IAAII,OAAO,GAAG,IAAI;IAElB,IAAI,IAAI,CAACpZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,IAAIjQ,SAAS,IAAI,IAAI,CAAChC,OAAO,CAACsR,QAAQ,CAACW,QAAQ,IAAI,EAAE,EAAE;MACrFrB,OAAO,CAACC,GAAG,CAAC,8DAA8D,CAAC;MAC3E;IACJ;IAEA,IAAI,IAAI,CAAC7Q,OAAO,CAACsR,QAAQ,CAAC+H,MAAM,KAAK,IAAI,EAAE;MACvC,IAAID,OAAO,CAACzI,OAAO,CAAC2I,IAAI,IAAI,IAAI,IAAIF,OAAO,CAACzI,OAAO,CAAC2I,IAAI,IAAItX,SAAS,EAAE;QACnEoX,OAAO,CAACzI,OAAO,CAAC2I,IAAI,CAACrY,gBAAgB,CAAC,QAAQ,EAAE,YAAY;UACxD4V,YAAY,CAACuC,OAAO,CAACG,iBAAiB,CAAC;UACvCH,OAAO,CAACG,iBAAiB,GAAGvX,SAAS;UAErCiX,YAAY,CAACE,UAAU,CAAC,OAAO,GAAGC,OAAO,CAACpZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,CAAC;QACxE,CAAC,CAAC;MACN;MAEA,IAAI,CAACjS,OAAO,CAACsR,QAAQ,CAAC+H,MAAM,GAAG,IAAI;IACvC;IAEA,IAAI,IAAI,CAACrZ,OAAO,CAACsR,QAAQ,CAACkI,MAAM,KAAK,IAAI,EAAE;MACvC,IAAI,OAAOP,YAAY,CAACQ,OAAO,CAAC,OAAO,GAAG,IAAI,CAACzZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,CAAC,IAAI,QAAQ,IAAIgH,YAAY,CAACQ,OAAO,CAAC,OAAO,GAAG,IAAI,CAACzZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,CAAC,IAAI,EAAE,EAAE;QAC3J,IAAI,CAACtN,UAAU,CAAC+U,QAAQ,CAACT,YAAY,CAACQ,OAAO,CAAC,OAAO,GAAG,IAAI,CAACzZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,CAAC,CAAC;QACxF,IAAI,CAACjS,OAAO,CAACsR,QAAQ,CAACgB,eAAe,GAAG,IAAI;MAChD;MAEA,IAAI,CAACtS,OAAO,CAACsR,QAAQ,CAACkI,MAAM,GAAG,IAAI;IACvC;IAEA,IAAI3N,KAAK,GAAGuN,OAAO,CAACvN,KAAK,CAAC,CAAC;IAC3B,IAAIA,KAAK,KAAK,EAAE,EAAE;MACdoN,YAAY,CAACC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAClZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,EAAEpG,KAAK,CAAC;IACzE,CAAC,MAAM;MACHoN,YAAY,CAACE,UAAU,CAAC,OAAO,GAAG,IAAI,CAACnZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,CAAC;IACrE;IAEA,IAAI9R,EAAE,GAAGO,QAAQ,CAACiZ,cAAc,CAAC,WAAW,CAAC;IAC7C,IAAIxZ,EAAE,IAAI,IAAI,IAAIA,EAAE,IAAI6B,SAAS,IAAI7B,EAAE,IAAI,EAAE,EAAE;MAC3C,IAAIyZ,CAAC,GAAG,IAAIC,IAAI,CAAC,CAAC;MAClB,IAAIC,EAAE,GAAG,IAAIC,IAAI,CAACC,cAAc,CAAC,CAAC,IAAI,CAACha,OAAO,CAACsR,QAAQ,CAAC/B,UAAU,CAACC,MAAM,EAAE,OAAO,CAAC,EAAE,IAAI,CAACxP,OAAO,CAACsR,QAAQ,CAAC/B,UAAU,CAACE,MAAM,CAAC,CAACA,MAAM,CAACmK,CAAC,CAAC;MACvI,IAAIrD,IAAI,GAAG,IAAI,CAACvW,OAAO,CAACsR,QAAQ,CAACrP,IAAI,IAAID,SAAS,GAAG,aAAa,GAAG,IAAI,CAAChC,OAAO,CAACsR,QAAQ,CAACrP,IAAI;MAE/F9B,EAAE,CAACP,SAAS,GAAG2W,IAAI,GAAGuD,EAAE;IAC5B;EACJ,CAAC,MAAM;IACHlJ,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;EACvE;AACJ,CAAC;AAEDR,OAAO,CAAC3O,SAAS,CAACuY,mBAAmB,GAAG,YAAY;EAChD,IAAIjB,uBAAuB,CAAC,CAAC,EAAE;IAC3B,IAAI,IAAI,CAAChZ,OAAO,CAACsR,QAAQ,IAAItP,SAAS,IAAI,IAAI,CAAChC,OAAO,CAACsR,QAAQ,CAACW,QAAQ,IAAIjQ,SAAS,IAAI,IAAI,CAAChC,OAAO,CAACsR,QAAQ,CAACW,QAAQ,IAAI,EAAE,EAAE;MAC3HrB,OAAO,CAACC,GAAG,CAAC,8DAA8D,CAAC;MAC3E;IACJ;IAEAoI,YAAY,CAACE,UAAU,CAAC,OAAO,GAAG,IAAI,CAACnZ,OAAO,CAACsR,QAAQ,CAACW,QAAQ,CAAC;EACrE,CAAC,MAAM;IACHrB,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;EACvE;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACAR,OAAO,CAAC3O,SAAS,CAAC2I,oBAAoB,GAAG,UAAU0I,SAAS,EAAEC,OAAO,EAAE;EACnE,IAAIT,IAAI,GAAG,IAAI;EACf,IAAI2H,UAAU,GAAG,IAAI,CAAC9G,GAAG,CAAC3H,OAAO,CAAC8H,sBAAsB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;EACzE2G,UAAU,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC;EACpB,SAASC,QAAQA,CAAC5H,KAAK,EAAE;IACrB,IAAID,IAAI,CAACvS,OAAO,CAACyS,mBAAmB,EAAE;MAClCF,IAAI,CAACG,+BAA+B,CAACH,IAAI,CAACvS,OAAO,CAACyS,mBAAmB,EAAED,KAAK,CAAC/D,MAAM,CAACmE,KAAK,CAAC;IAC9F,CAAC,MAAM;MACHL,IAAI,CAACM,YAAY,CAACL,KAAK,CAAC/D,MAAM,CAACmE,KAAK,EAAEG,SAAS,EAAEC,OAAO,CAAC;IAC7D;IACAkH,UAAU,CAACnB,mBAAmB,CAAC,QAAQ,EAAEqB,QAAQ,CAAC;EACtD;EAEAF,UAAU,CAACjZ,gBAAgB,CAAC,QAAQ,EAAEmZ,QAAQ,CAAC;AACnD,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA/J,OAAO,CAAC3O,SAAS,CAACsP,WAAW,GAAG,UAAUqJ,IAAI,EAAEtH,SAAS,EAAEC,OAAO,EAAE;EAChE,IAAIT,IAAI,GAAG,IAAI;EACfQ,SAAS,GAAGA,SAAS,IAAI,SAASA,SAASA,CAACuH,QAAQ,EAAE;IAClDhQ,kBAAkB,CAACiI,IAAI,EAAE+H,QAAQ,CAAC;EACtC,CAAC;EAED,SAASC,UAAUA,CAAC9I,YAAY,EAAE;IAC9B;IACAc,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAE2G,YAAY,CAAC;IAElDxG,UAAU,CAAC,YAAY;MACnBsH,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEyH,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAACG,MAAM,CAAC;IACxE,CAAC,EAAE,KAAK,CAAC;;IAET;IACA,IAAI8H,OAAO,IAAI,OAAOA,OAAO,KAAK,UAAU,EAAE;MAC1CA,OAAO,CAACvB,YAAY,CAAC;IACzB;IACA;IACAc,IAAI,CAACvS,OAAO,CAACwR,aAAa,CAACC,YAAY,CAAC;EAC5C;EAEA,SAAS+I,gBAAgBA,CAAC/I,YAAY,EAAE;IACpC,IAAItD,KAAK,GAAGoE,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAACgF,SAAS,CAACtN,KAAK,CAAC,GAAG,CAAC;IACxD,OAAOgP,YAAY,CACdjT,OAAO,CAAC,cAAc,EAAE6b,IAAI,CAACva,IAAI,CAAC,CAClCtB,OAAO,CAAC,cAAc,EAAEyP,aAAa,CAACoM,IAAI,CAACxN,IAAI,EAAEsB,KAAK,CAAC,CAAC,CACxD3P,OAAO,CAAC,kBAAkB,EAAEyP,aAAa,CAACsE,IAAI,CAACvS,OAAO,CAAC2R,YAAY,EAAExD,KAAK,CAAC,CAAC;EACrF;EAEA,IAAIkM,IAAI,CAACxN,IAAI,GAAG,IAAI,CAAC7M,OAAO,CAAC2R,YAAY,EAAE;IACvC4I,UAAU,CAACC,gBAAgB,CAAC,IAAI,CAACxa,OAAO,CAACgQ,aAAa,CAACG,YAAY,CAAC,CAAC;IACrE;EACJ;EAEA,IAAIsK,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;EAC7BD,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEN,IAAI,CAAC;;EAE9B;EACA,IAAI9H,IAAI,CAACvS,OAAO,CAAC4a,cAAc,IAAI,CAACrI,IAAI,CAACvS,OAAO,CAAC+R,eAAe,EAAE;IAC9D0I,QAAQ,CAACE,MAAM,CAACpI,IAAI,CAACvS,OAAO,CAAC8R,aAAa,EAAES,IAAI,CAACvS,OAAO,CAAC4a,cAAc,CAAC;EAC5E;EAEA,IAAIC,OAAO,GAAG,IAAIC,cAAc,CAAC,CAAC;EAClCD,OAAO,CAACE,MAAM,CAACC,UAAU,GAAG,UAAUxI,KAAK,EAAE;IACzC,IAAIA,KAAK,CAACyI,gBAAgB,EAAE;MACxB,IAAIC,QAAQ,GAAG,EAAE,GAAG9M,IAAI,CAAC+M,KAAK,CAAE3I,KAAK,CAACgH,MAAM,GAAG,GAAG,GAAIhH,KAAK,CAAC4I,KAAK,CAAC;MAClE7I,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEyH,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAAC+E,UAAU,CAACtR,OAAO,CAAC,aAAa,EAAE6b,IAAI,CAACva,IAAI,CAAC,CAACtB,OAAO,CAAC,YAAY,EAAE0c,QAAQ,CAAC,CAAC;IAC9I;EACJ,CAAC;EACDL,OAAO,CAAC1X,IAAI,CAAC,MAAM,EAAE,IAAI,CAACnD,OAAO,CAACqb,mBAAmB,CAAC;;EAEtD;EACA,IAAI9I,IAAI,CAACvS,OAAO,CAAC4a,cAAc,IAAIrI,IAAI,CAACvS,OAAO,CAAC+R,eAAe,EAAE;IAC7D8I,OAAO,CAACS,gBAAgB,CAAC/I,IAAI,CAACvS,OAAO,CAAC8R,aAAa,EAAES,IAAI,CAACvS,OAAO,CAAC4a,cAAc,CAAC;EACrF;EAEAC,OAAO,CAACrC,MAAM,GAAG,YAAY;IACzB,IAAI;MACA,IAAI+C,QAAQ,GAAGC,IAAI,CAACpH,KAAK,CAAC,IAAI,CAACqH,YAAY,CAAC;IAChD,CAAC,CAAC,OAAOC,KAAK,EAAE;MACZ9K,OAAO,CAAC8K,KAAK,CAAC,kDAAkD,CAAC;MACjEnB,UAAU,CAACC,gBAAgB,CAACjI,IAAI,CAACvS,OAAO,CAACgQ,aAAa,CAACI,WAAW,CAAC,CAAC;MACpE;IACJ;IACA,IAAI,IAAI,CAACW,MAAM,KAAK,GAAG,IAAIwK,QAAQ,IAAI,CAACA,QAAQ,CAACG,KAAK,IAAIH,QAAQ,CAACxX,IAAI,IAAIwX,QAAQ,CAACxX,IAAI,CAAC4X,QAAQ,EAAE;MAC/F5I,SAAS,CAAC,CAACR,IAAI,CAACvS,OAAO,CAAC6R,iBAAiB,GAAG,EAAE,GAAI9T,MAAM,CAAC6d,QAAQ,CAACC,MAAM,GAAG,GAAI,IAAIN,QAAQ,CAACxX,IAAI,CAAC4X,QAAQ,CAAC;IAC9G,CAAC,MAAM;MACH,IAAIJ,QAAQ,CAACG,KAAK,IAAIH,QAAQ,CAACG,KAAK,IAAInJ,IAAI,CAACvS,OAAO,CAACgQ,aAAa,EAAE;QAAG;QACnEuK,UAAU,CAACC,gBAAgB,CAACjI,IAAI,CAACvS,OAAO,CAACgQ,aAAa,CAACuL,QAAQ,CAACG,KAAK,CAAC,CAAC,CAAC;MAC5E,CAAC,MAAM,IAAIH,QAAQ,CAACG,KAAK,EAAE;QAAG;QAC1BnB,UAAU,CAACC,gBAAgB,CAACe,QAAQ,CAACG,KAAK,CAAC,CAAC;MAChD,CAAC,MAAM;QAAG;QACN9K,OAAO,CAAC8K,KAAK,CAAC,qEAAqE,GAC7E,IAAI,CAAC3K,MAAM,GAAG,IAAI,GAAG,IAAI,CAAC+K,UAAU,GAAG,GAAG,CAAC;QACjDvB,UAAU,CAACC,gBAAgB,CAACjI,IAAI,CAACvS,OAAO,CAACgQ,aAAa,CAACI,WAAW,CAAC,CAAC;MACxE;IACJ;EACJ,CAAC;EAEDyK,OAAO,CAACkB,OAAO,GAAG,UAAUvJ,KAAK,EAAE;IAC/B5B,OAAO,CAAC8K,KAAK,CAAC,wEAAwE,GAChFlJ,KAAK,CAAC/D,MAAM,CAACsC,MAAM,GAAG,IAAI,GAAGyB,KAAK,CAAC/D,MAAM,CAACqN,UAAU,GAAG,GAAG,CAAC;IACjEvB,UAAU,CAAChI,IAAI,CAACvS,OAAO,CAACgQ,aAAa,CAACI,WAAW,CAAC;EACtD,CAAC;EAEDyK,OAAO,CAACmB,IAAI,CAACvB,QAAQ,CAAC;AAE1B,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACApK,OAAO,CAAC3O,SAAS,CAACwR,8BAA8B,GAAG,UAAUT,mBAAmB,EAAE4H,IAAI,EAAE;EACpF,IAAI9H,IAAI,GAAG,IAAI;EAEf,SAASQ,SAASA,CAACuH,QAAQ,EAAE;IACzBhQ,kBAAkB,CAACiI,IAAI,EAAE+H,QAAQ,CAAC;EACtC;EAEA,SAAStH,OAAOA,CAACvB,YAAY,EAAE;IAC3B,IAAIwK,kBAAkB,GAAGzB,gBAAgB,CAAC/I,YAAY,CAAC;IACvD;IACAc,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEmR,kBAAkB,CAAC;IAExDhR,UAAU,CAAC,YAAY;MACnBsH,IAAI,CAACzH,eAAe,CAAC,cAAc,EAAEyH,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAACG,MAAM,CAAC;IACxE,CAAC,EAAE,KAAK,CAAC;;IAET;IACAqH,IAAI,CAACvS,OAAO,CAACwR,aAAa,CAACyK,kBAAkB,CAAC;EAClD;EAEA,SAASzB,gBAAgBA,CAAC/I,YAAY,EAAE;IACpC,IAAItD,KAAK,GAAGoE,IAAI,CAACvS,OAAO,CAAC+K,UAAU,CAACgF,SAAS,CAACtN,KAAK,CAAC,GAAG,CAAC;IACxD,OAAOgP,YAAY,CACdjT,OAAO,CAAC,cAAc,EAAE6b,IAAI,CAACva,IAAI,CAAC,CAClCtB,OAAO,CAAC,cAAc,EAAEyP,aAAa,CAACoM,IAAI,CAACxN,IAAI,EAAEsB,KAAK,CAAC,CAAC,CACxD3P,OAAO,CAAC,kBAAkB,EAAEyP,aAAa,CAACsE,IAAI,CAACvS,OAAO,CAAC2R,YAAY,EAAExD,KAAK,CAAC,CAAC;EACrF;EAEAsE,mBAAmB,CAACyJ,KAAK,CAAC,IAAI,EAAE,CAAC7B,IAAI,EAAEtH,SAAS,EAAEC,OAAO,CAAC,CAAC;AAC/D,CAAC;AAED3C,OAAO,CAAC3O,SAAS,CAACoE,mBAAmB,GAAG,YAAY;EAChD,IAAItC,EAAE,GAAG,IAAI,CAACmB,UAAU;EACxB,IAAIK,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIoG,OAAO,GAAGrG,OAAO,CAACG,WAAW;;EAEjC;EACA,IAAIgX,UAAU,GAAGC,QAAQ,CAACre,MAAM,CAACsZ,gBAAgB,CAACrS,OAAO,CAAC,CAACmX,UAAU,CAAC;EACtE,IAAIE,cAAc,GAAGD,QAAQ,CAACre,MAAM,CAACsZ,gBAAgB,CAACrS,OAAO,CAAC,CAACqX,cAAc,CAAC;EAC9E,IAAIC,gBAAgB,GAAGF,QAAQ,CAAC,IAAI,CAACpc,OAAO,CAAC0F,SAAS,CAAC;EACvD,IAAI6W,gBAAgB,GAAGD,gBAAgB,GAAGH,UAAU,GAAG,CAAC,GAAGE,cAAc,GAAG,CAAC;EAC7E,IAAIG,gBAAgB,GAAGD,gBAAgB,CAACE,QAAQ,CAAC,CAAC,GAAG,IAAI;EAEzDpR,OAAO,CAAC7L,KAAK,CAACqG,MAAM,GAAG2W,gBAAgB;AAC3C,CAAC;AAEDnM,OAAO,CAAC3O,SAAS,CAACiX,gBAAgB,GAAG,YAAY;EAC7C,IAAInV,EAAE,GAAG,IAAI,CAACmB,UAAU;EACxB,IAAIK,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIoG,OAAO,GAAGrG,OAAO,CAACG,WAAW;EAEjC,IAAI,CAACkG,OAAO,IAAI,CAACA,OAAO,CAAChL,SAAS,CAAC+E,QAAQ,CAAC,qBAAqB,CAAC,EAAE;IAChEiG,OAAO,GAAG3K,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACvC0K,OAAO,CAACzK,SAAS,GAAG,qBAAqB;IAEzC,IAAI,IAAI,CAACZ,OAAO,CAACiM,YAAY,EAAE;MAE3B,IAAIC,KAAK,CAACC,OAAO,CAAC,IAAI,CAACnM,OAAO,CAACiM,YAAY,CAAC,EAAE;QAC1C,KAAK,IAAIjN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACgB,OAAO,CAACiM,YAAY,CAAChN,MAAM,EAAED,CAAC,EAAE,EAAE;UACvDqM,OAAO,CAAChL,SAAS,CAACC,GAAG,CAAC,IAAI,CAACN,OAAO,CAACiM,YAAY,CAACjN,CAAC,CAAC,CAAC;QACvD;MAEJ,CAAC,MAAM,IAAI,OAAO,IAAI,CAACgB,OAAO,CAACiM,YAAY,KAAK,QAAQ,EAAE;QACtDZ,OAAO,CAAChL,SAAS,CAACC,GAAG,CAAC,IAAI,CAACN,OAAO,CAACiM,YAAY,CAAC;MACpD;IACJ;IAEAjH,OAAO,CAACO,UAAU,CAACkR,YAAY,CAACpL,OAAO,EAAErG,OAAO,CAACG,WAAW,CAAC;EACjE;EAEA,IAAI,OAAO,IAAI,CAACnF,OAAO,CAAC0F,SAAS,KAAK,WAAW,EAAE;IAC/C,IAAI,CAACI,mBAAmB,CAAC,CAAC;EAC9B;EAEA,IAAI,IAAI,CAAC9F,OAAO,CAAC0c,2BAA2B,KAAK,KAAK,EAAE,OAAOrR,OAAO;EACtE;EACA,IAAIsR,OAAO,GAAG,KAAK;EACnB,IAAIC,OAAO,GAAG,KAAK;EACnBpZ,EAAE,CAACsI,EAAE,CAAC,QAAQ,EAAE,UAAU+Q,CAAC,EAAE;IACzB,IAAIF,OAAO,EAAE;MACTA,OAAO,GAAG,KAAK;MACf;IACJ;IACAC,OAAO,GAAG,IAAI;IACd,IAAI/W,MAAM,GAAGgX,CAAC,CAACC,aAAa,CAAC,CAAC,CAACjX,MAAM,GAAGgX,CAAC,CAACC,aAAa,CAAC,CAAC,CAACC,YAAY;IACtE,IAAIC,KAAK,GAAGC,UAAU,CAACJ,CAAC,CAACC,aAAa,CAAC,CAAC,CAACI,GAAG,CAAC,GAAGrX,MAAM;IACtD,IAAIsX,IAAI,GAAG,CAAC9R,OAAO,CAAC+R,YAAY,GAAG/R,OAAO,CAAC0R,YAAY,IAAIC,KAAK;IAChE3R,OAAO,CAACgS,SAAS,GAAGF,IAAI;EAC5B,CAAC,CAAC;;EAEF;EACA9R,OAAO,CAACiS,QAAQ,GAAG,YAAY;IAC3B,IAAIV,OAAO,EAAE;MACTA,OAAO,GAAG,KAAK;MACf;IACJ;IACAD,OAAO,GAAG,IAAI;IACd,IAAI9W,MAAM,GAAGwF,OAAO,CAAC+R,YAAY,GAAG/R,OAAO,CAAC0R,YAAY;IACxD,IAAIC,KAAK,GAAGC,UAAU,CAAC5R,OAAO,CAACgS,SAAS,CAAC,GAAGxX,MAAM;IAClD,IAAIsX,IAAI,GAAG,CAAC3Z,EAAE,CAACsZ,aAAa,CAAC,CAAC,CAACjX,MAAM,GAAGrC,EAAE,CAACsZ,aAAa,CAAC,CAAC,CAACC,YAAY,IAAIC,KAAK;IAChFxZ,EAAE,CAAC+Z,QAAQ,CAAC,CAAC,EAAEJ,IAAI,CAAC;EACxB,CAAC;EACD,OAAO9R,OAAO;AAClB,CAAC;AAEDgF,OAAO,CAAC3O,SAAS,CAACgV,aAAa,GAAG,UAAU8G,KAAK,EAAE;EAC/CA,KAAK,GAAGA,KAAK,IAAI,IAAI,CAACxd,OAAO,CAACyL,OAAO;EAErC,IAAI,CAAC+R,KAAK,IAAIA,KAAK,CAACve,MAAM,KAAK,CAAC,EAAE;IAC9B;EACJ;EACA,IAAID,CAAC;EACL,KAAKA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwe,KAAK,CAACve,MAAM,EAAED,CAAC,EAAE,EAAE;IAC/B,IAAIgC,qBAAqB,CAACwc,KAAK,CAACxe,CAAC,CAAC,CAAC,IAAIgD,SAAS,EAAE;MAC9Cwb,KAAK,CAACxe,CAAC,CAAC,GAAGgC,qBAAqB,CAACwc,KAAK,CAACxe,CAAC,CAAC,CAAC;IAC9C;EACJ;EAEA,IAAIye,GAAG,GAAG/c,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;EACvC8c,GAAG,CAAC7c,SAAS,GAAG,gBAAgB;EAChC6c,GAAG,CAAC5b,YAAY,CAAC,MAAM,EAAE,SAAS,CAAC;EAEnC,IAAI0Q,IAAI,GAAG,IAAI;EAEf,IAAImL,WAAW,GAAG,CAAC,CAAC;EACpBnL,IAAI,CAAC9G,OAAO,GAAG+R,KAAK;EAEpB,KAAKxe,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwe,KAAK,CAACve,MAAM,EAAED,CAAC,EAAE,EAAE;IAC/B,IAAIwe,KAAK,CAACxe,CAAC,CAAC,CAACc,IAAI,IAAI,OAAO,IAAIyS,IAAI,CAACvS,OAAO,CAAC2d,gBAAgB,KAAK,KAAK,EACnE;IAEJ,IAAIpL,IAAI,CAACvS,OAAO,CAAC4d,SAAS,IAAIrL,IAAI,CAACvS,OAAO,CAAC4d,SAAS,CAACtf,OAAO,CAACkf,KAAK,CAACxe,CAAC,CAAC,CAACc,IAAI,CAAC,IAAI,CAAC,CAAC,EAC7E;;IAEJ;IACA;IACA,IAAI,CAAC0d,KAAK,CAACxe,CAAC,CAAC,CAACc,IAAI,IAAI,YAAY,IAAI0d,KAAK,CAACxe,CAAC,CAAC,CAACc,IAAI,IAAI,cAAc,KAAKrC,QAAQ,CAAC,CAAC,EAChF;;IAGJ;IACA,IAAI+f,KAAK,CAACxe,CAAC,CAAC,KAAK,GAAG,EAAE;MAClB,IAAI6e,uBAAuB,GAAG,KAAK;MAEnC,KAAK,IAAIC,CAAC,GAAI9e,CAAC,GAAG,CAAE,EAAE8e,CAAC,GAAGN,KAAK,CAACve,MAAM,EAAE6e,CAAC,EAAE,EAAE;QACzC,IAAIN,KAAK,CAACM,CAAC,CAAC,KAAK,GAAG,KAAK,CAACvL,IAAI,CAACvS,OAAO,CAAC4d,SAAS,IAAIrL,IAAI,CAACvS,OAAO,CAAC4d,SAAS,CAACtf,OAAO,CAACkf,KAAK,CAACM,CAAC,CAAC,CAAChe,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;UACtG+d,uBAAuB,GAAG,IAAI;QAClC;MACJ;MAEA,IAAI,CAACA,uBAAuB,EACxB;IACR;;IAGA;IACA,CAAC,UAAUE,IAAI,EAAE;MACb,IAAI5d,EAAE;MACN,IAAI4d,IAAI,KAAK,GAAG,EAAE;QACd5d,EAAE,GAAGiD,SAAS,CAAC,CAAC;MACpB,CAAC,MAAM,IAAI2a,IAAI,CAAC3e,QAAQ,EAAE;QACtBe,EAAE,GAAGJ,qBAAqB,CAACge,IAAI,EAAExL,IAAI,CAACvS,OAAO,CAACge,WAAW,EAAEzL,IAAI,CAACvS,OAAO,CAAC3C,SAAS,EAAEkV,IAAI,CAAC;MAC5F,CAAC,MAAM;QACHpS,EAAE,GAAGC,mBAAmB,CAAC2d,IAAI,EAAE,IAAI,EAAExL,IAAI,CAACvS,OAAO,CAACge,WAAW,EAAEzL,IAAI,CAACvS,OAAO,CAAC3C,SAAS,EAAE,QAAQ,EAAEkV,IAAI,CAAC;MAC1G;MAGAmL,WAAW,CAACK,IAAI,CAACje,IAAI,IAAIie,IAAI,CAAC,GAAG5d,EAAE;MACnCsd,GAAG,CAACrc,WAAW,CAACjB,EAAE,CAAC;;MAEnB;MACA;MACA,IAAI4d,IAAI,CAACje,IAAI,KAAK,cAAc,EAAE;QAC9B,IAAIoa,UAAU,GAAGxZ,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;QAChDuZ,UAAU,CAACtZ,SAAS,GAAG,YAAY;QACnCsZ,UAAU,CAAC3a,IAAI,GAAG,MAAM;QACxB2a,UAAU,CAAC+D,QAAQ,GAAG,IAAI;QAC1B/D,UAAU,CAACpa,IAAI,GAAG,OAAO;QACzBoa,UAAU,CAACgE,MAAM,GAAG3L,IAAI,CAACvS,OAAO,CAAC4R,WAAW;QAC5CsI,UAAU,CAAC1a,KAAK,CAAC2e,OAAO,GAAG,MAAM;QACjCjE,UAAU,CAAC1a,KAAK,CAAC4e,OAAO,GAAG,CAAC;QAC5BX,GAAG,CAACrc,WAAW,CAAC8Y,UAAU,CAAC;MAC/B;IACJ,CAAC,EAAEsD,KAAK,CAACxe,CAAC,CAAC,CAAC;EAChB;EAEAuT,IAAI,CAACxM,WAAW,GAAG0X,GAAG;EACtBlL,IAAI,CAACtM,eAAe,GAAGyX,WAAW;EAElC,IAAIla,EAAE,GAAG,IAAI,CAACmB,UAAU;EACxBnB,EAAE,CAACsI,EAAE,CAAC,gBAAgB,EAAE,YAAY;IAChC,IAAInI,IAAI,GAAGJ,QAAQ,CAACC,EAAE,CAAC;IAEvB,KAAK,IAAIhG,GAAG,IAAIkgB,WAAW,EAAE;MACzB,CAAC,UAAUlgB,GAAG,EAAE;QACZ,IAAI2C,EAAE,GAAGud,WAAW,CAAClgB,GAAG,CAAC;QACzB,IAAImG,IAAI,CAACnG,GAAG,CAAC,EAAE;UACX2C,EAAE,CAACE,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;QAC9B,CAAC,MAAM,IAAI9C,GAAG,IAAI,YAAY,IAAIA,GAAG,IAAI,cAAc,EAAE;UACrD2C,EAAE,CAACE,SAAS,CAACmF,MAAM,CAAC,QAAQ,CAAC;QACjC;MACJ,CAAC,EAAEhI,GAAG,CAAC;IACX;EACJ,CAAC,CAAC;EAEF,IAAIgZ,SAAS,GAAGhT,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACtCuR,SAAS,CAACjR,UAAU,CAACkR,YAAY,CAACgH,GAAG,EAAEjH,SAAS,CAAC;EACjD,OAAOiH,GAAG;AACd,CAAC;AAEDpN,OAAO,CAAC3O,SAAS,CAACiV,eAAe,GAAG,UAAU5F,MAAM,EAAE;EAClD;EACAA,MAAM,GAAGA,MAAM,IAAI,IAAI,CAAC/Q,OAAO,CAAC+Q,MAAM;EACtC,IAAI/Q,OAAO,GAAG,IAAI,CAACA,OAAO;EAC1B,IAAIwD,EAAE,GAAG,IAAI,CAACmB,UAAU;;EAExB;EACA,IAAI,CAACoM,MAAM,IAAIA,MAAM,CAAC9R,MAAM,KAAK,CAAC,EAAE;IAChC;EACJ;;EAEA;EACA,IAAIue,KAAK,GAAG,EAAE;EACd,IAAIxe,CAAC,EAAEqf,QAAQ,EAAEC,UAAU,EAAEC,YAAY;EAEzC,KAAKvf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+R,MAAM,CAAC9R,MAAM,EAAED,CAAC,EAAE,EAAE;IAChC;IACAqf,QAAQ,GAAGrc,SAAS;IACpBsc,UAAU,GAAGtc,SAAS;IACtBuc,YAAY,GAAGvc,SAAS;;IAGxB;IACA,IAAI,OAAO+O,MAAM,CAAC/R,CAAC,CAAC,KAAK,QAAQ,EAAE;MAC/Bwe,KAAK,CAAC3a,IAAI,CAAC;QACPjC,SAAS,EAAEmQ,MAAM,CAAC/R,CAAC,CAAC,CAAC4B,SAAS;QAC9B2d,YAAY,EAAExN,MAAM,CAAC/R,CAAC,CAAC,CAACuf,YAAY;QACpCF,QAAQ,EAAEtN,MAAM,CAAC/R,CAAC,CAAC,CAACqf,QAAQ;QAC5BC,UAAU,EAAEvN,MAAM,CAAC/R,CAAC,CAAC,CAACsf;MAC1B,CAAC,CAAC;IACN,CAAC,MAAM;MACH,IAAIxe,IAAI,GAAGiR,MAAM,CAAC/R,CAAC,CAAC;MAEpB,IAAIc,IAAI,KAAK,OAAO,EAAE;QAClBye,YAAY,GAAG,SAAAA,CAAUpe,EAAE,EAAE;UACzBA,EAAE,CAACP,SAAS,GAAGoP,SAAS,CAACxL,EAAE,CAACgb,QAAQ,CAAC,CAAC,CAAC;QAC3C,CAAC;QACDH,QAAQ,GAAG,SAAAA,CAAUle,EAAE,EAAE;UACrBA,EAAE,CAACP,SAAS,GAAGoP,SAAS,CAACxL,EAAE,CAACgb,QAAQ,CAAC,CAAC,CAAC;QAC3C,CAAC;MACL,CAAC,MAAM,IAAI1e,IAAI,KAAK,OAAO,EAAE;QACzBye,YAAY,GAAG,SAAAA,CAAUpe,EAAE,EAAE;UACzBA,EAAE,CAACP,SAAS,GAAG4D,EAAE,CAAC2E,SAAS,CAAC,CAAC;QACjC,CAAC;QACDkW,QAAQ,GAAG,SAAAA,CAAUle,EAAE,EAAE;UACrBA,EAAE,CAACP,SAAS,GAAG4D,EAAE,CAAC2E,SAAS,CAAC,CAAC;QACjC,CAAC;MACL,CAAC,MAAM,IAAIrI,IAAI,KAAK,QAAQ,EAAE;QAC1Bye,YAAY,GAAG,SAAAA,CAAUpe,EAAE,EAAE;UACzBA,EAAE,CAACP,SAAS,GAAG,KAAK;QACxB,CAAC;QACD0e,UAAU,GAAG,SAAAA,CAAUne,EAAE,EAAE;UACvB,IAAIsD,GAAG,GAAGD,EAAE,CAACE,SAAS,CAAC,CAAC;UACxB,IAAI+a,OAAO,GAAGhb,GAAG,CAACS,IAAI,GAAG,CAAC;UAC1B,IAAIwa,SAAS,GAAGjb,GAAG,CAACyD,EAAE,GAAG,CAAC;UAC1B/G,EAAE,CAACP,SAAS,GAAG6e,OAAO,GAAG,GAAG,GAAGC,SAAS;QAC5C,CAAC;MACL,CAAC,MAAM,IAAI5e,IAAI,KAAK,UAAU,EAAE;QAC5Bye,YAAY,GAAG,SAAAA,CAAUpe,EAAE,EAAE;UACzB,IAAIH,OAAO,CAACsR,QAAQ,IAAItP,SAAS,IAAIhC,OAAO,CAACsR,QAAQ,CAACsF,OAAO,KAAK,IAAI,EAAE;YACpEzW,EAAE,CAAC0B,YAAY,CAAC,IAAI,EAAE,WAAW,CAAC;UACtC;QACJ,CAAC;MACL,CAAC,MAAM,IAAI/B,IAAI,KAAK,cAAc,EAAE;QAChCye,YAAY,GAAG,SAAAA,CAAUpe,EAAE,EAAE;UACzBA,EAAE,CAACP,SAAS,GAAGI,OAAO,CAAC+K,UAAU,CAACG,MAAM;QAC5C,CAAC;MACL;MAEAsS,KAAK,CAAC3a,IAAI,CAAC;QACPjC,SAAS,EAAEd,IAAI;QACfye,YAAY,EAAEA,YAAY;QAC1BF,QAAQ,EAAEA,QAAQ;QAClBC,UAAU,EAAEA;MAChB,CAAC,CAAC;IACN;EACJ;;EAGA;EACA,IAAIb,GAAG,GAAG/c,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;EACvC8c,GAAG,CAAC7c,SAAS,GAAG,kBAAkB;;EAGlC;EACA,KAAK5B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwe,KAAK,CAACve,MAAM,EAAED,CAAC,EAAE,EAAE;IAC/B;IACA,IAAI+e,IAAI,GAAGP,KAAK,CAACxe,CAAC,CAAC;;IAGnB;IACA,IAAImB,EAAE,GAAGO,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;IACvCR,EAAE,CAACS,SAAS,GAAGmd,IAAI,CAACnd,SAAS;;IAG7B;IACA,IAAI,OAAOmd,IAAI,CAACQ,YAAY,KAAK,UAAU,EAAE;MACzCR,IAAI,CAACQ,YAAY,CAACpe,EAAE,CAAC;IACzB;;IAGA;IACA,IAAI,OAAO4d,IAAI,CAACM,QAAQ,KAAK,UAAU,EAAE;MACrC;MACA,IAAI,CAAC1Z,UAAU,CAACmH,EAAE,CAAC,QAAQ,EAAG,UAAU3L,EAAE,EAAE4d,IAAI,EAAE;QAC9C,OAAO,YAAY;UACfA,IAAI,CAACM,QAAQ,CAACle,EAAE,CAAC;QACrB,CAAC;MACL,CAAC,CAACA,EAAE,EAAE4d,IAAI,CAAE,CAAC;IACjB;IACA,IAAI,OAAOA,IAAI,CAACO,UAAU,KAAK,UAAU,EAAE;MACvC;MACA,IAAI,CAAC3Z,UAAU,CAACmH,EAAE,CAAC,gBAAgB,EAAG,UAAU3L,EAAE,EAAE4d,IAAI,EAAE;QACtD,OAAO,YAAY;UACfA,IAAI,CAACO,UAAU,CAACne,EAAE,CAAC;QACvB,CAAC;MACL,CAAC,CAACA,EAAE,EAAE4d,IAAI,CAAE,CAAC;IACjB;;IAGA;IACAN,GAAG,CAACrc,WAAW,CAACjB,EAAE,CAAC;EACvB;;EAGA;EACA,IAAIqW,SAAS,GAAG,IAAI,CAAC7R,UAAU,CAACM,iBAAiB,CAAC,CAAC;EACnDuR,SAAS,CAACjR,UAAU,CAACkR,YAAY,CAACgH,GAAG,EAAEjH,SAAS,CAACrR,WAAW,CAAC;EAC7D,OAAOsY,GAAG;AACd,CAAC;;AAED;AACA;AACA;AACApN,OAAO,CAAC3O,SAAS,CAACmK,KAAK,GAAG,UAAU8S,GAAG,EAAE;EACrC,IAAInb,EAAE,GAAG,IAAI,CAACmB,UAAU;EACxB,IAAIga,GAAG,KAAK3c,SAAS,EAAE;IACnB,OAAOwB,EAAE,CAACgb,QAAQ,CAAC,CAAC;EACxB,CAAC,MAAM;IACHhb,EAAE,CAACob,MAAM,CAAC,CAAC,CAAClF,QAAQ,CAACiF,GAAG,CAAC;IACzB,IAAI,IAAI,CAAC9Q,eAAe,CAAC,CAAC,EAAE;MACxB,IAAI7I,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;MACpC,IAAIoG,OAAO,GAAGrG,OAAO,CAACwG,SAAS;MAC/B,IAAIY,cAAc,GAAG,IAAI,CAACpM,OAAO,CAAC4L,aAAa,CAAC+S,GAAG,EAAEtT,OAAO,CAAC;MAC7D,IAAIe,cAAc,KAAK,IAAI,EAAE;QACzBf,OAAO,CAACzL,SAAS,GAAGwM,cAAc;MACtC;IAEJ;IACA,OAAO,IAAI;EACf;AACJ,CAAC;;AAGD;AACA;AACA;AACAiE,OAAO,CAACzU,UAAU,GAAGA,UAAU;AAC/ByU,OAAO,CAACxU,YAAY,GAAGA,YAAY;AACnCwU,OAAO,CAAC9T,mBAAmB,GAAGA,mBAAmB;AACjD8T,OAAO,CAACnU,gBAAgB,GAAGA,gBAAgB;AAC3CmU,OAAO,CAACtU,oBAAoB,GAAGA,oBAAoB;AACnDsU,OAAO,CAACrU,mBAAmB,GAAGA,mBAAmB;AACjDqU,OAAO,CAAC7T,cAAc,GAAGA,cAAc;AACvC6T,OAAO,CAAC5T,cAAc,GAAGA,cAAc;AACvC4T,OAAO,CAAC3T,cAAc,GAAGA,cAAc;AACvC2T,OAAO,CAAC1T,cAAc,GAAGA,cAAc;AACvC0T,OAAO,CAACzT,cAAc,GAAGA,cAAc;AACvCyT,OAAO,CAACxT,cAAc,GAAGA,cAAc;AACvCwT,OAAO,CAAChU,eAAe,GAAGA,eAAe;AACzCgU,OAAO,CAACjU,mBAAmB,GAAGA,mBAAmB;AACjDiU,OAAO,CAAClU,iBAAiB,GAAGA,iBAAiB;AAC7CkU,OAAO,CAACvT,UAAU,GAAGA,UAAU;AAC/BuT,OAAO,CAACvU,QAAQ,GAAGA,QAAQ;AAC3BuU,OAAO,CAACpU,SAAS,GAAGA,SAAS;AAC7BoU,OAAO,CAACjG,iBAAiB,GAAGA,iBAAiB;AAC7CiG,OAAO,CAACtT,SAAS,GAAGA,SAAS;AAC7BsT,OAAO,CAACrT,kBAAkB,GAAGA,kBAAkB;AAC/CqT,OAAO,CAACpT,IAAI,GAAGA,IAAI;AACnBoT,OAAO,CAACnT,IAAI,GAAGA,IAAI;AACnBmT,OAAO,CAAC/T,aAAa,GAAGA,aAAa;AACrC+T,OAAO,CAAClT,gBAAgB,GAAGA,gBAAgB;AAC3CkT,OAAO,CAACjT,gBAAgB,GAAGA,gBAAgB;;AAE3C;AACA;AACA;AACAiT,OAAO,CAAC3O,SAAS,CAAC9F,UAAU,GAAG,YAAY;EACvCA,UAAU,CAAC,IAAI,CAAC;AACpB,CAAC;AACDyU,OAAO,CAAC3O,SAAS,CAAC7F,YAAY,GAAG,YAAY;EACzCA,YAAY,CAAC,IAAI,CAAC;AACtB,CAAC;AACDwU,OAAO,CAAC3O,SAAS,CAACnF,mBAAmB,GAAG,YAAY;EAChDA,mBAAmB,CAAC,IAAI,CAAC;AAC7B,CAAC;AACD8T,OAAO,CAAC3O,SAAS,CAACxF,gBAAgB,GAAG,YAAY;EAC7CA,gBAAgB,CAAC,IAAI,CAAC;AAC1B,CAAC;AACDmU,OAAO,CAAC3O,SAAS,CAAC3F,oBAAoB,GAAG,YAAY;EACjDA,oBAAoB,CAAC,IAAI,CAAC;AAC9B,CAAC;AACDsU,OAAO,CAAC3O,SAAS,CAAC1F,mBAAmB,GAAG,YAAY;EAChDA,mBAAmB,CAAC,IAAI,CAAC;AAC7B,CAAC;AACDqU,OAAO,CAAC3O,SAAS,CAAClF,cAAc,GAAG,YAAY;EAC3CA,cAAc,CAAC,IAAI,CAAC;AACxB,CAAC;AACD6T,OAAO,CAAC3O,SAAS,CAACjF,cAAc,GAAG,YAAY;EAC3CA,cAAc,CAAC,IAAI,CAAC;AACxB,CAAC;AACD4T,OAAO,CAAC3O,SAAS,CAAChF,cAAc,GAAG,YAAY;EAC3CA,cAAc,CAAC,IAAI,CAAC;AACxB,CAAC;AACD2T,OAAO,CAAC3O,SAAS,CAAC/E,cAAc,GAAG,YAAY;EAC3CA,cAAc,CAAC,IAAI,CAAC;AACxB,CAAC;AACD0T,OAAO,CAAC3O,SAAS,CAAC9E,cAAc,GAAG,YAAY;EAC3CA,cAAc,CAAC,IAAI,CAAC;AACxB,CAAC;AACDyT,OAAO,CAAC3O,SAAS,CAAC7E,cAAc,GAAG,YAAY;EAC3CA,cAAc,CAAC,IAAI,CAAC;AACxB,CAAC;AACDwT,OAAO,CAAC3O,SAAS,CAACrF,eAAe,GAAG,YAAY;EAC5CA,eAAe,CAAC,IAAI,CAAC;AACzB,CAAC;AACDgU,OAAO,CAAC3O,SAAS,CAACtF,mBAAmB,GAAG,YAAY;EAChDA,mBAAmB,CAAC,IAAI,CAAC;AAC7B,CAAC;AACDiU,OAAO,CAAC3O,SAAS,CAACvF,iBAAiB,GAAG,YAAY;EAC9CA,iBAAiB,CAAC,IAAI,CAAC;AAC3B,CAAC;AACDkU,OAAO,CAAC3O,SAAS,CAAC5E,UAAU,GAAG,YAAY;EACvCA,UAAU,CAAC,IAAI,CAAC;AACpB,CAAC;AACDuT,OAAO,CAAC3O,SAAS,CAAC5F,QAAQ,GAAG,YAAY;EACrCA,QAAQ,CAAC,IAAI,CAAC;AAClB,CAAC;AACDuU,OAAO,CAAC3O,SAAS,CAACzF,SAAS,GAAG,YAAY;EACtCA,SAAS,CAAC,IAAI,CAAC;AACnB,CAAC;AACDoU,OAAO,CAAC3O,SAAS,CAAC0I,iBAAiB,GAAG,YAAY;EAC9CA,iBAAiB,CAAC,IAAI,CAAC;AAC3B,CAAC;AACDiG,OAAO,CAAC3O,SAAS,CAAC3E,SAAS,GAAG,YAAY;EACtCA,SAAS,CAAC,IAAI,CAAC;AACnB,CAAC;AACDsT,OAAO,CAAC3O,SAAS,CAAC1E,kBAAkB,GAAG,YAAY;EAC/CA,kBAAkB,CAAC,IAAI,CAAC;AAC5B,CAAC;AACDqT,OAAO,CAAC3O,SAAS,CAACzE,IAAI,GAAG,YAAY;EACjCA,IAAI,CAAC,IAAI,CAAC;AACd,CAAC;AACDoT,OAAO,CAAC3O,SAAS,CAACxE,IAAI,GAAG,YAAY;EACjCA,IAAI,CAAC,IAAI,CAAC;AACd,CAAC;AACDmT,OAAO,CAAC3O,SAAS,CAACpF,aAAa,GAAG,YAAY;EAC1CA,aAAa,CAAC,IAAI,CAAC;AACvB,CAAC;AACD+T,OAAO,CAAC3O,SAAS,CAACvE,gBAAgB,GAAG,YAAY;EAC7CA,gBAAgB,CAAC,IAAI,CAAC;AAC1B,CAAC;AACDkT,OAAO,CAAC3O,SAAS,CAACtE,gBAAgB,GAAG,YAAY;EAC7CA,gBAAgB,CAAC,IAAI,CAAC;AAC1B,CAAC;AAEDiT,OAAO,CAAC3O,SAAS,CAACmM,eAAe,GAAG,YAAY;EAC5C,IAAIrK,EAAE,GAAG,IAAI,CAACmB,UAAU;EACxB,IAAIK,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIoG,OAAO,GAAGrG,OAAO,CAACwG,SAAS;EAE/B,OAAOH,OAAO,CAAChL,SAAS,CAAC+E,QAAQ,CAAC,uBAAuB,CAAC;AAC9D,CAAC;AAEDiL,OAAO,CAAC3O,SAAS,CAACmd,kBAAkB,GAAG,YAAY;EAC/C,IAAIrb,EAAE,GAAG,IAAI,CAACmB,UAAU;EACxB,IAAIK,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIoG,OAAO,GAAGrG,OAAO,CAACG,WAAW;EAEjC,OAAOkG,OAAO,CAAChL,SAAS,CAAC+E,QAAQ,CAAC,4BAA4B,CAAC;AACnE,CAAC;AAEDiL,OAAO,CAAC3O,SAAS,CAACod,kBAAkB,GAAG,YAAY;EAC/C,IAAItb,EAAE,GAAG,IAAI,CAACmB,UAAU;EAExB,OAAOnB,EAAE,CAACqB,SAAS,CAAC,YAAY,CAAC;AACrC,CAAC;AAEDwL,OAAO,CAAC3O,SAAS,CAAC6B,QAAQ,GAAG,YAAY;EACrC,IAAIC,EAAE,GAAG,IAAI,CAACmB,UAAU;EAExB,OAAOpB,QAAQ,CAACC,EAAE,CAAC;AACvB,CAAC;AAED6M,OAAO,CAAC3O,SAAS,CAACqd,UAAU,GAAG,YAAY;EACvC,IAAIvb,EAAE,GAAG,IAAI,CAACmB,UAAU;EACxB,IAAIK,OAAO,GAAGxB,EAAE,CAACyB,iBAAiB,CAAC,CAAC;EACpC,IAAIK,gBAAgB,GAAGN,OAAO,CAACO,UAAU;EAEzC,IAAID,gBAAgB,EAAE;IAClB,IAAI,IAAI,CAAC8N,GAAG,CAAC3H,OAAO,EAAE;MAClBnG,gBAAgB,CAAC0Z,WAAW,CAAC,IAAI,CAAC5L,GAAG,CAAC3H,OAAO,CAAC;IAClD;IACA,IAAI,IAAI,CAAC2H,GAAG,CAACC,SAAS,EAAE;MACpB/N,gBAAgB,CAAC0Z,WAAW,CAAC,IAAI,CAAC5L,GAAG,CAACC,SAAS,CAAC;IACpD;IACA,IAAI,IAAI,CAACD,GAAG,CAACsF,UAAU,EAAE;MACrBpT,gBAAgB,CAAC0Z,WAAW,CAAC,IAAI,CAAC5L,GAAG,CAACsF,UAAU,CAAC;IACrD;EACJ;;EAEA;EACApT,gBAAgB,CAACC,UAAU,CAACkR,YAAY,CAACzR,OAAO,EAAEM,gBAAgB,CAAC;EACnEA,gBAAgB,CAACE,MAAM,CAAC,CAAC;EAEzBhC,EAAE,CAACub,UAAU,CAAC,CAAC;EAEf,IAAI,IAAI,CAACxF,iBAAiB,EAAE;IACxB1C,YAAY,CAAC,IAAI,CAAC0C,iBAAiB,CAAC;IACpC,IAAI,CAACA,iBAAiB,GAAGvX,SAAS;IAClC,IAAI,CAACiY,mBAAmB,CAAC,CAAC;EAC9B;AACJ,CAAC;AAEDgF,MAAM,CAACC,OAAO,GAAG7O,OAAO"},"metadata":{},"sourceType":"script","externalDependencies":[]}